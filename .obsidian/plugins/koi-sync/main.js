/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Xa=Object.create;var Cr=Object.defineProperty;var eu=Object.getOwnPropertyDescriptor;var tu=Object.getOwnPropertyNames;var ru=Object.getPrototypeOf,nu=Object.prototype.hasOwnProperty;var C=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),iu=(r,e)=>{for(var t in e)Cr(r,t,{get:e[t],enumerable:!0})},is=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of tu(e))!nu.call(r,i)&&i!==t&&Cr(r,i,{get:()=>e[i],enumerable:!(n=eu(e,i))||n.enumerable});return r};var ss=(r,e,t)=>(t=r!=null?Xa(ru(r)):{},is(e||!r||!r.__esModule?Cr(t,"default",{value:r,enumerable:!0}):t,r)),su=r=>is(Cr({},"__esModule",{value:!0}),r);var Z=C(te=>{"use strict";te.__esModule=!0;te.extend=hs;te.indexOf=pu;te.escapeExpression=gu;te.isEmpty=mu;te.createFrame=yu;te.blockParams=vu;te.appendContextPath=_u;var lu={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},du=/[&<>"'`=]/g,hu=/[&<>"'`=]/;function fu(r){return lu[r]}function hs(r){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&(r[t]=arguments[e][t]);return r}var Vn=Object.prototype.toString;te.toString=Vn;var zn=function(e){return typeof e=="function"};zn(/x/)&&(te.isFunction=zn=function(r){return typeof r=="function"&&Vn.call(r)==="[object Function]"});te.isFunction=zn;var fs=Array.isArray||function(r){return r&&typeof r=="object"?Vn.call(r)==="[object Array]":!1};te.isArray=fs;function pu(r,e){for(var t=0,n=r.length;t<n;t++)if(r[t]===e)return t;return-1}function gu(r){if(typeof r!="string"){if(r&&r.toHTML)return r.toHTML();if(r==null)return"";if(!r)return r+"";r=""+r}return hu.test(r)?r.replace(du,fu):r}function mu(r){return!r&&r!==0?!0:!!(fs(r)&&r.length===0)}function yu(r){var e=hs({},r);return e._parent=r,e}function vu(r,e){return r.path=e,r}function _u(r,e){return(r?r+".":"")+e}});var ce=C((Tr,ps)=>{"use strict";Tr.__esModule=!0;var Wn=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function Zn(r,e){var t=e&&e.loc,n=void 0,i=void 0,s=void 0,o=void 0;t&&(n=t.start.line,i=t.end.line,s=t.start.column,o=t.end.column,r+=" - "+n+":"+s);for(var a=Error.prototype.constructor.call(this,r),c=0;c<Wn.length;c++)this[Wn[c]]=a[Wn[c]];Error.captureStackTrace&&Error.captureStackTrace(this,Zn);try{t&&(this.lineNumber=n,this.endLineNumber=i,Object.defineProperty?(Object.defineProperty(this,"column",{value:s,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:o,enumerable:!0})):(this.column=s,this.endColumn=o))}catch(u){}}Zn.prototype=new Error;Tr.default=Zn;ps.exports=Tr.default});var ms=C((Ar,gs)=>{"use strict";Ar.__esModule=!0;var Qn=Z();Ar.default=function(r){r.registerHelper("blockHelperMissing",function(e,t){var n=t.inverse,i=t.fn;if(e===!0)return i(this);if(e===!1||e==null)return n(this);if(Qn.isArray(e))return e.length>0?(t.ids&&(t.ids=[t.name]),r.helpers.each(e,t)):n(this);if(t.data&&t.ids){var s=Qn.createFrame(t.data);s.contextPath=Qn.appendContextPath(t.data.contextPath,t.name),t={data:s}}return i(e,t)})};gs.exports=Ar.default});var vs=C((Or,ys)=>{"use strict";Or.__esModule=!0;function wu(r){return r&&r.__esModule?r:{default:r}}var er=Z(),bu=ce(),ku=wu(bu);Or.default=function(r){r.registerHelper("each",function(e,t){if(!t)throw new ku.default("Must pass iterator to #each");var n=t.fn,i=t.inverse,s=0,o="",a=void 0,c=void 0;t.data&&t.ids&&(c=er.appendContextPath(t.data.contextPath,t.ids[0])+"."),er.isFunction(e)&&(e=e.call(this)),t.data&&(a=er.createFrame(t.data));function u(b,T,I){a&&(a.key=b,a.index=T,a.first=T===0,a.last=!!I,c&&(a.contextPath=c+b)),o=o+n(e[b],{data:a,blockParams:er.blockParams([e[b],b],[c+b,null])})}if(e&&typeof e=="object")if(er.isArray(e))for(var d=e.length;s<d;s++)s in e&&u(s,s,s===e.length-1);else if(typeof Symbol=="function"&&e[Symbol.iterator]){for(var l=[],h=e[Symbol.iterator](),f=h.next();!f.done;f=h.next())l.push(f.value);e=l;for(var d=e.length;s<d;s++)u(s,s,s===e.length-1)}else(function(){var b=void 0;Object.keys(e).forEach(function(T){b!==void 0&&u(b,s-1),b=T,s++}),b!==void 0&&u(b,s-1,!0)})();return s===0&&(o=i(this)),o})};ys.exports=Or.default});var ws=C((Ir,_s)=>{"use strict";Ir.__esModule=!0;function Eu(r){return r&&r.__esModule?r:{default:r}}var Su=ce(),xu=Eu(Su);Ir.default=function(r){r.registerHelper("helperMissing",function(){if(arguments.length!==1)throw new xu.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})};_s.exports=Ir.default});var Ss=C((Lr,Es)=>{"use strict";Lr.__esModule=!0;function Cu(r){return r&&r.__esModule?r:{default:r}}var bs=Z(),Pu=ce(),ks=Cu(Pu);Lr.default=function(r){r.registerHelper("if",function(e,t){if(arguments.length!=2)throw new ks.default("#if requires exactly one argument");return bs.isFunction(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||bs.isEmpty(e)?t.inverse(this):t.fn(this)}),r.registerHelper("unless",function(e,t){if(arguments.length!=2)throw new ks.default("#unless requires exactly one argument");return r.helpers.if.call(this,e,{fn:t.inverse,inverse:t.fn,hash:t.hash})})};Es.exports=Lr.default});var Cs=C((Rr,xs)=>{"use strict";Rr.__esModule=!0;Rr.default=function(r){r.registerHelper("log",function(){for(var e=[void 0],t=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var i=1;t.hash.level!=null?i=t.hash.level:t.data&&t.data.level!=null&&(i=t.data.level),e[0]=i,r.log.apply(r,e)})};xs.exports=Rr.default});var Ns=C((Dr,Ps)=>{"use strict";Dr.__esModule=!0;Dr.default=function(r){r.registerHelper("lookup",function(e,t,n){return e&&n.lookupProperty(e,t)})};Ps.exports=Dr.default});var As=C((Mr,Ts)=>{"use strict";Mr.__esModule=!0;function Nu(r){return r&&r.__esModule?r:{default:r}}var tr=Z(),Tu=ce(),Au=Nu(Tu);Mr.default=function(r){r.registerHelper("with",function(e,t){if(arguments.length!=2)throw new Au.default("#with requires exactly one argument");tr.isFunction(e)&&(e=e.call(this));var n=t.fn;if(tr.isEmpty(e))return t.inverse(this);var i=t.data;return t.data&&t.ids&&(i=tr.createFrame(t.data),i.contextPath=tr.appendContextPath(t.data.contextPath,t.ids[0])),n(e,{data:i,blockParams:tr.blockParams([e],[i&&i.contextPath])})})};Ts.exports=Mr.default});var Jn=C(Gr=>{"use strict";Gr.__esModule=!0;Gr.registerDefaultHelpers=ju;Gr.moveHelperToHooks=zu;function nt(r){return r&&r.__esModule?r:{default:r}}var Ou=ms(),Iu=nt(Ou),Lu=vs(),Ru=nt(Lu),Du=ws(),Mu=nt(Du),Gu=Ss(),Bu=nt(Gu),Fu=Cs(),Ku=nt(Fu),$u=Ns(),qu=nt($u),Hu=As(),Uu=nt(Hu);function ju(r){Iu.default(r),Ru.default(r),Mu.default(r),Bu.default(r),Ku.default(r),qu.default(r),Uu.default(r)}function zu(r,e,t){r.helpers[e]&&(r.hooks[e]=r.helpers[e],t||delete r.helpers[e])}});var Is=C((Br,Os)=>{"use strict";Br.__esModule=!0;var Vu=Z();Br.default=function(r){r.registerDecorator("inline",function(e,t,n,i){var s=e;return t.partials||(t.partials={},s=function(o,a){var c=n.partials;n.partials=Vu.extend({},c,t.partials);var u=e(o,a);return n.partials=c,u}),t.partials[i.args[0]]=i.fn,s})};Os.exports=Br.default});var Ls=C(Yn=>{"use strict";Yn.__esModule=!0;Yn.registerDefaultDecorators=Ju;function Wu(r){return r&&r.__esModule?r:{default:r}}var Zu=Is(),Qu=Wu(Zu);function Ju(r){Qu.default(r)}});var Xn=C((Fr,Rs)=>{"use strict";Fr.__esModule=!0;var Yu=Z(),Pt={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(e){if(typeof e=="string"){var t=Yu.indexOf(Pt.methodMap,e.toLowerCase());t>=0?e=t:e=parseInt(e,10)}return e},log:function(e){if(e=Pt.lookupLevel(e),typeof console!="undefined"&&Pt.lookupLevel(Pt.level)<=e){var t=Pt.methodMap[e];console[t]||(t="log");for(var n=arguments.length,i=Array(n>1?n-1:0),s=1;s<n;s++)i[s-1]=arguments[s];console[t].apply(console,i)}}};Fr.default=Pt;Rs.exports=Fr.default});var Ds=C(ei=>{"use strict";ei.__esModule=!0;ei.createNewLookupObject=ec;var Xu=Z();function ec(){for(var r=arguments.length,e=Array(r),t=0;t<r;t++)e[t]=arguments[t];return Xu.extend.apply(void 0,[Object.create(null)].concat(e))}});var ti=C(rr=>{"use strict";rr.__esModule=!0;rr.createProtoAccessControl=ic;rr.resultIsAllowed=sc;rr.resetLoggedProperties=ac;function tc(r){return r&&r.__esModule?r:{default:r}}var Ms=Ds(),rc=Xn(),nc=tc(rc),Kr=Object.create(null);function ic(r){var e=Object.create(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var t=Object.create(null);return t.__proto__=!1,{properties:{whitelist:Ms.createNewLookupObject(t,r.allowedProtoProperties),defaultValue:r.allowProtoPropertiesByDefault},methods:{whitelist:Ms.createNewLookupObject(e,r.allowedProtoMethods),defaultValue:r.allowProtoMethodsByDefault}}}function sc(r,e,t){return Gs(typeof r=="function"?e.methods:e.properties,t)}function Gs(r,e){return r.whitelist[e]!==void 0?r.whitelist[e]===!0:r.defaultValue!==void 0?r.defaultValue:(oc(e),!1)}function oc(r){Kr[r]!==!0&&(Kr[r]=!0,nc.default.log("error",'Handlebars: Access has been denied to resolve the property "'+r+`" because it is not an "own property" of its parent.
You can add a runtime option to disable the check or this warning:
See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details`))}function ac(){Object.keys(Kr).forEach(function(r){delete Kr[r]})}});var qr=C(Pe=>{"use strict";Pe.__esModule=!0;Pe.HandlebarsEnvironment=ii;function Bs(r){return r&&r.__esModule?r:{default:r}}var it=Z(),uc=ce(),ri=Bs(uc),cc=Jn(),lc=Ls(),dc=Xn(),$r=Bs(dc),hc=ti(),fc="4.7.8";Pe.VERSION=fc;var pc=8;Pe.COMPILER_REVISION=pc;var gc=7;Pe.LAST_COMPATIBLE_COMPILER_REVISION=gc;var mc={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};Pe.REVISION_CHANGES=mc;var ni="[object Object]";function ii(r,e,t){this.helpers=r||{},this.partials=e||{},this.decorators=t||{},cc.registerDefaultHelpers(this),lc.registerDefaultDecorators(this)}ii.prototype={constructor:ii,logger:$r.default,log:$r.default.log,registerHelper:function(e,t){if(it.toString.call(e)===ni){if(t)throw new ri.default("Arg not supported with multiple helpers");it.extend(this.helpers,e)}else this.helpers[e]=t},unregisterHelper:function(e){delete this.helpers[e]},registerPartial:function(e,t){if(it.toString.call(e)===ni)it.extend(this.partials,e);else{if(typeof t=="undefined")throw new ri.default('Attempting to register a partial called "'+e+'" as undefined');this.partials[e]=t}},unregisterPartial:function(e){delete this.partials[e]},registerDecorator:function(e,t){if(it.toString.call(e)===ni){if(t)throw new ri.default("Arg not supported with multiple decorators");it.extend(this.decorators,e)}else this.decorators[e]=t},unregisterDecorator:function(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function(){hc.resetLoggedProperties()}};var yc=$r.default.log;Pe.log=yc;Pe.createFrame=it.createFrame;Pe.logger=$r.default});var Ks=C((Hr,Fs)=>{"use strict";Hr.__esModule=!0;function si(r){this.string=r}si.prototype.toString=si.prototype.toHTML=function(){return""+this.string};Hr.default=si;Fs.exports=Hr.default});var $s=C(oi=>{"use strict";oi.__esModule=!0;oi.wrapHelper=vc;function vc(r,e){if(typeof r!="function")return r;var t=function(){var i=arguments[arguments.length-1];return arguments[arguments.length-1]=e(i),r.apply(this,arguments)};return t}});var zs=C(Qe=>{"use strict";Qe.__esModule=!0;Qe.checkRevision=Sc;Qe.template=xc;Qe.wrapProgram=Ur;Qe.resolvePartial=Cc;Qe.invokePartial=Pc;Qe.noop=Us;function _c(r){return r&&r.__esModule?r:{default:r}}function wc(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var bc=Z(),De=wc(bc),kc=ce(),Me=_c(kc),Ge=qr(),qs=Jn(),Ec=$s(),Hs=ti();function Sc(r){var e=r&&r[0]||1,t=Ge.COMPILER_REVISION;if(!(e>=Ge.LAST_COMPATIBLE_COMPILER_REVISION&&e<=Ge.COMPILER_REVISION))if(e<Ge.LAST_COMPATIBLE_COMPILER_REVISION){var n=Ge.REVISION_CHANGES[t],i=Ge.REVISION_CHANGES[e];throw new Me.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+i+").")}else throw new Me.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+r[1]+").")}function xc(r,e){if(!e)throw new Me.default("No environment passed to template");if(!r||!r.main)throw new Me.default("Unknown template object: "+typeof r);r.main.decorator=r.main_d,e.VM.checkRevision(r.compiler);var t=r.compiler&&r.compiler[0]===7;function n(o,a,c){c.hash&&(a=De.extend({},a,c.hash),c.ids&&(c.ids[0]=!0)),o=e.VM.resolvePartial.call(this,o,a,c);var u=De.extend({},c,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),d=e.VM.invokePartial.call(this,o,a,u);if(d==null&&e.compile&&(c.partials[c.name]=e.compile(o,r.compilerOptions,e),d=c.partials[c.name](a,u)),d!=null){if(c.indent){for(var l=d.split(`
`),h=0,f=l.length;h<f&&!(!l[h]&&h+1===f);h++)l[h]=c.indent+l[h];d=l.join(`
`)}return d}else throw new Me.default("The partial "+c.name+" could not be compiled when running in runtime-only mode")}var i={strict:function(a,c,u){if(!a||!(c in a))throw new Me.default('"'+c+'" not defined in '+a,{loc:u});return i.lookupProperty(a,c)},lookupProperty:function(a,c){var u=a[c];if(u==null||Object.prototype.hasOwnProperty.call(a,c)||Hs.resultIsAllowed(u,i.protoAccessControl,c))return u},lookup:function(a,c){for(var u=a.length,d=0;d<u;d++){var l=a[d]&&i.lookupProperty(a[d],c);if(l!=null)return a[d][c]}},lambda:function(a,c){return typeof a=="function"?a.call(c):a},escapeExpression:De.escapeExpression,invokePartial:n,fn:function(a){var c=r[a];return c.decorator=r[a+"_d"],c},programs:[],program:function(a,c,u,d,l){var h=this.programs[a],f=this.fn(a);return c||l||d||u?h=Ur(this,a,f,c,u,d,l):h||(h=this.programs[a]=Ur(this,a,f)),h},data:function(a,c){for(;a&&c--;)a=a._parent;return a},mergeIfNeeded:function(a,c){var u=a||c;return a&&c&&a!==c&&(u=De.extend({},c,a)),u},nullContext:Object.seal({}),noop:e.VM.noop,compilerInfo:r.compiler};function s(o){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],c=a.data;s._setup(a),!a.partial&&r.useData&&(c=Nc(o,c));var u=void 0,d=r.useBlockParams?[]:void 0;r.useDepths&&(a.depths?u=o!=a.depths[0]?[o].concat(a.depths):a.depths:u=[o]);function l(h){return""+r.main(i,h,i.helpers,i.partials,c,d,u)}return l=js(r.main,l,i,a.depths||[],c,d),l(o,a)}return s.isTop=!0,s._setup=function(o){if(o.partial)i.protoAccessControl=o.protoAccessControl,i.helpers=o.helpers,i.partials=o.partials,i.decorators=o.decorators,i.hooks=o.hooks;else{var a=De.extend({},e.helpers,o.helpers);Tc(a,i),i.helpers=a,r.usePartial&&(i.partials=i.mergeIfNeeded(o.partials,e.partials)),(r.usePartial||r.useDecorators)&&(i.decorators=De.extend({},e.decorators,o.decorators)),i.hooks={},i.protoAccessControl=Hs.createProtoAccessControl(o);var c=o.allowCallsToHelperMissing||t;qs.moveHelperToHooks(i,"helperMissing",c),qs.moveHelperToHooks(i,"blockHelperMissing",c)}},s._child=function(o,a,c,u){if(r.useBlockParams&&!c)throw new Me.default("must pass block params");if(r.useDepths&&!u)throw new Me.default("must pass parent depths");return Ur(i,o,r[o],a,0,c,u)},s}function Ur(r,e,t,n,i,s,o){function a(c){var u=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],d=o;return o&&c!=o[0]&&!(c===r.nullContext&&o[0]===null)&&(d=[c].concat(o)),t(r,c,r.helpers,r.partials,u.data||n,s&&[u.blockParams].concat(s),d)}return a=js(t,a,r,o,n,s),a.program=e,a.depth=o?o.length:0,a.blockParams=i||0,a}function Cc(r,e,t){return r?!r.call&&!t.name&&(t.name=r,r=t.partials[r]):t.name==="@partial-block"?r=t.data["partial-block"]:r=t.partials[t.name],r}function Pc(r,e,t){var n=t.data&&t.data["partial-block"];t.partial=!0,t.ids&&(t.data.contextPath=t.ids[0]||t.data.contextPath);var i=void 0;if(t.fn&&t.fn!==Us&&function(){t.data=Ge.createFrame(t.data);var s=t.fn;i=t.data["partial-block"]=function(a){var c=arguments.length<=1||arguments[1]===void 0?{}:arguments[1];return c.data=Ge.createFrame(c.data),c.data["partial-block"]=n,s(a,c)},s.partials&&(t.partials=De.extend({},t.partials,s.partials))}(),r===void 0&&i&&(r=i),r===void 0)throw new Me.default("The partial "+t.name+" could not be found");if(r instanceof Function)return r(e,t)}function Us(){return""}function Nc(r,e){return(!e||!("root"in e))&&(e=e?Ge.createFrame(e):{},e.root=r),e}function js(r,e,t,n,i,s){if(r.decorator){var o={};e=r.decorator(e,o,t,n&&n[0],i,s,n),De.extend(e,o)}return e}function Tc(r,e){Object.keys(r).forEach(function(t){var n=r[t];r[t]=Ac(n,e)})}function Ac(r,e){var t=e.lookupProperty;return Ec.wrapHelper(r,function(n){return De.extend({lookupProperty:t},n)})}});var ai=C((jr,Vs)=>{"use strict";jr.__esModule=!0;jr.default=function(r){(function(){typeof globalThis!="object"&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__)})();var e=globalThis.Handlebars;r.noConflict=function(){return globalThis.Handlebars===r&&(globalThis.Handlebars=e),r}};Vs.exports=jr.default});var Ys=C((zr,Js)=>{"use strict";zr.__esModule=!0;function ci(r){return r&&r.__esModule?r:{default:r}}function li(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}var Oc=qr(),Ws=li(Oc),Ic=Ks(),Lc=ci(Ic),Rc=ce(),Dc=ci(Rc),Mc=Z(),ui=li(Mc),Gc=zs(),Zs=li(Gc),Bc=ai(),Fc=ci(Bc);function Qs(){var r=new Ws.HandlebarsEnvironment;return ui.extend(r,Ws),r.SafeString=Lc.default,r.Exception=Dc.default,r.Utils=ui,r.escapeExpression=ui.escapeExpression,r.VM=Zs,r.template=function(e){return Zs.template(e,r)},r}var nr=Qs();nr.create=Qs;Fc.default(nr);nr.default=nr;zr.default=nr;Js.exports=zr.default});var di=C((Vr,eo)=>{"use strict";Vr.__esModule=!0;var Xs={helpers:{helperExpression:function(e){return e.type==="SubExpression"||(e.type==="MustacheStatement"||e.type==="BlockStatement")&&!!(e.params&&e.params.length||e.hash)},scopedId:function(e){return/^\.|this\b/.test(e.original)},simpleId:function(e){return e.parts.length===1&&!Xs.helpers.scopedId(e)&&!e.depth}}};Vr.default=Xs;eo.exports=Vr.default});var ro=C((Wr,to)=>{"use strict";Wr.__esModule=!0;var Kc=function(){var r={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function(i,s,o,a,c,u,d){var l=u.length-1;switch(c){case 1:return u[l-1];case 2:this.$=a.prepareProgram(u[l]);break;case 3:this.$=u[l];break;case 4:this.$=u[l];break;case 5:this.$=u[l];break;case 6:this.$=u[l];break;case 7:this.$=u[l];break;case 8:this.$=u[l];break;case 9:this.$={type:"CommentStatement",value:a.stripComment(u[l]),strip:a.stripFlags(u[l],u[l]),loc:a.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:u[l],value:u[l],loc:a.locInfo(this._$)};break;case 11:this.$=a.prepareRawBlock(u[l-2],u[l-1],u[l],this._$);break;case 12:this.$={path:u[l-3],params:u[l-2],hash:u[l-1]};break;case 13:this.$=a.prepareBlock(u[l-3],u[l-2],u[l-1],u[l],!1,this._$);break;case 14:this.$=a.prepareBlock(u[l-3],u[l-2],u[l-1],u[l],!0,this._$);break;case 15:this.$={open:u[l-5],path:u[l-4],params:u[l-3],hash:u[l-2],blockParams:u[l-1],strip:a.stripFlags(u[l-5],u[l])};break;case 16:this.$={path:u[l-4],params:u[l-3],hash:u[l-2],blockParams:u[l-1],strip:a.stripFlags(u[l-5],u[l])};break;case 17:this.$={path:u[l-4],params:u[l-3],hash:u[l-2],blockParams:u[l-1],strip:a.stripFlags(u[l-5],u[l])};break;case 18:this.$={strip:a.stripFlags(u[l-1],u[l-1]),program:u[l]};break;case 19:var h=a.prepareBlock(u[l-2],u[l-1],u[l],u[l],!1,this._$),f=a.prepareProgram([h],u[l-1].loc);f.chained=!0,this.$={strip:u[l-2].strip,program:f,chain:!0};break;case 20:this.$=u[l];break;case 21:this.$={path:u[l-1],strip:a.stripFlags(u[l-2],u[l])};break;case 22:this.$=a.prepareMustache(u[l-3],u[l-2],u[l-1],u[l-4],a.stripFlags(u[l-4],u[l]),this._$);break;case 23:this.$=a.prepareMustache(u[l-3],u[l-2],u[l-1],u[l-4],a.stripFlags(u[l-4],u[l]),this._$);break;case 24:this.$={type:"PartialStatement",name:u[l-3],params:u[l-2],hash:u[l-1],indent:"",strip:a.stripFlags(u[l-4],u[l]),loc:a.locInfo(this._$)};break;case 25:this.$=a.preparePartialBlock(u[l-2],u[l-1],u[l],this._$);break;case 26:this.$={path:u[l-3],params:u[l-2],hash:u[l-1],strip:a.stripFlags(u[l-4],u[l])};break;case 27:this.$=u[l];break;case 28:this.$=u[l];break;case 29:this.$={type:"SubExpression",path:u[l-3],params:u[l-2],hash:u[l-1],loc:a.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:u[l],loc:a.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:a.id(u[l-2]),value:u[l],loc:a.locInfo(this._$)};break;case 32:this.$=a.id(u[l-1]);break;case 33:this.$=u[l];break;case 34:this.$=u[l];break;case 35:this.$={type:"StringLiteral",value:u[l],original:u[l],loc:a.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(u[l]),original:Number(u[l]),loc:a.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:u[l]==="true",original:u[l]==="true",loc:a.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:void 0,value:void 0,loc:a.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:a.locInfo(this._$)};break;case 40:this.$=u[l];break;case 41:this.$=u[l];break;case 42:this.$=a.preparePath(!0,u[l],this._$);break;case 43:this.$=a.preparePath(!1,u[l],this._$);break;case 44:u[l-2].push({part:a.id(u[l]),original:u[l],separator:u[l-1]}),this.$=u[l-2];break;case 45:this.$=[{part:a.id(u[l]),original:u[l]}];break;case 46:this.$=[];break;case 47:u[l-1].push(u[l]);break;case 48:this.$=[];break;case 49:u[l-1].push(u[l]);break;case 50:this.$=[];break;case 51:u[l-1].push(u[l]);break;case 58:this.$=[];break;case 59:u[l-1].push(u[l]);break;case 64:this.$=[];break;case 65:u[l-1].push(u[l]);break;case 70:this.$=[];break;case 71:u[l-1].push(u[l]);break;case 78:this.$=[];break;case 79:u[l-1].push(u[l]);break;case 82:this.$=[];break;case 83:u[l-1].push(u[l]);break;case 86:this.$=[];break;case 87:u[l-1].push(u[l]);break;case 90:this.$=[];break;case 91:u[l-1].push(u[l]);break;case 94:this.$=[];break;case 95:u[l-1].push(u[l]);break;case 98:this.$=[u[l]];break;case 99:u[l-1].push(u[l]);break;case 100:this.$=[u[l]];break;case 101:u[l-1].push(u[l]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function(i,s){throw new Error(i)},parse:function(i){var s=this,o=[0],a=[null],c=[],u=this.table,d="",l=0,h=0,f=0,b=2,T=1;this.lexer.setInput(i),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var I=this.lexer.yylloc;c.push(I);var A=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);function F(xe){o.length=o.length-2*xe,a.length=a.length-xe,c.length=c.length-xe}function ae(){var xe;return xe=s.lexer.lex()||1,typeof xe!="number"&&(xe=s.symbols_[xe]||xe),xe}for(var B,Yt,_e,ue,bf,Hn,Ct={},Sr,Le,ns,xr;;){if(_e=o[o.length-1],this.defaultActions[_e]?ue=this.defaultActions[_e]:((B===null||typeof B=="undefined")&&(B=ae()),ue=u[_e]&&u[_e][B]),typeof ue=="undefined"||!ue.length||!ue[0]){var Un="";if(!f){xr=[];for(Sr in u[_e])this.terminals_[Sr]&&Sr>2&&xr.push("'"+this.terminals_[Sr]+"'");this.lexer.showPosition?Un="Parse error on line "+(l+1)+`:
`+this.lexer.showPosition()+`
Expecting `+xr.join(", ")+", got '"+(this.terminals_[B]||B)+"'":Un="Parse error on line "+(l+1)+": Unexpected "+(B==1?"end of input":"'"+(this.terminals_[B]||B)+"'"),this.parseError(Un,{text:this.lexer.match,token:this.terminals_[B]||B,line:this.lexer.yylineno,loc:I,expected:xr})}}if(ue[0]instanceof Array&&ue.length>1)throw new Error("Parse Error: multiple actions possible at state: "+_e+", token: "+B);switch(ue[0]){case 1:o.push(B),a.push(this.lexer.yytext),c.push(this.lexer.yylloc),o.push(ue[1]),B=null,Yt?(B=Yt,Yt=null):(h=this.lexer.yyleng,d=this.lexer.yytext,l=this.lexer.yylineno,I=this.lexer.yylloc,f>0&&f--);break;case 2:if(Le=this.productions_[ue[1]][1],Ct.$=a[a.length-Le],Ct._$={first_line:c[c.length-(Le||1)].first_line,last_line:c[c.length-1].last_line,first_column:c[c.length-(Le||1)].first_column,last_column:c[c.length-1].last_column},A&&(Ct._$.range=[c[c.length-(Le||1)].range[0],c[c.length-1].range[1]]),Hn=this.performAction.call(Ct,d,h,l,this.yy,ue[1],a,c),typeof Hn!="undefined")return Hn;Le&&(o=o.slice(0,-1*Le*2),a=a.slice(0,-1*Le),c=c.slice(0,-1*Le)),o.push(this.productions_[ue[1]][0]),a.push(Ct.$),c.push(Ct._$),ns=u[o[o.length-2]][o[o.length-1]],o.push(ns);break;case 3:return!0}}return!0}},e=function(){var n={EOF:1,parseError:function(s,o){if(this.yy.parser)this.yy.parser.parseError(s,o);else throw new Error(s)},setInput:function(s){return this._input=s,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var s=this._input[0];this.yytext+=s,this.yyleng++,this.offset++,this.match+=s,this.matched+=s;var o=s.match(/(?:\r\n?|\n).*/g);return o?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),s},unput:function(s){var o=s.length,a=s.split(/(?:\r\n?|\n)/g);this._input=s+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-o-1),this.offset-=o;var c=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),a.length-1&&(this.yylineno-=a.length-1);var u=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:a?(a.length===c.length?this.yylloc.first_column:0)+c[c.length-a.length].length-a[0].length:this.yylloc.first_column-o},this.options.ranges&&(this.yylloc.range=[u[0],u[0]+this.yyleng-o]),this},more:function(){return this._more=!0,this},less:function(s){this.unput(this.match.slice(s))},pastInput:function(){var s=this.matched.substr(0,this.matched.length-this.match.length);return(s.length>20?"...":"")+s.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var s=this.match;return s.length<20&&(s+=this._input.substr(0,20-s.length)),(s.substr(0,20)+(s.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var s=this.pastInput(),o=new Array(s.length+1).join("-");return s+this.upcomingInput()+`
`+o+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var s,o,a,c,u,d;this._more||(this.yytext="",this.match="");for(var l=this._currentRules(),h=0;h<l.length&&(a=this._input.match(this.rules[l[h]]),!(a&&(!o||a[0].length>o[0].length)&&(o=a,c=h,!this.options.flex)));h++);return o?(d=o[0].match(/(?:\r\n?|\n).*/g),d&&(this.yylineno+=d.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:d?d[d.length-1].length-d[d.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+o[0].length},this.yytext+=o[0],this.match+=o[0],this.matches=o,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(o[0].length),this.matched+=o[0],s=this.performAction.call(this,this.yy,this,l[c],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s||void 0):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var s=this.next();return typeof s!="undefined"?s:this.lex()},begin:function(s){this.conditionStack.push(s)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(s){this.begin(s)}};return n.options={},n.performAction=function(s,o,a,c){function u(l,h){return o.yytext=o.yytext.substring(l,o.yyleng-h+l)}var d=c;switch(a){case 0:if(o.yytext.slice(-2)==="\\\\"?(u(0,1),this.begin("mu")):o.yytext.slice(-1)==="\\"?(u(0,1),this.begin("emu")):this.begin("mu"),o.yytext)return 15;break;case 1:return 15;case 2:return this.popState(),15;break;case 3:return this.begin("raw"),15;break;case 4:return this.popState(),this.conditionStack[this.conditionStack.length-1]==="raw"?15:(u(5,9),"END_RAW_BLOCK");case 5:return 15;case 6:return this.popState(),14;break;case 7:return 65;case 8:return 68;case 9:return 19;case 10:return this.popState(),this.begin("raw"),23;break;case 11:return 55;case 12:return 60;case 13:return 29;case 14:return 47;case 15:return this.popState(),44;break;case 16:return this.popState(),44;break;case 17:return 34;case 18:return 39;case 19:return 51;case 20:return 48;case 21:this.unput(o.yytext),this.popState(),this.begin("com");break;case 22:return this.popState(),14;break;case 23:return 48;case 24:return 73;case 25:return 72;case 26:return 72;case 27:return 87;case 28:break;case 29:return this.popState(),54;break;case 30:return this.popState(),33;break;case 31:return o.yytext=u(1,2).replace(/\\"/g,'"'),80;break;case 32:return o.yytext=u(1,2).replace(/\\'/g,"'"),80;break;case 33:return 85;case 34:return 82;case 35:return 82;case 36:return 83;case 37:return 84;case 38:return 81;case 39:return 75;case 40:return 77;case 41:return 72;case 42:return o.yytext=o.yytext.replace(/\\([\\\]])/g,"$1"),72;break;case 43:return"INVALID";case 44:return 5}},n.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/],n.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[6],inclusive:!1},raw:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,44],inclusive:!0}},n}();r.lexer=e;function t(){this.yy={}}return t.prototype=r,r.Parser=t,new t}();Wr.default=Kc;to.exports=Wr.default});var fi=C((Jr,so)=>{"use strict";Jr.__esModule=!0;function $c(r){return r&&r.__esModule?r:{default:r}}var qc=ce(),hi=$c(qc);function Zr(){this.parents=[]}Zr.prototype={constructor:Zr,mutating:!1,acceptKey:function(e,t){var n=this.accept(e[t]);if(this.mutating){if(n&&!Zr.prototype[n.type])throw new hi.default('Unexpected node type "'+n.type+'" found when accepting '+t+" on "+e.type);e[t]=n}},acceptRequired:function(e,t){if(this.acceptKey(e,t),!e[t])throw new hi.default(e.type+" requires "+t)},acceptArray:function(e){for(var t=0,n=e.length;t<n;t++)this.acceptKey(e,t),e[t]||(e.splice(t,1),t--,n--)},accept:function(e){if(e){if(!this[e.type])throw new hi.default("Unknown type: "+e.type,e);this.current&&this.parents.unshift(this.current),this.current=e;var t=this[e.type](e);if(this.current=this.parents.shift(),!this.mutating||t)return t;if(t!==!1)return e}},Program:function(e){this.acceptArray(e.body)},MustacheStatement:Qr,Decorator:Qr,BlockStatement:no,DecoratorBlock:no,PartialStatement:io,PartialBlockStatement:function(e){io.call(this,e),this.acceptKey(e,"program")},ContentStatement:function(){},CommentStatement:function(){},SubExpression:Qr,PathExpression:function(){},StringLiteral:function(){},NumberLiteral:function(){},BooleanLiteral:function(){},UndefinedLiteral:function(){},NullLiteral:function(){},Hash:function(e){this.acceptArray(e.pairs)},HashPair:function(e){this.acceptRequired(e,"value")}};function Qr(r){this.acceptRequired(r,"path"),this.acceptArray(r.params),this.acceptKey(r,"hash")}function no(r){Qr.call(this,r),this.acceptKey(r,"program"),this.acceptKey(r,"inverse")}function io(r){this.acceptRequired(r,"name"),this.acceptArray(r.params),this.acceptKey(r,"hash")}Jr.default=Zr;so.exports=Jr.default});var ao=C((Yr,oo)=>{"use strict";Yr.__esModule=!0;function Hc(r){return r&&r.__esModule?r:{default:r}}var Uc=fi(),jc=Hc(Uc);function Ne(){var r=arguments.length<=0||arguments[0]===void 0?{}:arguments[0];this.options=r}Ne.prototype=new jc.default;Ne.prototype.Program=function(r){var e=!this.options.ignoreStandalone,t=!this.isRootSeen;this.isRootSeen=!0;for(var n=r.body,i=0,s=n.length;i<s;i++){var o=n[i],a=this.accept(o);if(a){var c=pi(n,i,t),u=gi(n,i,t),d=a.openStandalone&&c,l=a.closeStandalone&&u,h=a.inlineStandalone&&c&&u;a.close&&st(n,i,!0),a.open&&Je(n,i,!0),e&&h&&(st(n,i),Je(n,i)&&o.type==="PartialStatement"&&(o.indent=/([ \t]+$)/.exec(n[i-1].original)[1])),e&&d&&(st((o.program||o.inverse).body),Je(n,i)),e&&l&&(st(n,i),Je((o.inverse||o.program).body))}}return r};Ne.prototype.BlockStatement=Ne.prototype.DecoratorBlock=Ne.prototype.PartialBlockStatement=function(r){this.accept(r.program),this.accept(r.inverse);var e=r.program||r.inverse,t=r.program&&r.inverse,n=t,i=t;if(t&&t.chained)for(n=t.body[0].program;i.chained;)i=i.body[i.body.length-1].program;var s={open:r.openStrip.open,close:r.closeStrip.close,openStandalone:gi(e.body),closeStandalone:pi((n||e).body)};if(r.openStrip.close&&st(e.body,null,!0),t){var o=r.inverseStrip;o.open&&Je(e.body,null,!0),o.close&&st(n.body,null,!0),r.closeStrip.open&&Je(i.body,null,!0),!this.options.ignoreStandalone&&pi(e.body)&&gi(n.body)&&(Je(e.body),st(n.body))}else r.closeStrip.open&&Je(e.body,null,!0);return s};Ne.prototype.Decorator=Ne.prototype.MustacheStatement=function(r){return r.strip};Ne.prototype.PartialStatement=Ne.prototype.CommentStatement=function(r){var e=r.strip||{};return{inlineStandalone:!0,open:e.open,close:e.close}};function pi(r,e,t){e===void 0&&(e=r.length);var n=r[e-1],i=r[e-2];if(!n)return t;if(n.type==="ContentStatement")return(i||!t?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(n.original)}function gi(r,e,t){e===void 0&&(e=-1);var n=r[e+1],i=r[e+2];if(!n)return t;if(n.type==="ContentStatement")return(i||!t?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(n.original)}function st(r,e,t){var n=r[e==null?0:e+1];if(!(!n||n.type!=="ContentStatement"||!t&&n.rightStripped)){var i=n.value;n.value=n.value.replace(t?/^\s+/:/^[ \t]*\r?\n?/,""),n.rightStripped=n.value!==i}}function Je(r,e,t){var n=r[e==null?r.length-1:e-1];if(!(!n||n.type!=="ContentStatement"||!t&&n.leftStripped)){var i=n.value;return n.value=n.value.replace(t?/\s+$/:/[ \t]+$/,""),n.leftStripped=n.value!==i,n.leftStripped}}Yr.default=Ne;oo.exports=Yr.default});var uo=C(le=>{"use strict";le.__esModule=!0;le.SourceLocation=Wc;le.id=Zc;le.stripFlags=Qc;le.stripComment=Jc;le.preparePath=Yc;le.prepareMustache=Xc;le.prepareRawBlock=el;le.prepareBlock=tl;le.prepareProgram=rl;le.preparePartialBlock=nl;function zc(r){return r&&r.__esModule?r:{default:r}}var Vc=ce(),mi=zc(Vc);function yi(r,e){if(e=e.path?e.path.original:e,r.path.original!==e){var t={loc:r.path.loc};throw new mi.default(r.path.original+" doesn't match "+e,t)}}function Wc(r,e){this.source=r,this.start={line:e.first_line,column:e.first_column},this.end={line:e.last_line,column:e.last_column}}function Zc(r){return/^\[.*\]$/.test(r)?r.substring(1,r.length-1):r}function Qc(r,e){return{open:r.charAt(2)==="~",close:e.charAt(e.length-3)==="~"}}function Jc(r){return r.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function Yc(r,e,t){t=this.locInfo(t);for(var n=r?"@":"",i=[],s=0,o=0,a=e.length;o<a;o++){var c=e[o].part,u=e[o].original!==c;if(n+=(e[o].separator||"")+c,!u&&(c===".."||c==="."||c==="this")){if(i.length>0)throw new mi.default("Invalid path: "+n,{loc:t});c===".."&&s++}else i.push(c)}return{type:"PathExpression",data:r,depth:s,parts:i,original:n,loc:t}}function Xc(r,e,t,n,i,s){var o=n.charAt(3)||n.charAt(2),a=o!=="{"&&o!=="&",c=/\*/.test(n);return{type:c?"Decorator":"MustacheStatement",path:r,params:e,hash:t,escaped:a,strip:i,loc:this.locInfo(s)}}function el(r,e,t,n){yi(r,t),n=this.locInfo(n);var i={type:"Program",body:e,strip:{},loc:n};return{type:"BlockStatement",path:r.path,params:r.params,hash:r.hash,program:i,openStrip:{},inverseStrip:{},closeStrip:{},loc:n}}function tl(r,e,t,n,i,s){n&&n.path&&yi(r,n);var o=/\*/.test(r.open);e.blockParams=r.blockParams;var a=void 0,c=void 0;if(t){if(o)throw new mi.default("Unexpected inverse block on decorator",t);t.chain&&(t.program.body[0].closeStrip=n.strip),c=t.strip,a=t.program}return i&&(i=a,a=e,e=i),{type:o?"DecoratorBlock":"BlockStatement",path:r.path,params:r.params,hash:r.hash,program:e,inverse:a,openStrip:r.strip,inverseStrip:c,closeStrip:n&&n.strip,loc:this.locInfo(s)}}function rl(r,e){if(!e&&r.length){var t=r[0].loc,n=r[r.length-1].loc;t&&n&&(e={source:t.source,start:{line:t.start.line,column:t.start.column},end:{line:n.end.line,column:n.end.column}})}return{type:"Program",body:r,strip:{},loc:e}}function nl(r,e,t,n){return yi(r,t),{type:"PartialBlockStatement",name:r.path,params:r.params,hash:r.hash,program:e,openStrip:r.strip,closeStrip:t&&t.strip,loc:this.locInfo(n)}}});var ho=C(ir=>{"use strict";ir.__esModule=!0;ir.parseWithoutProcessing=lo;ir.parse=dl;function il(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t]);return e.default=r,e}function co(r){return r&&r.__esModule?r:{default:r}}var sl=ro(),vi=co(sl),ol=ao(),al=co(ol),ul=uo(),cl=il(ul),ll=Z();ir.parser=vi.default;var Xr={};ll.extend(Xr,cl);function lo(r,e){if(r.type==="Program")return r;vi.default.yy=Xr,Xr.locInfo=function(n){return new Xr.SourceLocation(e&&e.srcName,n)};var t=vi.default.parse(r);return t}function dl(r,e){var t=lo(r,e),n=new al.default(e);return n.accept(t)}});var mo=C(ur=>{"use strict";ur.__esModule=!0;ur.Compiler=_i;ur.precompile=gl;ur.compile=ml;function po(r){return r&&r.__esModule?r:{default:r}}var hl=ce(),or=po(hl),ar=Z(),fl=di(),sr=po(fl),pl=[].slice;function _i(){}_i.prototype={compiler:_i,equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var i=this.opcodes[n],s=e.opcodes[n];if(i.opcode!==s.opcode||!go(i.args,s.args))return!1}t=this.children.length;for(var n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){return this.sourceNode=[],this.opcodes=[],this.children=[],this.options=t,this.stringParams=t.stringParams,this.trackIds=t.trackIds,t.blockParams=t.blockParams||[],t.knownHelpers=ar.extend(Object.create(null),{helperMissing:!0,blockHelperMissing:!0,each:!0,if:!0,unless:!0,with:!0,log:!0,lookup:!0},t.knownHelpers),this.accept(e)},compileProgram:function(e){var t=new this.compiler,n=t.compile(e,this.options),i=this.guid++;return this.usePartial=this.usePartial||n.usePartial,this.children[i]=n,this.useDepths=this.useDepths||n.useDepths,i},accept:function(e){if(!this[e.type])throw new or.default("Unknown type: "+e.type,e);this.sourceNode.unshift(e);var t=this[e.type](e);return this.sourceNode.shift(),t},Program:function(e){this.options.blockParams.unshift(e.blockParams);for(var t=e.body,n=t.length,i=0;i<n;i++)this.accept(t[i]);return this.options.blockParams.shift(),this.isSimple=n===1,this.blockParams=e.blockParams?e.blockParams.length:0,this},BlockStatement:function(e){fo(e);var t=e.program,n=e.inverse;t=t&&this.compileProgram(t),n=n&&this.compileProgram(n);var i=this.classifySexpr(e);i==="helper"?this.helperSexpr(e,t,n):i==="simple"?(this.simpleSexpr(e),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("blockValue",e.path.original)):(this.ambiguousSexpr(e,t,n),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},DecoratorBlock:function(e){var t=e.program&&this.compileProgram(e.program),n=this.setupFullMustacheParams(e,t,void 0),i=e.path;this.useDecorators=!0,this.opcode("registerDecorator",n.length,i.original)},PartialStatement:function(e){this.usePartial=!0;var t=e.program;t&&(t=this.compileProgram(e.program));var n=e.params;if(n.length>1)throw new or.default("Unsupported number of partial arguments: "+n.length,e);n.length||(this.options.explicitPartialContext?this.opcode("pushLiteral","undefined"):n.push({type:"PathExpression",parts:[],depth:0}));var i=e.name.original,s=e.name.type==="SubExpression";s&&this.accept(e.name),this.setupFullMustacheParams(e,t,void 0,!0);var o=e.indent||"";this.options.preventIndent&&o&&(this.opcode("appendContent",o),o=""),this.opcode("invokePartial",s,i,o),this.opcode("append")},PartialBlockStatement:function(e){this.PartialStatement(e)},MustacheStatement:function(e){this.SubExpression(e),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},Decorator:function(e){this.DecoratorBlock(e)},ContentStatement:function(e){e.value&&this.opcode("appendContent",e.value)},CommentStatement:function(){},SubExpression:function(e){fo(e);var t=this.classifySexpr(e);t==="simple"?this.simpleSexpr(e):t==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ambiguousSexpr:function(e,t,n){var i=e.path,s=i.parts[0],o=t!=null||n!=null;this.opcode("getContext",i.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),i.strict=!0,this.accept(i),this.opcode("invokeAmbiguous",s,o)},simpleSexpr:function(e){var t=e.path;t.strict=!0,this.accept(t),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,n){var i=this.setupFullMustacheParams(e,t,n),s=e.path,o=s.parts[0];if(this.options.knownHelpers[o])this.opcode("invokeKnownHelper",i.length,o);else{if(this.options.knownHelpersOnly)throw new or.default("You specified knownHelpersOnly, but used the unknown helper "+o,e);s.strict=!0,s.falsy=!0,this.accept(s),this.opcode("invokeHelper",i.length,s.original,sr.default.helpers.simpleId(s))}},PathExpression:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0],n=sr.default.helpers.scopedId(e),i=!e.depth&&!n&&this.blockParamIndex(t);i?this.opcode("lookupBlockParam",i,e.parts):t?e.data?(this.options.data=!0,this.opcode("lookupData",e.depth,e.parts,e.strict)):this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,n):this.opcode("pushContext")},StringLiteral:function(e){this.opcode("pushString",e.value)},NumberLiteral:function(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function(){this.opcode("pushLiteral","undefined")},NullLiteral:function(){this.opcode("pushLiteral","null")},Hash:function(e){var t=e.pairs,n=0,i=t.length;for(this.opcode("pushHash");n<i;n++)this.pushParam(t[n].value);for(;n--;)this.opcode("assignToHash",t[n].key);this.opcode("popHash")},opcode:function(e){this.opcodes.push({opcode:e,args:pl.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function(e){e&&(this.useDepths=!0)},classifySexpr:function(e){var t=sr.default.helpers.simpleId(e.path),n=t&&!!this.blockParamIndex(e.path.parts[0]),i=!n&&sr.default.helpers.helperExpression(e),s=!n&&(i||t);if(s&&!i){var o=e.path.parts[0],a=this.options;a.knownHelpers[o]?i=!0:a.knownHelpersOnly&&(s=!1)}return i?"helper":s?"ambiguous":"simple"},pushParams:function(e){for(var t=0,n=e.length;t<n;t++)this.pushParam(e[t])},pushParam:function(e){var t=e.value!=null?e.value:e.original||"";if(this.stringParams)t.replace&&(t=t.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")),e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",t,e.type),e.type==="SubExpression"&&this.accept(e);else{if(this.trackIds){var n=void 0;if(e.parts&&!sr.default.helpers.scopedId(e)&&!e.depth&&(n=this.blockParamIndex(e.parts[0])),n){var i=e.parts.slice(1).join(".");this.opcode("pushId","BlockParam",n,i)}else t=e.original||t,t.replace&&(t=t.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")),this.opcode("pushId",e.type,t)}this.accept(e)}},setupFullMustacheParams:function(e,t,n,i){var s=e.params;return this.pushParams(s),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.accept(e.hash):this.opcode("emptyHash",i),s},blockParamIndex:function(e){for(var t=0,n=this.options.blockParams.length;t<n;t++){var i=this.options.blockParams[t],s=i&&ar.indexOf(i,e);if(i&&s>=0)return[t,s]}}};function gl(r,e,t){if(r==null||typeof r!="string"&&r.type!=="Program")throw new or.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+r);e=e||{},"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=t.parse(r,e),i=new t.Compiler().compile(n,e);return new t.JavaScriptCompiler().compile(i,e)}function ml(r,e,t){if(e===void 0&&(e={}),r==null||typeof r!="string"&&r.type!=="Program")throw new or.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+r);e=ar.extend({},e),"data"in e||(e.data=!0),e.compat&&(e.useDepths=!0);var n=void 0;function i(){var o=t.parse(r,e),a=new t.Compiler().compile(o,e),c=new t.JavaScriptCompiler().compile(a,e,void 0,!0);return t.template(c)}function s(o,a){return n||(n=i()),n.call(this,o,a)}return s._setup=function(o){return n||(n=i()),n._setup(o)},s._child=function(o,a,c,u){return n||(n=i()),n._child(o,a,c,u)},s}function go(r,e){if(r===e)return!0;if(ar.isArray(r)&&ar.isArray(e)&&r.length===e.length){for(var t=0;t<r.length;t++)if(!go(r[t],e[t]))return!1;return!0}}function fo(r){if(!r.path.parts){var e=r.path;r.path={type:"PathExpression",data:!1,depth:0,parts:[e.original+""],original:e.original+"",loc:e.loc}}}});var vo=C(wi=>{var yo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");wi.encode=function(r){if(0<=r&&r<yo.length)return yo[r];throw new TypeError("Must be between 0 and 63: "+r)};wi.decode=function(r){var e=65,t=90,n=97,i=122,s=48,o=57,a=43,c=47,u=26,d=52;return e<=r&&r<=t?r-e:n<=r&&r<=i?r-n+u:s<=r&&r<=o?r-s+d:r==a?62:r==c?63:-1}});var Ei=C(ki=>{var _o=vo(),bi=5,wo=1<<bi,bo=wo-1,ko=wo;function yl(r){return r<0?(-r<<1)+1:(r<<1)+0}function vl(r){var e=(r&1)===1,t=r>>1;return e?-t:t}ki.encode=function(e){var t="",n,i=yl(e);do n=i&bo,i>>>=bi,i>0&&(n|=ko),t+=_o.encode(n);while(i>0);return t};ki.decode=function(e,t,n){var i=e.length,s=0,o=0,a,c;do{if(t>=i)throw new Error("Expected more digits in base 64 VLQ value.");if(c=_o.decode(e.charCodeAt(t++)),c===-1)throw new Error("Invalid base64 digit: "+e.charAt(t-1));a=!!(c&ko),c&=bo,s=s+(c<<o),o+=bi}while(a);n.value=vl(s),n.rest=t}});var At=C(V=>{function _l(r,e,t){if(e in r)return r[e];if(arguments.length===3)return t;throw new Error('"'+e+'" is a required argument.')}V.getArg=_l;var Eo=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,wl=/^data:.+\,.+$/;function cr(r){var e=r.match(Eo);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}V.urlParse=cr;function Nt(r){var e="";return r.scheme&&(e+=r.scheme+":"),e+="//",r.auth&&(e+=r.auth+"@"),r.host&&(e+=r.host),r.port&&(e+=":"+r.port),r.path&&(e+=r.path),e}V.urlGenerate=Nt;function Si(r){var e=r,t=cr(r);if(t){if(!t.path)return r;e=t.path}for(var n=V.isAbsolute(e),i=e.split(/\/+/),s,o=0,a=i.length-1;a>=0;a--)s=i[a],s==="."?i.splice(a,1):s===".."?o++:o>0&&(s===""?(i.splice(a+1,o),o=0):(i.splice(a,2),o--));return e=i.join("/"),e===""&&(e=n?"/":"."),t?(t.path=e,Nt(t)):e}V.normalize=Si;function So(r,e){r===""&&(r="."),e===""&&(e=".");var t=cr(e),n=cr(r);if(n&&(r=n.path||"/"),t&&!t.scheme)return n&&(t.scheme=n.scheme),Nt(t);if(t||e.match(wl))return e;if(n&&!n.host&&!n.path)return n.host=e,Nt(n);var i=e.charAt(0)==="/"?e:Si(r.replace(/\/+$/,"")+"/"+e);return n?(n.path=i,Nt(n)):i}V.join=So;V.isAbsolute=function(r){return r.charAt(0)==="/"||Eo.test(r)};function bl(r,e){r===""&&(r="."),r=r.replace(/\/$/,"");for(var t=0;e.indexOf(r+"/")!==0;){var n=r.lastIndexOf("/");if(n<0||(r=r.slice(0,n),r.match(/^([^\/]+:\/)?\/*$/)))return e;++t}return Array(t+1).join("../")+e.substr(r.length+1)}V.relative=bl;var xo=function(){var r=Object.create(null);return!("__proto__"in r)}();function Co(r){return r}function kl(r){return Po(r)?"$"+r:r}V.toSetString=xo?Co:kl;function El(r){return Po(r)?r.slice(1):r}V.fromSetString=xo?Co:El;function Po(r){if(!r)return!1;var e=r.length;if(e<9||r.charCodeAt(e-1)!==95||r.charCodeAt(e-2)!==95||r.charCodeAt(e-3)!==111||r.charCodeAt(e-4)!==116||r.charCodeAt(e-5)!==111||r.charCodeAt(e-6)!==114||r.charCodeAt(e-7)!==112||r.charCodeAt(e-8)!==95||r.charCodeAt(e-9)!==95)return!1;for(var t=e-10;t>=0;t--)if(r.charCodeAt(t)!==36)return!1;return!0}function Sl(r,e,t){var n=Tt(r.source,e.source);return n!==0||(n=r.originalLine-e.originalLine,n!==0)||(n=r.originalColumn-e.originalColumn,n!==0||t)||(n=r.generatedColumn-e.generatedColumn,n!==0)||(n=r.generatedLine-e.generatedLine,n!==0)?n:Tt(r.name,e.name)}V.compareByOriginalPositions=Sl;function xl(r,e,t){var n=r.generatedLine-e.generatedLine;return n!==0||(n=r.generatedColumn-e.generatedColumn,n!==0||t)||(n=Tt(r.source,e.source),n!==0)||(n=r.originalLine-e.originalLine,n!==0)||(n=r.originalColumn-e.originalColumn,n!==0)?n:Tt(r.name,e.name)}V.compareByGeneratedPositionsDeflated=xl;function Tt(r,e){return r===e?0:r===null?1:e===null?-1:r>e?1:-1}function Cl(r,e){var t=r.generatedLine-e.generatedLine;return t!==0||(t=r.generatedColumn-e.generatedColumn,t!==0)||(t=Tt(r.source,e.source),t!==0)||(t=r.originalLine-e.originalLine,t!==0)||(t=r.originalColumn-e.originalColumn,t!==0)?t:Tt(r.name,e.name)}V.compareByGeneratedPositionsInflated=Cl;function Pl(r){return JSON.parse(r.replace(/^\)]}'[^\n]*\n/,""))}V.parseSourceMapInput=Pl;function Nl(r,e,t){if(e=e||"",r&&(r[r.length-1]!=="/"&&e[0]!=="/"&&(r+="/"),e=r+e),t){var n=cr(t);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var i=n.path.lastIndexOf("/");i>=0&&(n.path=n.path.substring(0,i+1))}e=So(Nt(n),e)}return Si(e)}V.computeSourceURL=Nl});var Pi=C(No=>{var xi=At(),Ci=Object.prototype.hasOwnProperty,ot=typeof Map!="undefined";function Be(){this._array=[],this._set=ot?new Map:Object.create(null)}Be.fromArray=function(e,t){for(var n=new Be,i=0,s=e.length;i<s;i++)n.add(e[i],t);return n};Be.prototype.size=function(){return ot?this._set.size:Object.getOwnPropertyNames(this._set).length};Be.prototype.add=function(e,t){var n=ot?e:xi.toSetString(e),i=ot?this.has(e):Ci.call(this._set,n),s=this._array.length;(!i||t)&&this._array.push(e),i||(ot?this._set.set(e,s):this._set[n]=s)};Be.prototype.has=function(e){if(ot)return this._set.has(e);var t=xi.toSetString(e);return Ci.call(this._set,t)};Be.prototype.indexOf=function(e){if(ot){var t=this._set.get(e);if(t>=0)return t}else{var n=xi.toSetString(e);if(Ci.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')};Be.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};Be.prototype.toArray=function(){return this._array.slice()};No.ArraySet=Be});var Oo=C(Ao=>{var To=At();function Tl(r,e){var t=r.generatedLine,n=e.generatedLine,i=r.generatedColumn,s=e.generatedColumn;return n>t||n==t&&s>=i||To.compareByGeneratedPositionsInflated(r,e)<=0}function en(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}en.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)};en.prototype.add=function(e){Tl(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};en.prototype.toArray=function(){return this._sorted||(this._array.sort(To.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};Ao.MappingList=en});var Ni=C(Io=>{var lr=Ei(),K=At(),tn=Pi().ArraySet,Al=Oo().MappingList;function de(r){r||(r={}),this._file=K.getArg(r,"file",null),this._sourceRoot=K.getArg(r,"sourceRoot",null),this._skipValidation=K.getArg(r,"skipValidation",!1),this._sources=new tn,this._names=new tn,this._mappings=new Al,this._sourcesContents=null}de.prototype._version=3;de.fromSourceMap=function(e){var t=e.sourceRoot,n=new de({file:e.file,sourceRoot:t});return e.eachMapping(function(i){var s={generated:{line:i.generatedLine,column:i.generatedColumn}};i.source!=null&&(s.source=i.source,t!=null&&(s.source=K.relative(t,s.source)),s.original={line:i.originalLine,column:i.originalColumn},i.name!=null&&(s.name=i.name)),n.addMapping(s)}),e.sources.forEach(function(i){var s=i;t!==null&&(s=K.relative(t,i)),n._sources.has(s)||n._sources.add(s);var o=e.sourceContentFor(i);o!=null&&n.setSourceContent(i,o)}),n};de.prototype.addMapping=function(e){var t=K.getArg(e,"generated"),n=K.getArg(e,"original",null),i=K.getArg(e,"source",null),s=K.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,i,s),i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:n!=null&&n.line,originalColumn:n!=null&&n.column,source:i,name:s})};de.prototype.setSourceContent=function(e,t){var n=e;this._sourceRoot!=null&&(n=K.relative(this._sourceRoot,n)),t!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[K.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[K.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};de.prototype.applySourceMap=function(e,t,n){var i=t;if(t==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=e.file}var s=this._sourceRoot;s!=null&&(i=K.relative(s,i));var o=new tn,a=new tn;this._mappings.unsortedForEach(function(c){if(c.source===i&&c.originalLine!=null){var u=e.originalPositionFor({line:c.originalLine,column:c.originalColumn});u.source!=null&&(c.source=u.source,n!=null&&(c.source=K.join(n,c.source)),s!=null&&(c.source=K.relative(s,c.source)),c.originalLine=u.line,c.originalColumn=u.column,u.name!=null&&(c.name=u.name))}var d=c.source;d!=null&&!o.has(d)&&o.add(d);var l=c.name;l!=null&&!a.has(l)&&a.add(l)},this),this._sources=o,this._names=a,e.sources.forEach(function(c){var u=e.sourceContentFor(c);u!=null&&(n!=null&&(c=K.join(n,c)),s!=null&&(c=K.relative(s,c)),this.setSourceContent(c,u))},this)};de.prototype._validateMapping=function(e,t,n,i){if(t&&typeof t.line!="number"&&typeof t.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!n&&!i)){if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:i}))}};de.prototype._serializeMappings=function(){for(var e=0,t=1,n=0,i=0,s=0,o=0,a="",c,u,d,l,h=this._mappings.toArray(),f=0,b=h.length;f<b;f++){if(u=h[f],c="",u.generatedLine!==t)for(e=0;u.generatedLine!==t;)c+=";",t++;else if(f>0){if(!K.compareByGeneratedPositionsInflated(u,h[f-1]))continue;c+=","}c+=lr.encode(u.generatedColumn-e),e=u.generatedColumn,u.source!=null&&(l=this._sources.indexOf(u.source),c+=lr.encode(l-o),o=l,c+=lr.encode(u.originalLine-1-i),i=u.originalLine-1,c+=lr.encode(u.originalColumn-n),n=u.originalColumn,u.name!=null&&(d=this._names.indexOf(u.name),c+=lr.encode(d-s),s=d)),a+=c}return a};de.prototype._generateSourcesContent=function(e,t){return e.map(function(n){if(!this._sourcesContents)return null;t!=null&&(n=K.relative(t,n));var i=K.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)};de.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};de.prototype.toString=function(){return JSON.stringify(this.toJSON())};Io.SourceMapGenerator=de});var Lo=C(at=>{at.GREATEST_LOWER_BOUND=1;at.LEAST_UPPER_BOUND=2;function Ti(r,e,t,n,i,s){var o=Math.floor((e-r)/2)+r,a=i(t,n[o],!0);return a===0?o:a>0?e-o>1?Ti(o,e,t,n,i,s):s==at.LEAST_UPPER_BOUND?e<n.length?e:-1:o:o-r>1?Ti(r,o,t,n,i,s):s==at.LEAST_UPPER_BOUND?o:r<0?-1:r}at.search=function(e,t,n,i){if(t.length===0)return-1;var s=Ti(-1,t.length,e,t,n,i||at.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&n(t[s],t[s-1],!0)===0;)--s;return s}});var Do=C(Ro=>{function Ai(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}function Ol(r,e){return Math.round(r+Math.random()*(e-r))}function Oi(r,e,t,n){if(t<n){var i=Ol(t,n),s=t-1;Ai(r,i,n);for(var o=r[n],a=t;a<n;a++)e(r[a],o)<=0&&(s+=1,Ai(r,s,a));Ai(r,s+1,a);var c=s+1;Oi(r,e,t,c-1),Oi(r,e,c+1,n)}}Ro.quickSort=function(r,e){Oi(r,e,0,r.length-1)}});var Go=C(rn=>{var w=At(),Ii=Lo(),Ot=Pi().ArraySet,Il=Ei(),dr=Do().quickSort;function D(r,e){var t=r;return typeof r=="string"&&(t=w.parseSourceMapInput(r)),t.sections!=null?new be(t,e):new U(t,e)}D.fromSourceMap=function(r,e){return U.fromSourceMap(r,e)};D.prototype._version=3;D.prototype.__generatedMappings=null;Object.defineProperty(D.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});D.prototype.__originalMappings=null;Object.defineProperty(D.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});D.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return n===";"||n===","};D.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")};D.GENERATED_ORDER=1;D.ORIGINAL_ORDER=2;D.GREATEST_LOWER_BOUND=1;D.LEAST_UPPER_BOUND=2;D.prototype.eachMapping=function(e,t,n){var i=t||null,s=n||D.GENERATED_ORDER,o;switch(s){case D.GENERATED_ORDER:o=this._generatedMappings;break;case D.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;o.map(function(c){var u=c.source===null?null:this._sources.at(c.source);return u=w.computeSourceURL(a,u,this._sourceMapURL),{source:u,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(e,i)};D.prototype.allGeneratedPositionsFor=function(e){var t=w.getArg(e,"line"),n={source:w.getArg(e,"source"),originalLine:t,originalColumn:w.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var i=[],s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",w.compareByOriginalPositions,Ii.LEAST_UPPER_BOUND);if(s>=0){var o=this._originalMappings[s];if(e.column===void 0)for(var a=o.originalLine;o&&o.originalLine===a;)i.push({line:w.getArg(o,"generatedLine",null),column:w.getArg(o,"generatedColumn",null),lastColumn:w.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s];else for(var c=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==c;)i.push({line:w.getArg(o,"generatedLine",null),column:w.getArg(o,"generatedColumn",null),lastColumn:w.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s]}return i};rn.SourceMapConsumer=D;function U(r,e){var t=r;typeof r=="string"&&(t=w.parseSourceMapInput(r));var n=w.getArg(t,"version"),i=w.getArg(t,"sources"),s=w.getArg(t,"names",[]),o=w.getArg(t,"sourceRoot",null),a=w.getArg(t,"sourcesContent",null),c=w.getArg(t,"mappings"),u=w.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);o&&(o=w.normalize(o)),i=i.map(String).map(w.normalize).map(function(d){return o&&w.isAbsolute(o)&&w.isAbsolute(d)?w.relative(o,d):d}),this._names=Ot.fromArray(s.map(String),!0),this._sources=Ot.fromArray(i,!0),this._absoluteSources=this._sources.toArray().map(function(d){return w.computeSourceURL(o,d,e)}),this.sourceRoot=o,this.sourcesContent=a,this._mappings=c,this._sourceMapURL=e,this.file=u}U.prototype=Object.create(D.prototype);U.prototype.consumer=D;U.prototype._findSourceIndex=function(r){var e=r;if(this.sourceRoot!=null&&(e=w.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var t;for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==r)return t;return-1};U.fromSourceMap=function(e,t){var n=Object.create(U.prototype),i=n._names=Ot.fromArray(e._names.toArray(),!0),s=n._sources=Ot.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map(function(f){return w.computeSourceURL(n.sourceRoot,f,t)});for(var o=e._mappings.toArray().slice(),a=n.__generatedMappings=[],c=n.__originalMappings=[],u=0,d=o.length;u<d;u++){var l=o[u],h=new Mo;h.generatedLine=l.generatedLine,h.generatedColumn=l.generatedColumn,l.source&&(h.source=s.indexOf(l.source),h.originalLine=l.originalLine,h.originalColumn=l.originalColumn,l.name&&(h.name=i.indexOf(l.name)),c.push(h)),a.push(h)}return dr(n.__originalMappings,w.compareByOriginalPositions),n};U.prototype._version=3;Object.defineProperty(U.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Mo(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}U.prototype._parseMappings=function(e,t){for(var n=1,i=0,s=0,o=0,a=0,c=0,u=e.length,d=0,l={},h={},f=[],b=[],T,I,A,F,ae;d<u;)if(e.charAt(d)===";")n++,d++,i=0;else if(e.charAt(d)===",")d++;else{for(T=new Mo,T.generatedLine=n,F=d;F<u&&!this._charIsMappingSeparator(e,F);F++);if(I=e.slice(d,F),A=l[I],A)d+=I.length;else{for(A=[];d<F;)Il.decode(e,d,h),ae=h.value,d=h.rest,A.push(ae);if(A.length===2)throw new Error("Found a source, but no line and column");if(A.length===3)throw new Error("Found a source and line, but no column");l[I]=A}T.generatedColumn=i+A[0],i=T.generatedColumn,A.length>1&&(T.source=a+A[1],a+=A[1],T.originalLine=s+A[2],s=T.originalLine,T.originalLine+=1,T.originalColumn=o+A[3],o=T.originalColumn,A.length>4&&(T.name=c+A[4],c+=A[4])),b.push(T),typeof T.originalLine=="number"&&f.push(T)}dr(b,w.compareByGeneratedPositionsDeflated),this.__generatedMappings=b,dr(f,w.compareByOriginalPositions),this.__originalMappings=f};U.prototype._findMapping=function(e,t,n,i,s,o){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return Ii.search(e,t,s,o)};U.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}};U.prototype.originalPositionFor=function(e){var t={generatedLine:w.getArg(e,"line"),generatedColumn:w.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",w.compareByGeneratedPositionsDeflated,w.getArg(e,"bias",D.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===t.generatedLine){var s=w.getArg(i,"source",null);s!==null&&(s=this._sources.at(s),s=w.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var o=w.getArg(i,"name",null);return o!==null&&(o=this._names.at(o)),{source:s,line:w.getArg(i,"originalLine",null),column:w.getArg(i,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}};U.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};U.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i=e;this.sourceRoot!=null&&(i=w.relative(this.sourceRoot,i));var s;if(this.sourceRoot!=null&&(s=w.urlParse(this.sourceRoot))){var o=i.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||s.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(t)return null;throw new Error('"'+i+'" is not in the SourceMap.')};U.prototype.generatedPositionFor=function(e){var t=w.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:w.getArg(e,"line"),originalColumn:w.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",w.compareByOriginalPositions,w.getArg(e,"bias",D.GREATEST_LOWER_BOUND));if(i>=0){var s=this._originalMappings[i];if(s.source===n.source)return{line:w.getArg(s,"generatedLine",null),column:w.getArg(s,"generatedColumn",null),lastColumn:w.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};rn.BasicSourceMapConsumer=U;function be(r,e){var t=r;typeof r=="string"&&(t=w.parseSourceMapInput(r));var n=w.getArg(t,"version"),i=w.getArg(t,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new Ot,this._names=new Ot;var s={line:-1,column:0};this._sections=i.map(function(o){if(o.url)throw new Error("Support for url field in sections not implemented.");var a=w.getArg(o,"offset"),c=w.getArg(a,"line"),u=w.getArg(a,"column");if(c<s.line||c===s.line&&u<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=a,{generatedOffset:{generatedLine:c+1,generatedColumn:u+1},consumer:new D(w.getArg(o,"map"),e)}})}be.prototype=Object.create(D.prototype);be.prototype.constructor=D;be.prototype._version=3;Object.defineProperty(be.prototype,"sources",{get:function(){for(var r=[],e=0;e<this._sections.length;e++)for(var t=0;t<this._sections[e].consumer.sources.length;t++)r.push(this._sections[e].consumer.sources[t]);return r}});be.prototype.originalPositionFor=function(e){var t={generatedLine:w.getArg(e,"line"),generatedColumn:w.getArg(e,"column")},n=Ii.search(t,this._sections,function(s,o){var a=s.generatedLine-o.generatedOffset.generatedLine;return a||s.generatedColumn-o.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};be.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};be.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var i=this._sections[n],s=i.consumer.sourceContentFor(e,!0);if(s)return s}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')};be.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(n.consumer._findSourceIndex(w.getArg(e,"source"))!==-1){var i=n.consumer.generatedPositionFor(e);if(i){var s={line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};be.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],s=i.consumer._generatedMappings,o=0;o<s.length;o++){var a=s[o],c=i.consumer._sources.at(a.source);c=w.computeSourceURL(i.consumer.sourceRoot,c,this._sourceMapURL),this._sources.add(c),c=this._sources.indexOf(c);var u=null;a.name&&(u=i.consumer._names.at(a.name),this._names.add(u),u=this._names.indexOf(u));var d={source:c,generatedLine:a.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:a.generatedColumn+(i.generatedOffset.generatedLine===a.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:a.originalLine,originalColumn:a.originalColumn,name:u};this.__generatedMappings.push(d),typeof d.originalLine=="number"&&this.__originalMappings.push(d)}dr(this.__generatedMappings,w.compareByGeneratedPositionsDeflated),dr(this.__originalMappings,w.compareByOriginalPositions)};rn.IndexedSourceMapConsumer=be});var Fo=C(Bo=>{var Ll=Ni().SourceMapGenerator,nn=At(),Rl=/(\r?\n)/,Dl=10,It="$$$isSourceNode$$$";function re(r,e,t,n,i){this.children=[],this.sourceContents={},this.line=r==null?null:r,this.column=e==null?null:e,this.source=t==null?null:t,this.name=i==null?null:i,this[It]=!0,n!=null&&this.add(n)}re.fromStringWithSourceMap=function(e,t,n){var i=new re,s=e.split(Rl),o=0,a=function(){var h=b(),f=b()||"";return h+f;function b(){return o<s.length?s[o++]:void 0}},c=1,u=0,d=null;return t.eachMapping(function(h){if(d!==null)if(c<h.generatedLine)l(d,a()),c++,u=0;else{var f=s[o]||"",b=f.substr(0,h.generatedColumn-u);s[o]=f.substr(h.generatedColumn-u),u=h.generatedColumn,l(d,b),d=h;return}for(;c<h.generatedLine;)i.add(a()),c++;if(u<h.generatedColumn){var f=s[o]||"";i.add(f.substr(0,h.generatedColumn)),s[o]=f.substr(h.generatedColumn),u=h.generatedColumn}d=h},this),o<s.length&&(d&&l(d,a()),i.add(s.splice(o).join(""))),t.sources.forEach(function(h){var f=t.sourceContentFor(h);f!=null&&(n!=null&&(h=nn.join(n,h)),i.setSourceContent(h,f))}),i;function l(h,f){if(h===null||h.source===void 0)i.add(f);else{var b=n?nn.join(n,h.source):h.source;i.add(new re(h.originalLine,h.originalColumn,b,f,h.name))}}};re.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(t){this.add(t)},this);else if(e[It]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};re.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[It]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};re.prototype.walk=function(e){for(var t,n=0,i=this.children.length;n<i;n++)t=this.children[n],t[It]?t.walk(e):t!==""&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})};re.prototype.join=function(e){var t,n,i=this.children.length;if(i>0){for(t=[],n=0;n<i-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this};re.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[It]?n.replaceRight(e,t):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this};re.prototype.setSourceContent=function(e,t){this.sourceContents[nn.toSetString(e)]=t};re.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][It]&&this.children[t].walkSourceContents(e);for(var i=Object.keys(this.sourceContents),t=0,n=i.length;t<n;t++)e(nn.fromSetString(i[t]),this.sourceContents[i[t]])};re.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e};re.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new Ll(e),i=!1,s=null,o=null,a=null,c=null;return this.walk(function(u,d){t.code+=u,d.source!==null&&d.line!==null&&d.column!==null?((s!==d.source||o!==d.line||a!==d.column||c!==d.name)&&n.addMapping({source:d.source,original:{line:d.line,column:d.column},generated:{line:t.line,column:t.column},name:d.name}),s=d.source,o=d.line,a=d.column,c=d.name,i=!0):i&&(n.addMapping({generated:{line:t.line,column:t.column}}),s=null,i=!1);for(var l=0,h=u.length;l<h;l++)u.charCodeAt(l)===Dl?(t.line++,t.column=0,l+1===h?(s=null,i=!1):i&&n.addMapping({source:d.source,original:{line:d.line,column:d.column},generated:{line:t.line,column:t.column},name:d.name})):t.column++}),this.walkSourceContents(function(u,d){n.setSourceContent(u,d)}),{code:t.code,map:n}};Bo.SourceNode=re});var Ko=C(sn=>{sn.SourceMapGenerator=Ni().SourceMapGenerator;sn.SourceMapConsumer=Go().SourceMapConsumer;sn.SourceNode=Fo().SourceNode});var Uo=C((on,Ho)=>{"use strict";on.__esModule=!0;var Ri=Z(),ut=void 0;try{(typeof define!="function"||!define.amd)&&($o=Ko(),ut=$o.SourceNode)}catch(r){}var $o;ut||(ut=function(r,e,t,n){this.src="",n&&this.add(n)},ut.prototype={add:function(e){Ri.isArray(e)&&(e=e.join("")),this.src+=e},prepend:function(e){Ri.isArray(e)&&(e=e.join("")),this.src=e+this.src},toStringWithSourceMap:function(){return{code:this.toString()}},toString:function(){return this.src}});function Li(r,e,t){if(Ri.isArray(r)){for(var n=[],i=0,s=r.length;i<s;i++)n.push(e.wrap(r[i],t));return n}else if(typeof r=="boolean"||typeof r=="number")return r+"";return r}function qo(r){this.srcFile=r,this.source=[]}qo.prototype={isEmpty:function(){return!this.source.length},prepend:function(e,t){this.source.unshift(this.wrap(e,t))},push:function(e,t){this.source.push(this.wrap(e,t))},merge:function(){var e=this.empty();return this.each(function(t){e.add(["  ",t,`
`])}),e},each:function(e){for(var t=0,n=this.source.length;t<n;t++)e(this.source[t])},empty:function(){var e=this.currentLocation||{start:{}};return new ut(e.start.line,e.start.column,this.srcFile)},wrap:function(e){var t=arguments.length<=1||arguments[1]===void 0?this.currentLocation||{start:{}}:arguments[1];return e instanceof ut?e:(e=Li(e,this,t),new ut(t.start.line,t.start.column,this.srcFile,e))},functionCall:function(e,t,n){return n=this.generateList(n),this.wrap([e,t?"."+t+"(":"(",n,")"])},quotedString:function(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function(e){var t=this,n=[];Object.keys(e).forEach(function(s){var o=Li(e[s],t);o!=="undefined"&&n.push([t.quotedString(s),":",o])});var i=this.generateList(n);return i.prepend("{"),i.add("}"),i},generateList:function(e){for(var t=this.empty(),n=0,i=e.length;n<i;n++)n&&t.add(","),t.add(Li(e[n],this));return t},generateArray:function(e){var t=this.generateList(e);return t.prepend("["),t.add("]"),t}};on.default=qo;Ho.exports=on.default});var Zo=C((an,Wo)=>{"use strict";an.__esModule=!0;function Vo(r){return r&&r.__esModule?r:{default:r}}var jo=qr(),Ml=ce(),Di=Vo(Ml),Gl=Z(),Bl=Uo(),zo=Vo(Bl);function Lt(r){this.value=r}function Rt(){}Rt.prototype={nameLookup:function(e,t){return this.internalNameLookup(e,t)},depthedLookup:function(e){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(e),")"]},compilerInfo:function(){var e=jo.COMPILER_REVISION,t=jo.REVISION_CHANGES[e];return[e,t]},appendToBuffer:function(e,t,n){return Gl.isArray(e)||(e=[e]),e=this.source.wrap(e,t),this.environment.isSimple?["return ",e,";"]:n?["buffer += ",e,";"]:(e.appendToBuffer=!0,e)},initializeBuffer:function(){return this.quotedString("")},internalNameLookup:function(e,t){return this.lookupPropertyFunctionIsUsed=!0,["lookupProperty(",e,",",JSON.stringify(t),")"]},lookupPropertyFunctionIsUsed:!1,compile:function(e,t,n,i){this.environment=e,this.options=t,this.stringParams=this.options.stringParams,this.trackIds=this.options.trackIds,this.precompile=!i,this.name=this.environment.name,this.isChild=!!n,this.context=n||{decorators:[],programs:[],environments:[]},this.preamble(),this.stackSlot=0,this.stackVars=[],this.aliases={},this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.blockParams=[],this.compileChildren(e,t),this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat,this.useBlockParams=this.useBlockParams||e.useBlockParams;var s=e.opcodes,o=void 0,a=void 0,c=void 0,u=void 0;for(c=0,u=s.length;c<u;c++)o=s[c],this.source.currentLocation=o.loc,a=a||o.loc,this[o.opcode].apply(this,o.args);if(this.source.currentLocation=a,this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new Di.default("Compile completed with content left on stack");this.decorators.isEmpty()?this.decorators=void 0:(this.useDecorators=!0,this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),`;
`]),this.decorators.push("return fn;"),i?this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()]):(this.decorators.prepend(`function(fn, props, container, depth0, data, blockParams, depths) {
`),this.decorators.push(`}
`),this.decorators=this.decorators.merge()));var d=this.createFunctionContext(i);if(this.isChild)return d;var l={compiler:this.compilerInfo(),main:d};this.decorators&&(l.main_d=this.decorators,l.useDecorators=!0);var h=this.context,f=h.programs,b=h.decorators;for(c=0,u=f.length;c<u;c++)f[c]&&(l[c]=f[c],b[c]&&(l[c+"_d"]=b[c],l.useDecorators=!0));return this.environment.usePartial&&(l.usePartial=!0),this.options.data&&(l.useData=!0),this.useDepths&&(l.useDepths=!0),this.useBlockParams&&(l.useBlockParams=!0),this.options.compat&&(l.compat=!0),i?l.compilerOptions=this.options:(l.compiler=JSON.stringify(l.compiler),this.source.currentLocation={start:{line:1,column:0}},l=this.objectLiteral(l),t.srcName?(l=l.toStringWithSourceMap({file:t.destName}),l.map=l.map&&l.map.toString()):l=l.toString()),l},preamble:function(){this.lastContext=0,this.source=new zo.default(this.options.srcName),this.decorators=new zo.default(this.options.srcName)},createFunctionContext:function(e){var t=this,n="",i=this.stackVars.concat(this.registers.list);i.length>0&&(n+=", "+i.join(", "));var s=0;Object.keys(this.aliases).forEach(function(c){var u=t.aliases[c];u.children&&u.referenceCount>1&&(n+=", alias"+ ++s+"="+c,u.children[0]="alias"+s)}),this.lookupPropertyFunctionIsUsed&&(n+=", "+this.lookupPropertyFunctionVarDeclaration());var o=["container","depth0","helpers","partials","data"];(this.useBlockParams||this.useDepths)&&o.push("blockParams"),this.useDepths&&o.push("depths");var a=this.mergeSource(n);return e?(o.push(a),Function.apply(this,o)):this.source.wrap(["function(",o.join(","),`) {
  `,a,"}"])},mergeSource:function(e){var t=this.environment.isSimple,n=!this.forceBuffer,i=void 0,s=void 0,o=void 0,a=void 0;return this.source.each(function(c){c.appendToBuffer?(o?c.prepend("  + "):o=c,a=c):(o&&(s?o.prepend("buffer += "):i=!0,a.add(";"),o=a=void 0),s=!0,t||(n=!1))}),n?o?(o.prepend("return "),a.add(";")):s||this.source.push('return "";'):(e+=", buffer = "+(i?"":this.initializeBuffer()),o?(o.prepend("return buffer + "),a.add(";")):this.source.push("return buffer;")),e&&this.source.prepend("var "+e.substring(2)+(i?"":`;
`)),this.source.merge()},lookupPropertyFunctionVarDeclaration:function(){return`
      lookupProperty = container.lookupProperty || function(parent, propertyName) {
        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {
          return parent[propertyName];
        }
        return undefined
    }
    `.trim()},blockValue:function(e){var t=this.aliasable("container.hooks.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs(e,0,n);var i=this.popStack();n.splice(1,0,i),this.push(this.source.functionCall(t,"call",n))},ambiguousBlockValue:function(){var e=this.aliasable("container.hooks.blockHelperMissing"),t=[this.contextName(0)];this.setupHelperArgs("",0,t,!0),this.flushInline();var n=this.topStack();t.splice(1,0,n),this.pushSource(["if (!",this.lastHelper,") { ",n," = ",this.source.functionCall(e,"call",t),"}"])},appendContent:function(e){this.pendingContent?e=this.pendingContent+e:this.pendingLocation=this.source.currentLocation,this.pendingContent=e},append:function(){if(this.isInline())this.replaceStack(function(t){return[" != null ? ",t,' : ""']}),this.pushSource(this.appendToBuffer(this.popStack()));else{var e=this.popStack();this.pushSource(["if (",e," != null) { ",this.appendToBuffer(e,void 0,!0)," }"]),this.environment.isSimple&&this.pushSource(["else { ",this.appendToBuffer("''",void 0,!0)," }"])}},appendEscaped:function(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function(e){this.lastContext=e},pushContext:function(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function(e,t,n,i){var s=0;!i&&this.options.compat&&!this.lastContext?this.push(this.depthedLookup(e[s++])):this.pushContext(),this.resolvePath("context",e,s,t,n)},lookupBlockParam:function(e,t){this.useBlockParams=!0,this.push(["blockParams[",e[0],"][",e[1],"]"]),this.resolvePath("context",t,1)},lookupData:function(e,t,n){e?this.pushStackLiteral("container.data(data, "+e+")"):this.pushStackLiteral("data"),this.resolvePath("data",t,0,!0,n)},resolvePath:function(e,t,n,i,s){var o=this;if(this.options.strict||this.options.assumeObjects){this.push(Fl(this.options.strict&&s,this,t,n,e));return}for(var a=t.length;n<a;n++)this.replaceStack(function(c){var u=o.nameLookup(c,t[n],e);return i?[" && ",u]:[" != null ? ",u," : ",c]})},resolvePossibleLambda:function(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function(e,t){this.pushContext(),this.pushString(t),t!=="SubExpression"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(e){this.trackIds&&this.push("{}"),this.stringParams&&(this.push("{}"),this.push("{}")),this.pushStackLiteral(e?"undefined":"{}")},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.trackIds&&this.push(this.objectLiteral(e.ids)),this.stringParams&&(this.push(this.objectLiteral(e.contexts)),this.push(this.objectLiteral(e.types))),this.push(this.objectLiteral(e.values))},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},registerDecorator:function(e,t){var n=this.nameLookup("decorators",t,"decorator"),i=this.setupHelperArgs(t,e);this.decorators.push(["fn = ",this.decorators.functionCall(n,"",["fn","props","container",i])," || fn;"])},invokeHelper:function(e,t,n){var i=this.popStack(),s=this.setupHelper(e,t),o=[];n&&o.push(s.name),o.push(i),this.options.strict||o.push(this.aliasable("container.hooks.helperMissing"));var a=["(",this.itemsSeparatedBy(o,"||"),")"],c=this.source.functionCall(a,"call",s.callParams);this.push(c)},itemsSeparatedBy:function(e,t){var n=[];n.push(e[0]);for(var i=1;i<e.length;i++)n.push(t,e[i]);return n},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(this.source.functionCall(n.name,"call",n.callParams))},invokeAmbiguous:function(e,t){this.useRegister("helper");var n=this.popStack();this.emptyHash();var i=this.setupHelper(0,e,t),s=this.lastHelper=this.nameLookup("helpers",e,"helper"),o=["(","(helper = ",s," || ",n,")"];this.options.strict||(o[0]="(helper = ",o.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))),this.push(["(",o,i.paramsInit?["),(",i.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",i.callParams)," : helper))"])},invokePartial:function(e,t,n){var i=[],s=this.setupParams(t,1,i);e&&(t=this.popStack(),delete s.name),n&&(s.indent=JSON.stringify(n)),s.helpers="helpers",s.partials="partials",s.decorators="container.decorators",e?i.unshift(t):i.unshift(this.nameLookup("partials",t,"partial")),this.options.compat&&(s.depths="depths"),s=this.objectLiteral(s),i.push(s),this.push(this.source.functionCall("container.invokePartial","",i))},assignToHash:function(e){var t=this.popStack(),n=void 0,i=void 0,s=void 0;this.trackIds&&(s=this.popStack()),this.stringParams&&(i=this.popStack(),n=this.popStack());var o=this.hash;n&&(o.contexts[e]=n),i&&(o.types[e]=i),s&&(o.ids[e]=s),o.values[e]=t},pushId:function(e,t,n){e==="BlockParam"?this.pushStackLiteral("blockParams["+t[0]+"].path["+t[1]+"]"+(n?" + "+JSON.stringify("."+n):"")):e==="PathExpression"?this.pushString(t):e==="SubExpression"?this.pushStackLiteral("true"):this.pushStackLiteral("null")},compiler:Rt,compileChildren:function(e,t){for(var n=e.children,i=void 0,s=void 0,o=0,a=n.length;o<a;o++){i=n[o],s=new this.compiler;var c=this.matchExistingProgram(i);if(c==null){this.context.programs.push("");var u=this.context.programs.length;i.index=u,i.name="program"+u,this.context.programs[u]=s.compile(i,t,this.context,!this.precompile),this.context.decorators[u]=s.decorators,this.context.environments[u]=i,this.useDepths=this.useDepths||s.useDepths,this.useBlockParams=this.useBlockParams||s.useBlockParams,i.useDepths=this.useDepths,i.useBlockParams=this.useBlockParams}else i.index=c.index,i.name="program"+c.index,this.useDepths=this.useDepths||c.useDepths,this.useBlockParams=this.useBlockParams||c.useBlockParams}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var i=this.context.environments[t];if(i&&i.equals(e))return i}},programExpression:function(e){var t=this.environment.children[e],n=[t.index,"data",t.blockParams];return(this.useBlockParams||this.useDepths)&&n.push("blockParams"),this.useDepths&&n.push("depths"),"container.program("+n.join(", ")+")"},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},push:function(e){return e instanceof Lt||(e=this.source.wrap(e)),this.inlineStack.push(e),e},pushStackLiteral:function(e){this.push(new Lt(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation)),this.pendingContent=void 0),e&&this.source.push(e)},replaceStack:function(e){var t=["("],n=void 0,i=void 0,s=void 0;if(!this.isInline())throw new Di.default("replaceStack on non-inline");var o=this.popStack(!0);if(o instanceof Lt)n=[o.value],t=["(",n],s=!0;else{i=!0;var a=this.incrStack();t=["((",this.push(a)," = ",o,")"],n=this.topStack()}var c=e.call(this,n);s||this.popStack(),i&&this.stackSlot--,this.push(t.concat(c,")"))},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];if(i instanceof Lt)this.compileStack.push(i);else{var s=this.incrStack();this.pushSource([s," = ",i,";"]),this.compileStack.push(s)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof Lt)return n.value;if(!t){if(!this.stackSlot)throw new Di.default("Invalid stack pop");this.stackSlot--}return n},topStack:function(){var e=this.isInline()?this.inlineStack:this.compileStack,t=e[e.length-1];return t instanceof Lt?t.value:t},contextName:function(e){return this.useDepths&&e?"depths["+e+"]":"depth"+e},quotedString:function(e){return this.source.quotedString(e)},objectLiteral:function(e){return this.source.objectLiteral(e)},aliasable:function(e){var t=this.aliases[e];return t?(t.referenceCount++,t):(t=this.aliases[e]=this.source.wrap(e),t.aliasable=!0,t.referenceCount=1,t)},setupHelper:function(e,t,n){var i=[],s=this.setupHelperArgs(t,e,i,n),o=this.nameLookup("helpers",t,"helper"),a=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:i,paramsInit:s,name:o,callParams:[a].concat(i)}},setupParams:function(e,t,n){var i={},s=[],o=[],a=[],c=!n,u=void 0;c&&(n=[]),i.name=this.quotedString(e),i.hash=this.popStack(),this.trackIds&&(i.hashIds=this.popStack()),this.stringParams&&(i.hashTypes=this.popStack(),i.hashContexts=this.popStack());var d=this.popStack(),l=this.popStack();(l||d)&&(i.fn=l||"container.noop",i.inverse=d||"container.noop");for(var h=t;h--;)u=this.popStack(),n[h]=u,this.trackIds&&(a[h]=this.popStack()),this.stringParams&&(o[h]=this.popStack(),s[h]=this.popStack());return c&&(i.args=this.source.generateArray(n)),this.trackIds&&(i.ids=this.source.generateArray(a)),this.stringParams&&(i.types=this.source.generateArray(o),i.contexts=this.source.generateArray(s)),this.options.data&&(i.data="data"),this.useBlockParams&&(i.blockParams="blockParams"),i},setupHelperArgs:function(e,t,n,i){var s=this.setupParams(e,t,n);return s.loc=JSON.stringify(this.source.currentLocation),s=this.objectLiteral(s),i?(this.useRegister("options"),n.push("options"),["options=",s]):n?(n.push(s),""):s}};(function(){for(var r="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield await null true false".split(" "),e=Rt.RESERVED_WORDS={},t=0,n=r.length;t<n;t++)e[r[t]]=!0})();Rt.isValidJavaScriptVariableName=function(r){return!Rt.RESERVED_WORDS[r]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(r)};function Fl(r,e,t,n,i){var s=e.popStack(),o=t.length;for(r&&o--;n<o;n++)s=e.nameLookup(s,t[n],i);return r?[e.aliasable("container.strict"),"(",s,", ",e.quotedString(t[n]),", ",JSON.stringify(e.source.currentLocation)," )"]:s}an.default=Rt;Wo.exports=an.default});var Yo=C((un,Jo)=>{"use strict";un.__esModule=!0;function hr(r){return r&&r.__esModule?r:{default:r}}var Kl=Ys(),$l=hr(Kl),ql=di(),Hl=hr(ql),Mi=ho(),Gi=mo(),Ul=Zo(),jl=hr(Ul),zl=fi(),Vl=hr(zl),Wl=ai(),Zl=hr(Wl),Ql=$l.default.create;function Qo(){var r=Ql();return r.compile=function(e,t){return Gi.compile(e,t,r)},r.precompile=function(e,t){return Gi.precompile(e,t,r)},r.AST=Hl.default,r.Compiler=Gi.Compiler,r.JavaScriptCompiler=jl.default,r.Parser=Mi.parser,r.parse=Mi.parse,r.parseWithoutProcessing=Mi.parseWithoutProcessing,r}var Dt=Qo();Dt.create=Qo;Zl.default(Dt);Dt.Visitor=Vl.default;Dt.default=Dt;un.default=Dt;Jo.exports=un.default});var va=C((xp,ya)=>{"use strict";ya.exports=function r(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?r(e.toJSON()):Array.isArray(e)?`[${e.reduce((i,s,o)=>`${i}${o===0?"":","}${r(s===void 0||typeof s=="symbol"?null:s)}`,"")}]`:`{${Object.keys(e).sort().reduce((n,i)=>{if(e[i]===void 0||typeof e[i]=="symbol")return n;let s=n.length===0?"":",";return`${n}${s}${r(i)}:${r(e[i])}`},"")}}`}});var wf={};iu(wf,{default:()=>qn});module.exports=su(wf);var ve=require("obsidian");var Ef=new Error("timeout while waiting for mutex to become available"),Sf=new Error("mutex already locked"),ou=new Error("request for lock canceled"),au=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{u(n.next(d))}catch(l){o(l)}}function c(d){try{u(n.throw(d))}catch(l){o(l)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},jn=class{constructor(e,t=ou){this._value=e,this._cancelError=t,this._queue=[],this._weightedWaiters=[]}acquire(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return new Promise((n,i)=>{let s={resolve:n,reject:i,weight:e,priority:t},o=os(this._queue,a=>t<=a.priority);o===-1&&e<=this._value?this._dispatchItem(s):this._queue.splice(o+1,0,s)})}runExclusive(e){return au(this,arguments,void 0,function*(t,n=1,i=0){let[s,o]=yield this.acquire(n,i);try{return yield t(s)}finally{o()}})}waitForUnlock(e=1,t=0){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);return this._couldLockImmediately(e,t)?Promise.resolve():new Promise(n=>{this._weightedWaiters[e-1]||(this._weightedWaiters[e-1]=[]),uu(this._weightedWaiters[e-1],{resolve:n,priority:t})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(e){this._value=e,this._dispatchQueue()}release(e=1){if(e<=0)throw new Error(`invalid weight ${e}: must be positive`);this._value+=e,this._dispatchQueue()}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(e){let t=this._value;this._value-=e.weight,e.resolve([t,this._newReleaser(e.weight)])}_newReleaser(e){let t=!1;return()=>{t||(t=!0,this.release(e))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let e=this._value;e>0;e--){let t=this._weightedWaiters[e-1];t&&(t.forEach(n=>n.resolve()),this._weightedWaiters[e-1]=[])}else{let e=this._queue[0].priority;for(let t=this._value;t>0;t--){let n=this._weightedWaiters[t-1];if(!n)continue;let i=n.findIndex(s=>s.priority<=e);(i===-1?n:n.splice(0,i)).forEach(s=>s.resolve())}}}_couldLockImmediately(e,t){return(this._queue.length===0||this._queue[0].priority<t)&&e<=this._value}};function uu(r,e){let t=os(r,n=>e.priority<=n.priority);r.splice(t+1,0,e)}function os(r,e){for(let t=r.length-1;t>=0;t--)if(e(r[t]))return t;return-1}var cu=function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(d){try{u(n.next(d))}catch(l){o(l)}}function c(d){try{u(n.throw(d))}catch(l){o(l)}}function u(d){d.done?s(d.value):i(d.value).then(a,c)}u((n=n.apply(r,e||[])).next())})},Pr=class{constructor(e){this._semaphore=new jn(1,e)}acquire(){return cu(this,arguments,void 0,function*(e=0){let[,t]=yield this._semaphore.acquire(1,e);return t})}runExclusive(e,t=0){return this._semaphore.runExclusive(()=>e(),1,t)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(e=0){return this._semaphore.waitForUnlock(1,e)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}};var Re=require("obsidian");var X="_rid",as="_timestamp",us="_sha256_hash",Xt="_koi_net_enabled",G="orn:koi-net.node",Ce="orn:koi-net.edge",we="orn:obsidian.note",cs="orn:telescoped",ls="orn:slack.user";var ds={config:{node_name:"",node_rid:"",node_profile:{node_type:"PARTIAL",provides:{event:[we],state:[]},public_key:""},cache_directory_path:"rid_cache",polling_interval:5,first_contact:{rid:void 0,url:void 0},priv_key:void 0},koiSyncFolderPath:"koi",templatePath:"koi-templates",interestedRidTypes:[we],vaultId:void 0,initialized:!1},Nr=class extends Re.PluginSettingTab{constructor(t,n){super(t,n);this.plugin=n}display(){let{containerEl:t}=this;t.empty(),new Re.Setting(t).setName("KOI-net node RID").setDesc("The RID of this node").addText(n=>n.setPlaceholder("orn:koi-net.node:...").setValue(this.plugin.settings.config.node_rid||"")).setDisabled(!0),new Re.Setting(t).setName("KOI-net first contact RID").setDesc("RID of the KOI-net node this node will establish first contact with").addText(n=>n.setPlaceholder("orn:koi-net.node:...").setValue(this.plugin.settings.config.first_contact.rid||"").onChange(async i=>{this.plugin.settings.config.first_contact.rid=i,await this.plugin.saveSettings()})),new Re.Setting(t).setName("KOI-net first contact URL").setDesc("URL of the KOI-net node this node will establish first contact with").addText(n=>n.setPlaceholder("https://").setValue(this.plugin.settings.config.first_contact.url||"").onChange(async i=>{this.plugin.settings.config.first_contact.url=i,await this.plugin.saveSettings()})),new Re.Setting(t).setName("Interested RID types").setDesc("The RID types this node should subscribe to events for (enter one RID type per line)").addTextArea(n=>n.setPlaceholder(`orn:obsidian.note
orn:telescoped`).setValue(this.plugin.settings.interestedRidTypes.join(`
`)).onChange(async i=>{this.plugin.settings.interestedRidTypes=i.split(`
`),await this.plugin.saveSettings()})),new Re.Setting(t).setName("Sync directory path").setDesc("Directory used to store RID objects synced through KOI").addText(n=>n.setPlaceholder("koi").setValue(this.plugin.settings.koiSyncFolderPath).onChange(async i=>{this.plugin.settings.koiSyncFolderPath=i,await this.plugin.saveSettings()})),new Re.Setting(t).setName("Template file location").setDesc("Will be used to generate documents imported from KOI").addText(n=>n.setPlaceholder("").setValue(this.plugin.settings.templatePath).onChange(async i=>{this.plugin.settings.templatePath=i,await this.plugin.saveSettings()}))}};var Ue=require("obsidian"),tt=ss(Yo()),ma=require("obsidian");var Xo=new Set(["orn","urn"]);function Mt(r,e=!1){let t,n,i;if(typeof r!="string")throw new TypeError(`RID type string '${r}' must be of type 'string'`);let s=r.indexOf(":");if(s<0){if(!e)throw new TypeError(`RID string '${r}' should contain a ':'-separated context and reference component`);if(t=r,n=void 0,Xo.has(t))throw new TypeError(`RID type string '${r}' is a namespace scheme but is missing a namespace component`)}else if(t=r.slice(0,s),Xo.has(t)){let a=r.indexOf(":",s+1);if(a<0)if(e)n=r.slice(s+1);else throw new TypeError(`RID string '${r}' is missing a reference component`);else{if(e)throw new TypeError(`RID type string '${r}' should contain a maximum of two ':'-separated components`);n=r.slice(s+1,a),i=r.slice(a+1)}}else{if(e)throw new TypeError(`RID type string '${r}' contains a ':'-separated namespace component, but scheme doesn't support namespaces`);i=r.slice(s+1)}if(t==="")throw new TypeError(`RID type string '${r}' cannot have an empty scheme`);if(n==="")throw new TypeError(`RID type string '${r}' cannot have an empty namespace`);if(i==="")throw new TypeError(`RID string '${r}' cannot have an empty reference`);let o=t+":"+(n||"");return{scheme:t,namespace:n,ridType:o,reference:i}}var O;(function(r){r.assertEqual=i=>i;function e(i){}r.assertIs=e;function t(i){throw new Error}r.assertNever=t,r.arrayToEnum=i=>{let s={};for(let o of i)s[o]=o;return s},r.getValidEnumValues=i=>{let s=r.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(let a of s)o[a]=i[a];return r.objectValues(o)},r.objectValues=i=>r.objectKeys(i).map(function(s){return i[s]}),r.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{let s=[];for(let o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},r.find=(i,s)=>{for(let o of i)if(s(o))return o},r.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function n(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}r.joinValues=n,r.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(O||(O={}));var Fi;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(Fi||(Fi={}));var _=O.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ke=r=>{switch(typeof r){case"undefined":return _.undefined;case"string":return _.string;case"number":return isNaN(r)?_.nan:_.number;case"boolean":return _.boolean;case"function":return _.function;case"bigint":return _.bigint;case"symbol":return _.symbol;case"object":return Array.isArray(r)?_.array:r===null?_.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?_.promise:typeof Map!="undefined"&&r instanceof Map?_.map:typeof Set!="undefined"&&r instanceof Set?_.set:typeof Date!="undefined"&&r instanceof Date?_.date:_.object;default:return _.unknown}},g=O.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Jl=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),Q=class extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(s){return s.message},n={_errors:[]},i=s=>{for(let o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,c=0;for(;c<o.path.length;){let u=o.path[c];c===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(t(o))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return i(this),n}static assert(e){if(!(e instanceof Q))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,O.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};Q.create=r=>new Q(r);var Ft=(r,e)=>{let t;switch(r.code){case g.invalid_type:r.received===_.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case g.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,O.jsonStringifyReplacer)}`;break;case g.unrecognized_keys:t=`Unrecognized key(s) in object: ${O.joinValues(r.keys,", ")}`;break;case g.invalid_union:t="Invalid input";break;case g.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${O.joinValues(r.options)}`;break;case g.invalid_enum_value:t=`Invalid enum value. Expected ${O.joinValues(r.options)}, received '${r.received}'`;break;case g.invalid_arguments:t="Invalid function arguments";break;case g.invalid_return_type:t="Invalid function return type";break;case g.invalid_date:t="Invalid date";break;case g.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:O.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case g.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case g.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case g.custom:t="Invalid input";break;case g.invalid_intersection_types:t="Intersection results could not be merged";break;case g.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case g.not_finite:t="Number must be finite";break;default:t=e.defaultError,O.assertNever(r)}return{message:t}},na=Ft;function Yl(r){na=r}function cn(){return na}var ln=r=>{let{data:e,path:t,errorMaps:n,issueData:i}=r,s=[...t,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="",c=n.filter(u=>!!u).slice().reverse();for(let u of c)a=u(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}},Xl=[];function y(r,e){let t=cn(),n=ln({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Ft?void 0:Ft].filter(i=>!!i)});r.common.issues.push(n)}var H=class{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let i of t){if(i.status==="aborted")return x;i.status==="dirty"&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let i of t){let s=await i.key,o=await i.value;n.push({key:s,value:o})}return H.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let i of t){let{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return x;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value!="undefined"||i.alwaysSet)&&(n[s.value]=o.value)}return{status:e.value,value:n}}},x=Object.freeze({status:"aborted"}),Bt=r=>({status:"dirty",value:r}),J=r=>({status:"valid",value:r}),Ki=r=>r.status==="aborted",$i=r=>r.status==="dirty",ct=r=>r.status==="valid",gr=r=>typeof Promise!="undefined"&&r instanceof Promise;function dn(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function ia(r,e,t,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!i:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(r,t):i?i.value=t:e.set(r,t),t}var k;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(k||(k={}));var fr,pr,fe=class{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ea=(r,e)=>{if(ct(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new Q(r.common.issues);return this._error=t,this._error}}};function P(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:i}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{var c,u;let{message:d}=r;return o.code==="invalid_enum_value"?{message:d!=null?d:a.defaultError}:typeof a.data=="undefined"?{message:(c=d!=null?d:n)!==null&&c!==void 0?c:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(u=d!=null?d:t)!==null&&u!==void 0?u:a.defaultError}},description:i}}var N=class{get description(){return this._def.description}_getType(e){return Ke(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ke(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new H,ctx:{common:e.parent.common,data:e.data,parsedType:Ke(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(gr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let i={common:{issues:[],async:(n=t==null?void 0:t.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ke(e)},s=this._parseSync({data:e,path:i.path,parent:i});return ea(i,s)}"~validate"(e){var t,n;let i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ke(e)};if(!this["~standard"].async)try{let s=this._parseSync({data:e,path:[],parent:i});return ct(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((n=(t=s==null?void 0:s.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>ct(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ke(e)},i=this._parse({data:e,path:n.path,parent:n}),s=await(gr(i)?i:Promise.resolve(i));return ea(n,s)}refine(e,t){let n=i=>typeof t=="string"||typeof t=="undefined"?{message:t}:typeof t=="function"?t(i):t;return this._refinement((i,s)=>{let o=e(i),a=()=>s.addIssue({code:g.custom,...n(i)});return typeof Promise!="undefined"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,i)=>e(n)?!0:(i.addIssue(typeof t=="function"?t(n,i):t),!1))}_refinement(e){return new se({schema:this,typeName:S.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return he.create(this,this._def)}nullable(){return Ie.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ie.create(this)}promise(){return et.create(this,this._def)}or(e){return ft.create([this,e],this._def)}and(e){return pt.create(this,e,this._def)}transform(e){return new se({...P(this._def),schema:this,typeName:S.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new _t({...P(this._def),innerType:this,defaultValue:t,typeName:S.ZodDefault})}brand(){return new mr({typeName:S.ZodBranded,type:this,...P(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new wt({...P(this._def),innerType:this,catchValue:t,typeName:S.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return bt.create(this,e)}readonly(){return kt.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},ed=/^c[^\s-]{8,}$/i,td=/^[0-9a-z]+$/,rd=/^[0-9A-HJKMNP-TV-Z]{26}$/i,nd=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,id=/^[a-z0-9_-]{21}$/i,sd=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,od=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ad=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ud="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Bi,cd=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ld=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,dd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,hd=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,fd=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,pd=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,sa="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",gd=new RegExp(`^${sa}$`);function oa(r){let e="[0-5]\\d";r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`);let t=r.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function md(r){return new RegExp(`^${oa(r)}$`)}function aa(r){let e=`${sa}T${oa(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function yd(r,e){return!!((e==="v4"||!e)&&cd.test(r)||(e==="v6"||!e)&&dd.test(r))}function vd(r,e){if(!sd.test(r))return!1;try{let[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),i=JSON.parse(atob(n));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch(t){return!1}}function _d(r,e){return!!((e==="v4"||!e)&&ld.test(r)||(e==="v6"||!e)&&hd.test(r))}var ne=class extends N{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==_.string){let s=this._getOrReturnCtx(e);return y(s,{code:g.invalid_type,expected:_.string,received:s.parsedType}),x}let n=new H,i;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),y(i,{code:g.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),y(i,{code:g.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),n.dirty());else if(s.kind==="length"){let o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?y(i,{code:g.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&y(i,{code:g.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),n.dirty())}else if(s.kind==="email")ad.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"email",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="emoji")Bi||(Bi=new RegExp(ud,"u")),Bi.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"emoji",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="uuid")nd.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"uuid",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="nanoid")id.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"nanoid",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid")ed.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"cuid",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="cuid2")td.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"cuid2",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="ulid")rd.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"ulid",code:g.invalid_string,message:s.message}),n.dirty());else if(s.kind==="url")try{new URL(e.data)}catch(o){i=this._getOrReturnCtx(e,i),y(i,{validation:"url",code:g.invalid_string,message:s.message}),n.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"regex",code:g.invalid_string,message:s.message}),n.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),n.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:{startsWith:s.value},message:s.message}),n.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:{endsWith:s.value},message:s.message}),n.dirty()):s.kind==="datetime"?aa(s).test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:"datetime",message:s.message}),n.dirty()):s.kind==="date"?gd.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:"date",message:s.message}),n.dirty()):s.kind==="time"?md(s).test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{code:g.invalid_string,validation:"time",message:s.message}),n.dirty()):s.kind==="duration"?od.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"duration",code:g.invalid_string,message:s.message}),n.dirty()):s.kind==="ip"?yd(e.data,s.version)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"ip",code:g.invalid_string,message:s.message}),n.dirty()):s.kind==="jwt"?vd(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"jwt",code:g.invalid_string,message:s.message}),n.dirty()):s.kind==="cidr"?_d(e.data,s.version)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"cidr",code:g.invalid_string,message:s.message}),n.dirty()):s.kind==="base64"?fd.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"base64",code:g.invalid_string,message:s.message}),n.dirty()):s.kind==="base64url"?pd.test(e.data)||(i=this._getOrReturnCtx(e,i),y(i,{validation:"base64url",code:g.invalid_string,message:s.message}),n.dirty()):O.assertNever(s);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(i=>e.test(i),{validation:t,code:g.invalid_string,...k.errToObj(n)})}_addCheck(e){return new ne({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...k.errToObj(e)})}url(e){return this._addCheck({kind:"url",...k.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...k.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...k.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...k.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...k.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...k.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...k.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...k.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...k.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...k.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...k.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...k.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)=="undefined"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(n=e==null?void 0:e.local)!==null&&n!==void 0?n:!1,...k.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)=="undefined"?null:e==null?void 0:e.precision,...k.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...k.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...k.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...k.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...k.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...k.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...k.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...k.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...k.errToObj(t)})}nonempty(e){return this.min(1,k.errToObj(e))}trim(){return new ne({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ne({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ne({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};ne.create=r=>{var e;return new ne({checks:[],typeName:S.ZodString,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...P(r)})};function wd(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,i=t>n?t:n,s=parseInt(r.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return s%o/Math.pow(10,i)}var Te=class extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==_.number){let s=this._getOrReturnCtx(e);return y(s,{code:g.invalid_type,expected:_.number,received:s.parsedType}),x}let n,i=new H;for(let s of this._def.checks)s.kind==="int"?O.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?wd(e.data,s.value)!==0&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),y(n,{code:g.not_finite,message:s.message}),i.dirty()):O.assertNever(s);return{status:i.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,i){return new Te({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(i)}]})}_addCheck(e){return new Te({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:k.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:k.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:k.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:k.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&O.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};Te.create=r=>new Te({checks:[],typeName:S.ZodNumber,coerce:(r==null?void 0:r.coerce)||!1,...P(r)});var Ae=class extends N{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(s){return this._getInvalidInput(e)}if(this._getType(e)!==_.bigint)return this._getInvalidInput(e);let n,i=new H;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),y(n,{code:g.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):O.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return y(t,{code:g.invalid_type,expected:_.bigint,received:t.parsedType}),x}gte(e,t){return this.setLimit("min",e,!0,k.toString(t))}gt(e,t){return this.setLimit("min",e,!1,k.toString(t))}lte(e,t){return this.setLimit("max",e,!0,k.toString(t))}lt(e,t){return this.setLimit("max",e,!1,k.toString(t))}setLimit(e,t,n,i){return new Ae({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:k.toString(i)}]})}_addCheck(e){return new Ae({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:k.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:k.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:k.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:k.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:k.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Ae.create=r=>{var e;return new Ae({checks:[],typeName:S.ZodBigInt,coerce:(e=r==null?void 0:r.coerce)!==null&&e!==void 0?e:!1,...P(r)})};var lt=class extends N{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==_.boolean){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.boolean,received:n.parsedType}),x}return J(e.data)}};lt.create=r=>new lt({typeName:S.ZodBoolean,coerce:(r==null?void 0:r.coerce)||!1,...P(r)});var qe=class extends N{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==_.date){let s=this._getOrReturnCtx(e);return y(s,{code:g.invalid_type,expected:_.date,received:s.parsedType}),x}if(isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return y(s,{code:g.invalid_date}),x}let n=new H,i;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),y(i,{code:g.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),n.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),y(i,{code:g.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),n.dirty()):O.assertNever(s);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new qe({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:k.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:k.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};qe.create=r=>new qe({checks:[],coerce:(r==null?void 0:r.coerce)||!1,typeName:S.ZodDate,...P(r)});var Kt=class extends N{_parse(e){if(this._getType(e)!==_.symbol){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.symbol,received:n.parsedType}),x}return J(e.data)}};Kt.create=r=>new Kt({typeName:S.ZodSymbol,...P(r)});var dt=class extends N{_parse(e){if(this._getType(e)!==_.undefined){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.undefined,received:n.parsedType}),x}return J(e.data)}};dt.create=r=>new dt({typeName:S.ZodUndefined,...P(r)});var ht=class extends N{_parse(e){if(this._getType(e)!==_.null){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.null,received:n.parsedType}),x}return J(e.data)}};ht.create=r=>new ht({typeName:S.ZodNull,...P(r)});var Xe=class extends N{constructor(){super(...arguments),this._any=!0}_parse(e){return J(e.data)}};Xe.create=r=>new Xe({typeName:S.ZodAny,...P(r)});var $e=class extends N{constructor(){super(...arguments),this._unknown=!0}_parse(e){return J(e.data)}};$e.create=r=>new $e({typeName:S.ZodUnknown,...P(r)});var ke=class extends N{_parse(e){let t=this._getOrReturnCtx(e);return y(t,{code:g.invalid_type,expected:_.never,received:t.parsedType}),x}};ke.create=r=>new ke({typeName:S.ZodNever,...P(r)});var $t=class extends N{_parse(e){if(this._getType(e)!==_.undefined){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.void,received:n.parsedType}),x}return J(e.data)}};$t.create=r=>new $t({typeName:S.ZodVoid,...P(r)});var ie=class extends N{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==_.array)return y(t,{code:g.invalid_type,expected:_.array,received:t.parsedType}),x;if(i.exactLength!==null){let o=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(o||a)&&(y(t,{code:o?g.too_big:g.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(i.minLength!==null&&t.data.length<i.minLength.value&&(y(t,{code:g.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),i.maxLength!==null&&t.data.length>i.maxLength.value&&(y(t,{code:g.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>i.type._parseAsync(new fe(t,o,t.path,a)))).then(o=>H.mergeArray(n,o));let s=[...t.data].map((o,a)=>i.type._parseSync(new fe(t,o,t.path,a)));return H.mergeArray(n,s)}get element(){return this._def.type}min(e,t){return new ie({...this._def,minLength:{value:e,message:k.toString(t)}})}max(e,t){return new ie({...this._def,maxLength:{value:e,message:k.toString(t)}})}length(e,t){return new ie({...this._def,exactLength:{value:e,message:k.toString(t)}})}nonempty(e){return this.min(1,e)}};ie.create=(r,e)=>new ie({type:r,minLength:null,maxLength:null,exactLength:null,typeName:S.ZodArray,...P(e)});function Gt(r){if(r instanceof M){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=he.create(Gt(n))}return new M({...r._def,shape:()=>e})}else return r instanceof ie?new ie({...r._def,type:Gt(r.element)}):r instanceof he?he.create(Gt(r.unwrap())):r instanceof Ie?Ie.create(Gt(r.unwrap())):r instanceof pe?pe.create(r.items.map(e=>Gt(e))):r}var M=class extends N{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=O.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==_.object){let u=this._getOrReturnCtx(e);return y(u,{code:g.invalid_type,expected:_.object,received:u.parsedType}),x}let{status:n,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof ke&&this._def.unknownKeys==="strip"))for(let u in i.data)o.includes(u)||a.push(u);let c=[];for(let u of o){let d=s[u],l=i.data[u];c.push({key:{status:"valid",value:u},value:d._parse(new fe(i,l,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof ke){let u=this._def.unknownKeys;if(u==="passthrough")for(let d of a)c.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(u==="strict")a.length>0&&(y(i,{code:g.unrecognized_keys,keys:a}),n.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let d of a){let l=i.data[d];c.push({key:{status:"valid",value:d},value:u._parse(new fe(i,l,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{let u=[];for(let d of c){let l=await d.key,h=await d.value;u.push({key:l,value:h,alwaysSet:d.alwaysSet})}return u}).then(u=>H.mergeObjectSync(n,u)):H.mergeObjectSync(n,c)}get shape(){return this._def.shape()}strict(e){return k.errToObj,new M({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var i,s,o,a;let c=(o=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=k.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new M({...this._def,unknownKeys:"strip"})}passthrough(){return new M({...this._def,unknownKeys:"passthrough"})}extend(e){return new M({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new M({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:S.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new M({...this._def,catchall:e})}pick(e){let t={};return O.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new M({...this._def,shape:()=>t})}omit(e){let t={};return O.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new M({...this._def,shape:()=>t})}deepPartial(){return Gt(this)}partial(e){let t={};return O.objectKeys(this.shape).forEach(n=>{let i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()}),new M({...this._def,shape:()=>t})}required(e){let t={};return O.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let s=this.shape[n];for(;s instanceof he;)s=s._def.innerType;t[n]=s}}),new M({...this._def,shape:()=>t})}keyof(){return ua(O.objectKeys(this.shape))}};M.create=(r,e)=>new M({shape:()=>r,unknownKeys:"strip",catchall:ke.create(),typeName:S.ZodObject,...P(e)});M.strictCreate=(r,e)=>new M({shape:()=>r,unknownKeys:"strict",catchall:ke.create(),typeName:S.ZodObject,...P(e)});M.lazycreate=(r,e)=>new M({shape:r,unknownKeys:"strip",catchall:ke.create(),typeName:S.ZodObject,...P(e)});var ft=class extends N{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function i(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=s.map(a=>new Q(a.ctx.common.issues));return y(t,{code:g.invalid_union,unionErrors:o}),x}if(t.common.async)return Promise.all(n.map(async s=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(i);{let s,o=[];for(let c of n){let u={...t,common:{...t.common,issues:[]},parent:null},d=c._parseSync({data:t.data,path:t.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;let a=o.map(c=>new Q(c));return y(t,{code:g.invalid_union,unionErrors:a}),x}}get options(){return this._def.options}};ft.create=(r,e)=>new ft({options:r,typeName:S.ZodUnion,...P(e)});var Fe=r=>r instanceof mt?Fe(r.schema):r instanceof se?Fe(r.innerType()):r instanceof yt?[r.value]:r instanceof Oe?r.options:r instanceof vt?O.objectValues(r.enum):r instanceof _t?Fe(r._def.innerType):r instanceof dt?[void 0]:r instanceof ht?[null]:r instanceof he?[void 0,...Fe(r.unwrap())]:r instanceof Ie?[null,...Fe(r.unwrap())]:r instanceof mr||r instanceof kt?Fe(r.unwrap()):r instanceof wt?Fe(r._def.innerType):[],qt=class extends N{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==_.object)return y(t,{code:g.invalid_type,expected:_.object,received:t.parsedType}),x;let n=this.discriminator,i=t.data[n],s=this.optionsMap.get(i);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(y(t,{code:g.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),x)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let i=new Map;for(let s of t){let o=Fe(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new qt({typeName:S.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...P(n)})}};function qi(r,e){let t=Ke(r),n=Ke(e);if(r===e)return{valid:!0,data:r};if(t===_.object&&n===_.object){let i=O.objectKeys(e),s=O.objectKeys(r).filter(a=>i.indexOf(a)!==-1),o={...r,...e};for(let a of s){let c=qi(r[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(t===_.array&&n===_.array){if(r.length!==e.length)return{valid:!1};let i=[];for(let s=0;s<r.length;s++){let o=r[s],a=e[s],c=qi(o,a);if(!c.valid)return{valid:!1};i.push(c.data)}return{valid:!0,data:i}}else return t===_.date&&n===_.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var pt=class extends N{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),i=(s,o)=>{if(Ki(s)||Ki(o))return x;let a=qi(s.value,o.value);return a.valid?(($i(s)||$i(o))&&t.dirty(),{status:t.value,value:a.data}):(y(n,{code:g.invalid_intersection_types}),x)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};pt.create=(r,e,t)=>new pt({left:r,right:e,typeName:S.ZodIntersection,...P(t)});var pe=class extends N{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.array)return y(n,{code:g.invalid_type,expected:_.array,received:n.parsedType}),x;if(n.data.length<this._def.items.length)return y(n,{code:g.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),x;!this._def.rest&&n.data.length>this._def.items.length&&(y(n,{code:g.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...n.data].map((o,a)=>{let c=this._def.items[a]||this._def.rest;return c?c._parse(new fe(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(s).then(o=>H.mergeArray(t,o)):H.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new pe({...this._def,rest:e})}};pe.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pe({items:r,typeName:S.ZodTuple,rest:null,...P(e)})};var gt=class extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.object)return y(n,{code:g.invalid_type,expected:_.object,received:n.parsedType}),x;let i=[],s=this._def.keyType,o=this._def.valueType;for(let a in n.data)i.push({key:s._parse(new fe(n,a,n.path,a)),value:o._parse(new fe(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?H.mergeObjectAsync(t,i):H.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof N?new gt({keyType:e,valueType:t,typeName:S.ZodRecord,...P(n)}):new gt({keyType:ne.create(),valueType:e,typeName:S.ZodRecord,...P(t)})}},Ht=class extends N{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.map)return y(n,{code:g.invalid_type,expected:_.map,received:n.parsedType}),x;let i=this._def.keyType,s=this._def.valueType,o=[...n.data.entries()].map(([a,c],u)=>({key:i._parse(new fe(n,a,n.path,[u,"key"])),value:s._parse(new fe(n,c,n.path,[u,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let c of o){let u=await c.key,d=await c.value;if(u.status==="aborted"||d.status==="aborted")return x;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(u.value,d.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let c of o){let u=c.key,d=c.value;if(u.status==="aborted"||d.status==="aborted")return x;(u.status==="dirty"||d.status==="dirty")&&t.dirty(),a.set(u.value,d.value)}return{status:t.value,value:a}}}};Ht.create=(r,e,t)=>new Ht({valueType:e,keyType:r,typeName:S.ZodMap,...P(t)});var He=class extends N{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==_.set)return y(n,{code:g.invalid_type,expected:_.set,received:n.parsedType}),x;let i=this._def;i.minSize!==null&&n.data.size<i.minSize.value&&(y(n,{code:g.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),i.maxSize!==null&&n.data.size>i.maxSize.value&&(y(n,{code:g.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());let s=this._def.valueType;function o(c){let u=new Set;for(let d of c){if(d.status==="aborted")return x;d.status==="dirty"&&t.dirty(),u.add(d.value)}return{status:t.value,value:u}}let a=[...n.data.values()].map((c,u)=>s._parse(new fe(n,c,n.path,u)));return n.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,t){return new He({...this._def,minSize:{value:e,message:k.toString(t)}})}max(e,t){return new He({...this._def,maxSize:{value:e,message:k.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};He.create=(r,e)=>new He({valueType:r,minSize:null,maxSize:null,typeName:S.ZodSet,...P(e)});var Ye=class extends N{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==_.function)return y(t,{code:g.invalid_type,expected:_.function,received:t.parsedType}),x;function n(a,c){return ln({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,cn(),Ft].filter(u=>!!u),issueData:{code:g.invalid_arguments,argumentsError:c}})}function i(a,c){return ln({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,cn(),Ft].filter(u=>!!u),issueData:{code:g.invalid_return_type,returnTypeError:c}})}let s={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof et){let a=this;return J(async function(...c){let u=new Q([]),d=await a._def.args.parseAsync(c,s).catch(f=>{throw u.addIssue(n(c,f)),u}),l=await Reflect.apply(o,this,d);return await a._def.returns._def.type.parseAsync(l,s).catch(f=>{throw u.addIssue(i(l,f)),u})})}else{let a=this;return J(function(...c){let u=a._def.args.safeParse(c,s);if(!u.success)throw new Q([n(c,u.error)]);let d=Reflect.apply(o,this,u.data),l=a._def.returns.safeParse(d,s);if(!l.success)throw new Q([i(d,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ye({...this._def,args:pe.create(e).rest($e.create())})}returns(e){return new Ye({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Ye({args:e||pe.create([]).rest($e.create()),returns:t||$e.create(),typeName:S.ZodFunction,...P(n)})}},mt=class extends N{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};mt.create=(r,e)=>new mt({getter:r,typeName:S.ZodLazy,...P(e)});var yt=class extends N{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return y(t,{received:t.data,code:g.invalid_literal,expected:this._def.value}),x}return{status:"valid",value:e.data}}get value(){return this._def.value}};yt.create=(r,e)=>new yt({value:r,typeName:S.ZodLiteral,...P(e)});function ua(r,e){return new Oe({values:r,typeName:S.ZodEnum,...P(e)})}var Oe=class extends N{constructor(){super(...arguments),fr.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return y(t,{expected:O.joinValues(n),received:t.parsedType,code:g.invalid_type}),x}if(dn(this,fr,"f")||ia(this,fr,new Set(this._def.values),"f"),!dn(this,fr,"f").has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return y(t,{received:t.data,code:g.invalid_enum_value,options:n}),x}return J(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Oe.create(e,{...this._def,...t})}exclude(e,t=this._def){return Oe.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};fr=new WeakMap;Oe.create=ua;var vt=class extends N{constructor(){super(...arguments),pr.set(this,void 0)}_parse(e){let t=O.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==_.string&&n.parsedType!==_.number){let i=O.objectValues(t);return y(n,{expected:O.joinValues(i),received:n.parsedType,code:g.invalid_type}),x}if(dn(this,pr,"f")||ia(this,pr,new Set(O.getValidEnumValues(this._def.values)),"f"),!dn(this,pr,"f").has(e.data)){let i=O.objectValues(t);return y(n,{received:n.data,code:g.invalid_enum_value,options:i}),x}return J(e.data)}get enum(){return this._def.values}};pr=new WeakMap;vt.create=(r,e)=>new vt({values:r,typeName:S.ZodNativeEnum,...P(e)});var et=class extends N{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==_.promise&&t.common.async===!1)return y(t,{code:g.invalid_type,expected:_.promise,received:t.parsedType}),x;let n=t.parsedType===_.promise?t.data:Promise.resolve(t.data);return J(n.then(i=>this._def.type.parseAsync(i,{path:t.path,errorMap:t.common.contextualErrorMap})))}};et.create=(r,e)=>new et({type:r,typeName:S.ZodPromise,...P(e)});var se=class extends N{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===S.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{y(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){let o=i.transform(n.data,s);if(n.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return x;let c=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return c.status==="aborted"?x:c.status==="dirty"||t.value==="dirty"?Bt(c.value):c});{if(t.value==="aborted")return x;let a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?x:a.status==="dirty"||t.value==="dirty"?Bt(a.value):a}}if(i.type==="refinement"){let o=a=>{let c=i.refinement(a,s);if(n.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?x:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?x:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(i.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ct(o))return o;let a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>ct(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:t.value,value:a})):o);O.assertNever(i)}};se.create=(r,e,t)=>new se({schema:r,typeName:S.ZodEffects,effect:e,...P(t)});se.createWithPreprocess=(r,e,t)=>new se({schema:e,effect:{type:"preprocess",transform:r},typeName:S.ZodEffects,...P(t)});var he=class extends N{_parse(e){return this._getType(e)===_.undefined?J(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};he.create=(r,e)=>new he({innerType:r,typeName:S.ZodOptional,...P(e)});var Ie=class extends N{_parse(e){return this._getType(e)===_.null?J(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ie.create=(r,e)=>new Ie({innerType:r,typeName:S.ZodNullable,...P(e)});var _t=class extends N{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===_.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};_t.create=(r,e)=>new _t({innerType:r,typeName:S.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...P(e)});var wt=class extends N{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return gr(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Q(n.common.issues)},input:n.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Q(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};wt.create=(r,e)=>new wt({innerType:r,typeName:S.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...P(e)});var Ut=class extends N{_parse(e){if(this._getType(e)!==_.nan){let n=this._getOrReturnCtx(e);return y(n,{code:g.invalid_type,expected:_.nan,received:n.parsedType}),x}return{status:"valid",value:e.data}}};Ut.create=r=>new Ut({typeName:S.ZodNaN,...P(r)});var bd=Symbol("zod_brand"),mr=class extends N{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},bt=class extends N{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?x:s.status==="dirty"?(t.dirty(),Bt(s.value)):this._def.out._parseAsync({data:s.value,path:n.path,parent:n})})();{let i=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?x:i.status==="dirty"?(t.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:n.path,parent:n})}}static create(e,t){return new bt({in:e,out:t,typeName:S.ZodPipeline})}},kt=class extends N{_parse(e){let t=this._def.innerType._parse(e),n=i=>(ct(i)&&(i.value=Object.freeze(i.value)),i);return gr(t)?t.then(i=>n(i)):n(t)}unwrap(){return this._def.innerType}};kt.create=(r,e)=>new kt({innerType:r,typeName:S.ZodReadonly,...P(e)});function ta(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function ca(r,e={},t){return r?Xe.create().superRefine((n,i)=>{var s,o;let a=r(n);if(a instanceof Promise)return a.then(c=>{var u,d;if(!c){let l=ta(e,n),h=(d=(u=l.fatal)!==null&&u!==void 0?u:t)!==null&&d!==void 0?d:!0;i.addIssue({code:"custom",...l,fatal:h})}});if(!a){let c=ta(e,n),u=(o=(s=c.fatal)!==null&&s!==void 0?s:t)!==null&&o!==void 0?o:!0;i.addIssue({code:"custom",...c,fatal:u})}}):Xe.create()}var kd={object:M.lazycreate},S;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(S||(S={}));var Ed=(r,e={message:`Input not instance of ${r.name}`})=>ca(t=>t instanceof r,e),la=ne.create,da=Te.create,Sd=Ut.create,xd=Ae.create,ha=lt.create,Cd=qe.create,Pd=Kt.create,Nd=dt.create,Td=ht.create,Ad=Xe.create,Od=$e.create,Id=ke.create,Ld=$t.create,Rd=ie.create,Dd=M.create,Md=M.strictCreate,Gd=ft.create,Bd=qt.create,Fd=pt.create,Kd=pe.create,$d=gt.create,qd=Ht.create,Hd=He.create,Ud=Ye.create,jd=mt.create,zd=yt.create,Vd=Oe.create,Wd=vt.create,Zd=et.create,ra=se.create,Qd=he.create,Jd=Ie.create,Yd=se.createWithPreprocess,Xd=bt.create,eh=()=>la().optional(),th=()=>da().optional(),rh=()=>ha().optional(),nh={string:r=>ne.create({...r,coerce:!0}),number:r=>Te.create({...r,coerce:!0}),boolean:r=>lt.create({...r,coerce:!0}),bigint:r=>Ae.create({...r,coerce:!0}),date:r=>qe.create({...r,coerce:!0})},ih=x,p=Object.freeze({__proto__:null,defaultErrorMap:Ft,setErrorMap:Yl,getErrorMap:cn,makeIssue:ln,EMPTY_PATH:Xl,addIssueToContext:y,ParseStatus:H,INVALID:x,DIRTY:Bt,OK:J,isAborted:Ki,isDirty:$i,isValid:ct,isAsync:gr,get util(){return O},get objectUtil(){return Fi},ZodParsedType:_,getParsedType:Ke,ZodType:N,datetimeRegex:aa,ZodString:ne,ZodNumber:Te,ZodBigInt:Ae,ZodBoolean:lt,ZodDate:qe,ZodSymbol:Kt,ZodUndefined:dt,ZodNull:ht,ZodAny:Xe,ZodUnknown:$e,ZodNever:ke,ZodVoid:$t,ZodArray:ie,ZodObject:M,ZodUnion:ft,ZodDiscriminatedUnion:qt,ZodIntersection:pt,ZodTuple:pe,ZodRecord:gt,ZodMap:Ht,ZodSet:He,ZodFunction:Ye,ZodLazy:mt,ZodLiteral:yt,ZodEnum:Oe,ZodNativeEnum:vt,ZodPromise:et,ZodEffects:se,ZodTransformer:se,ZodOptional:he,ZodNullable:Ie,ZodDefault:_t,ZodCatch:wt,ZodNaN:Ut,BRAND:bd,ZodBranded:mr,ZodPipeline:bt,ZodReadonly:kt,custom:ca,Schema:N,ZodSchema:N,late:kd,get ZodFirstPartyTypeKind(){return S},coerce:nh,any:Ad,array:Rd,bigint:xd,boolean:ha,date:Cd,discriminatedUnion:Bd,effect:ra,enum:Vd,function:Ud,instanceof:Ed,intersection:Fd,lazy:jd,literal:zd,map:qd,nan:Sd,nativeEnum:Wd,never:Id,null:Td,nullable:Jd,number:da,object:Dd,oboolean:rh,onumber:th,optional:Qd,ostring:eh,pipeline:Xd,preprocess:Yd,promise:Zd,record:$d,set:Hd,strictObject:Md,string:la,symbol:Pd,transformer:ra,tuple:Kd,undefined:Nd,union:Gd,unknown:Od,void:Ld,NEVER:ih,ZodIssueCode:g,quotelessJson:Jl,ZodError:Q});var hn=p.object({text:p.string(),frontmatter:p.any(),basename:p.string(),path:p.string()});var fa=p.object({message_rid:p.string(),team_id:p.string(),team_name:p.string(),channel_id:p.string(),channel_name:p.string(),timestamp:p.string(),text:p.string(),thread_timestamp:p.string().nullable(),message_in_thread:p.boolean(),created_at:p.string(),edited_at:p.string().nullable(),author_user_id:p.string().nullable(),author_name:p.string().nullable(),tagger_user_id:p.string(),tagger_name:p.string().nullable(),author_is_anonymous:p.boolean(),emojis:p.array(p.string()),comments:p.array(p.string()),retract_time_started_at:p.string(),permalink:p.string()});function pa(r){let e=new Date(parseFloat(r)*1e3),t=l=>l.toString().padStart(2,"0"),n=l=>l.toString().padStart(3,"0"),i=e.getFullYear(),s=t(e.getMonth()+1),o=t(e.getDate()),a=t(e.getHours()),c=t(e.getMinutes()),u=t(e.getSeconds()),d=n(e.getMilliseconds());return`${i}-${s}-${o}_${a}-${c}-${u}.${d}`}var sh=`\`\`\`
---
base_url: {{base_url}}
node_type: {{node_type}}
provides_event: {{provides.event}}
provides_state: {{provides.state}}
public_key: {{public_key}}
---
\`\`\``,oh=`\`\`\`
---
{{{yaml this}}}
---
source_link: "[[{{{linkTo source false}}}]]"
target_link: "[[{{{linkTo target false}}}]]"
\`\`\`
`,ah="```\n---\n{{{yaml frontmatter}}}\npath: {{path}}\n---\n```\n{{{text}}}",uh=`\`\`\`
---
{{{yaml this}}}
---
\`\`\`
{{{text}}}
## Notes:
researcher_comments: {{comments}}`,ga={"koi-net.node":sh,"koi-net.edge":oh,"obsidian.note":ah,telescoped:uh};var fn=class{constructor(e,t,n){this.plugin=e,this.app=e.app,this.settings=e.settings,this.cache=t,this.effector=n,this.handleBarTemplates={},tt.registerHelper("json",i=>JSON.stringify(i)),tt.registerHelper("yaml",i=>(0,Ue.stringifyYaml)(i)),tt.registerHelper("stringPrefix",(i,s)=>s.length>i?s.substring(0,i-3)+"...":s),tt.registerHelper("parseUsers",function(i,s){return console.log(this),s.replace(/<@([A-Z0-9]+)>/g,(o,a)=>i.replace(/\$userId/g,a).replace(/\$userName/g,this.userNameLookup[a]||a))}),tt.registerHelper("linkTo",(i,s=!0)=>{let o=this.getFileByRid(i);return o?s?`${o.path}|${i}`:o.path:(console.log(`couldn't find ${i}`),i)})}async compileTemplates(){let e;if(e=this.app.vault.getFolderByPath(this.settings.templatePath),!e){console.log("template folder doesn't exist"),e=await this.app.vault.createFolder(this.settings.templatePath);for(let[n,i]of Object.entries(ga))await this.app.vault.create(`${this.settings.templatePath}/${n}.md`,i)}let t=[];Ue.Vault.recurseChildren(e,n=>{n instanceof Ue.TFile&&t.push(n)});for(let n of t){let s=`orn:${n.basename}`;console.log(`found template for ${s}`);let a=(await this.app.vault.read(n)).replace(/^```\n?([\s\S]*?)```\n?/,"$1");this.handleBarTemplates[s]=tt.compile(a)}}async getFolderByPath(e){return this.app.vault.getFolderByPath(e)||await this.app.vault.createFolder(e)}getFileByRid(e){var n;let t=this.app.vault.getFolderByPath(this.settings.koiSyncFolderPath);if(t){for(let i of t.children)if(i instanceof Ue.TFolder)for(let s of i.children){if(!(s instanceof Ue.TFile))continue;let o=(n=this.app.metadataCache.getFileCache(s))==null?void 0:n.frontmatter;if(e===(o==null?void 0:o[X]))return s}}}safeFileName(e){return e.replace(/[^a-zA-Z0-9-_.+ ]/g,"_")}async writeMultiple(e){let t=new ma.Notice("",0),n=0;for(let i of e)await this.write(i),n++,t&&t.setMessage(`Formatting bundles... (${n}/${e.length})`);t&&t.setMessage(`Done formatting! (${n}/${e.length})`),setTimeout(()=>{t.hide()},3e3)}async write(e){var h;let t=await this.cache.read(e);if(!t)return;let n=Object.assign({},t.contents),{ridType:i,reference:s}=Mt(e),o=this.safeFileName(s);if(i===cs){let f=fa.parse(t.contents),b=f.text,T=/<@([A-Z0-9]+)>/g,I={},A=[...b.matchAll(T)].map(B=>B[1]);for(let B of A){let Yt=`${ls}:${f.team_id}/${B}`,_e=await this.effector.deref({rid:Yt});I[B]=_e==null?void 0:_e.contents.real_name}n.userNameLookup=I,console.log(f);let F=f.author_is_anonymous?"anonymous":f.author_name,ae=pa(f.timestamp);o=`@${F} (${f.channel_name}) ${ae}`,console.log(o)}else if(i===we){let f=t.validateContents(hn),b=s==null?void 0:s.split("/"),T=b&&b[1];o=`${f.basename} (${T})`}let a;i in this.handleBarTemplates?a=this.handleBarTemplates[i](n):a=JSON.stringify(n);let c=await this.getFolderByPath(`${this.settings.koiSyncFolderPath}/${this.safeFileName(i)}`),u=`${o}.md`,d=this.getFileByRid(e)||await this.app.vault.create(`${c.path}/${u}`,"");if(d.basename!==o){let f=((h=d.parent)==null?void 0:h.path)||"",b=f?`${f}/${u}`:u;await this.app.fileManager.renameFile(d,b)}await this.app.vault.process(d,()=>a);let l=this.app.metadataCache.getFileCache(d);this.setFrontmatter(d,{[X]:t.manifest.rid,[as]:t.manifest.timestamp,[us]:t.manifest.sha256_hash})}setFrontmatter(e,t){this.app.fileManager.processFrontMatter(e,async n=>{let i={...n};for(let s in n)delete n[s];for(let s in t)n[s]=t[s];for(let s in i)n[s]=i[s]})}async delete(e){let t=await this.getFileByRid(e);t&&await this.app.vault.delete(t)}};var pn=class{constructor(e){this.config=e}get rid(){return this.config.node_rid}get profile(){return this.config.node_profile}};var je=p.enum(["FULL","PARTIAL"]),ee=p.object({base_url:p.string().nullable().optional(),node_type:je,provides:p.object({event:p.array(p.string()).default([]),state:p.array(p.string()).default([])}),public_key:p.string()});var gn=class{constructor({cache:e,identity:t,config:n,graph:i,requestHandler:s,effector:o}){this.identity=t,this.cache=e,this.config=n,this.graph=i,this.requestHandler=s,this.effector=o}async pollNeighbors(){let e=new Set;for(let n of this.cache.listRids([G])){let i=await this.cache.read(n);!i||i.validateContents(ee).node_type!=="FULL"||e.add(n)}this.config.first_contact.rid&&e.add(this.config.first_contact.rid);let t={};for(let n of e){console.log(`polling ${n}`);let i=await this.requestHandler.pollEvents({node:n,req:{limit:0}});i&&i.type==="events_payload"&&i.events&&(t[n]=i.events)}return t}};var mn=class{constructor(e,t,n){this.rid=e;this.timestamp=t;this.sha256_hash=n}static validate(e){let t=mn.schema.parse(e);return new mn(t.rid,t.timestamp,t.sha256_hash)}},oe=mn;oe.schema=p.object({rid:p.string(),timestamp:p.string().datetime(),sha256_hash:p.string()});var _a=ss(va()),wa=require("crypto");function ze(r){let e=(0,wa.createHash)("sha256");return e.update(r),e.digest("hex")}function ba(r){let e=(0,_a.default)(r);if(!e)throw"failed to serialize JSON";return ze(e)}function ch(r){let t=r.toISOString().split("."),n=t[0],s=t[1].slice(0,3)+"000";return`${n}.${s}Z`}var yr=class{constructor({manifest:e,contents:t}){this.manifest=e,this.contents=t}static validate(e){let t=yr.schema.parse(e);return new yr({...t})}get rid(){return this.manifest.rid}static generate({rid:e,contents:t}){return new yr({manifest:new oe(e,ch(new Date),ba(t)),contents:t})}validateContents(e){return e.parse(this.contents)}},$=yr;$.schema=p.object({manifest:oe.schema.transform(e=>oe.validate(e)),contents:p.record(p.unknown())});var R=p.enum(["NEW","UPDATE","FORGET"]),Et=class{constructor(e,t,n,i){this.rid=e;this.event_type=t;this.manifest=n;this.contents=i}static validate(e){let t=Et.schema.parse(e);return new Et(t.rid,t.event_type,t.manifest,t.contents)}static fromBundle(e,t){return new Et(t.manifest.rid,e,t.manifest,t.contents)}static fromManifest(e,t){return new Et(t.rid,e,t)}static fromRID(e,t){return new Et(t,e)}get bundle(){if(this.manifest&&this.contents)return new $({manifest:this.manifest,contents:this.contents})}},W=Et;W.schema=p.object({rid:p.string(),event_type:R,manifest:oe.schema.transform(e=>oe.validate(e)).optional(),contents:p.record(p.unknown()).optional()});var j=Symbol("STOP_CHAIN"),ge=class{constructor(e,t,n,i,s,o,a=[]){this.rid=e;this.manifest=t;this.contents=n;this.eventType=i;this.source=s;this.normalizedEventType=o;this.networkTargets=a}static fromRid(e,t,n){return new ge(e,void 0,void 0,t,n)}static fromManifest(e,t,n){return new ge(e.rid,e,void 0,t,n)}static fromBundle(e,t,n){return new ge(e.rid,e.manifest,e.contents,t,n)}static fromEvent(e,t){return new ge(e.rid,e.manifest,e.contents,e.event_type,t)}get bundle(){if(!(!this.manifest||!this.contents))return new $({manifest:this.manifest,contents:this.contents})}get normalizedEvent(){if(this.normalizedEventType)return this.normalizedEventType===R.enum.FORGET?new W(this.rid,R.enum.FORGET):new W(this.rid,this.normalizedEventType,this.manifest,this.contents)}stringify(){return`<KObj '${this.rid}' event type: '${this.eventType}' -> '${this.normalizedEventType}', source: '${this.source}'>`}};var yn=class{constructor({pipeline:e}){this.pipeline=e,this.kobjQueue=[]}async flushKobjQueue(){for(;this.kobjQueue.length>0;){let e=this.kobjQueue.shift();e&&(console.log(`Dequeued ${e.stringify()}`),await this.pipeline.process(e))}}handle({rid:e,manifest:t,bundle:n,event:i,kobj:s,eventType:o,source:a}){let c;if(e)c=ge.fromRid(e,o,a);else if(t)c=ge.fromManifest(t,o,a);else if(n)c=ge.fromBundle(n,o,a);else if(i)c=ge.fromEvent(i,a);else if(s)c=s;else throw"One of 'rid', 'manifest', 'bundle', 'event', or 'kobj' must be provided";console.log(`Queued ${c.stringify()}`),this.kobjQueue.push(c)}};var Y=class{constructor({func:e,name:t,handlerType:n,ridTypes:i,source:s,eventTypes:o}){this.func=e,this.name=t,this.handlerType=n,this.ridTypes=i,this.source=s,this.eventTypes=o}};var vr=p.enum(["PROPOSED","APPROVED"]),Hi=p.enum(["WEBHOOK","POLL"]),St=p.object({source:p.string(),target:p.string(),edge_type:Hi,status:vr,rid_types:p.array(p.string())});function vn({source:r,target:e,ridTypes:t,edgeType:n}){let i=`${Ce}:${ze(r+e)}`,s={source:r,target:e,rid_types:t,edge_type:n,status:"PROPOSED"};return $.generate({rid:i,contents:s})}var Ea=new Y({name:"basic_rid_handler",handlerType:"rid",func:(r,e)=>{if(e.rid===r.identity.rid&&e.source)return j;if(e.eventType===R.enum.FORGET)return e.normalizedEventType=R.enum.FORGET,e}}),Sa=new Y({name:"basic_manifest_handler",handlerType:"manifest",func:async(r,e)=>{let t=await r.cache.read(e.rid);if(t){if(e.manifest.sha256_hash===t.manifest.sha256_hash)return console.log("Hash of incoming manifest is same as existing knowledge, ignoring"),j;let n=new Date(t.manifest.timestamp);if(new Date(e.manifest.timestamp)<=n)return console.log("Timestamp of incoming manifest is the same or older than existing knowledge, ignoring"),j;console.log("RID previously known to me, labeling as 'UPDATE'"),e.normalizedEventType=R.enum.UPDATE}else console.log("RID previously unknown to me, labeling as 'NEW'"),e.normalizedEventType=R.enum.NEW;return e}}),xa=new Y({name:"secure_profile_handler",handlerType:"bundle",ridTypes:[G],eventTypes:[R.enum.NEW,R.enum.UPDATE],func:(r,e)=>{let t=e.bundle.validateContents(ee);if(!e.rid.endsWith(ze(t.public_key)))return console.warn("public key mismatch for",e.rid),j}}),Ca=new Y({name:"edge_negotiation_handler",handlerType:"bundle",ridTypes:[Ce],eventTypes:[R.enum.NEW,R.enum.UPDATE],func:async(r,e)=>{if(!e.source)return;let t=e.bundle.validateContents(St);if(t.source===r.identity.rid){if(t.status!==vr.enum.PROPOSED)return;let n=t.target,i=await r.effector.deref({rid:n});if(!i)return console.warn("unknown peer",n),j;let s=i.validateContents(ee),o=[G,Ce,...r.identity.profile.provides.event],a=!1;if(t.edge_type===Hi.enum.WEBHOOK&&s.node_type===je.enum.PARTIAL&&(a=!0),t.rid_types&&!t.rid_types.every(c=>o.includes(c))&&(console.warn("Requested RID types not provided by this node"),a=!0),a){let c=W.fromRID("FORGET",e.rid);return r.eventQueue.pushEventTo({event:c,node:e.rid,flush:!0}),j}else{t.status=vr.enum.APPROVED;let c=$.generate({rid:e.rid,contents:t});r.processor.handle({bundle:c,eventType:"UPDATE"});return}}else t.target===r.identity.rid&&t.status===vr.enum.APPROVED&&console.log("edge approved by other node")}}),Pa=new Y({name:"coordinator_contact",handlerType:"network",ridTypes:[G],func:async(r,e)=>{var i;if(!((i=e.bundle.validateContents(ee).provides.event)!=null&&i.contains(G))||e.rid===r.identity.rid||r.graph.getEdge({source:e.rid,target:r.identity.rid}))return;console.log("identified new coordinator, proposing edge"),r.processor.handle({bundle:vn({source:e.rid,target:r.identity.rid,edgeType:"POLL",ridTypes:[G]})});let n=await r.requestHandler.fetchRids({node:e.rid,req:{rid_types:[G]}});for(let s of n.rids)r.processor.handle({rid:s,source:e.rid})}}),Na=new Y({name:"basic_network_output_filter",handlerType:"network",func:async(r,e)=>{let t=!1;if(!e.source){if(e.rid.startsWith(G))e.rid===r.identity.rid&&(t=!0);else if(e.rid.startsWith(Ce)){let i=e.bundle.validateContents(St);i.source===r.identity.rid?(e.networkTargets.push(i.target),t=!0):i.target===r.identity.rid&&(e.networkTargets.push(i.source),t=!0)}}let{ridType:n}=Mt(e.rid);if(r.identity.profile.provides.event.contains(n)||t){let i=await r.graph.getNeighbors({direction:"out",allowedType:n});console.log(`sending event to subscribers: ${i}`),e.networkTargets.push(...i)}return e}}),Ta=new Y({name:"forget_edge_on_node_deletion",handlerType:"final",ridTypes:[G],func:async(r,e)=>{if(e.normalizedEventType===R.enum.FORGET)for(let t of r.graph.getEdges()){let n=await r.cache.read(t),i=n==null?void 0:n.validateContents(St);i&&(i.source===e.rid||i.target===e.rid)&&r.processor.handle({rid:t,eventType:R.enum.FORGET})}}});var Ui=p.object({type:p.literal("poll_events").default("poll_events"),limit:p.number().default(0).nullable()}),ji=p.object({type:p.literal("fetch_rids").default("fetch_rids"),rid_types:p.array(p.string()).default([])}),zi=p.object({type:p.literal("fetch_manifests").default("fetch_manifests"),rid_types:p.array(p.string()).default([]),rids:p.array(p.string()).default([])}),Vi=p.object({type:p.literal("fetch_bundles").default("fetch_bundles"),rids:p.array(p.string()).default([])}),lh=p.object({type:p.literal("rids_payload").default("rids_payload"),rids:p.array(p.string())}),dh=p.object({type:p.literal("manifests_payload").default("manifests_payload"),manifests:p.array(oe.schema).transform(r=>r.map(oe.validate)),not_found:p.array(p.string()).default([])}),hh=p.object({type:p.literal("bundles_payload").default("bundles_payload"),bundles:p.array($.schema).transform(r=>r.map($.validate)),not_found:p.array(p.string()).default([]),deferred:p.array(p.string()).default([])}),Wi=p.object({type:p.literal("events_payload").default("events_payload"),events:p.array(W.schema).transform(r=>r.map(W.validate))}),fh=p.enum(["unknown_node","invalid_key","invalid_signature","invalid_target"]),Zi=p.object({type:p.literal("error_response").default("error_response"),error:fh}),Qi=p.discriminatedUnion("type",[Ui,ji,zi,Vi,lh,dh,hh,Wi,Zi]);var Ji="/events/broadcast",Aa="/events/poll",Oa="/rids/fetch",Ia="/manifests/fetch",La="/bundles/fetch";var Ra=require("obsidian");var _n=class{constructor({payload:e,source_node:t,target_node:n,signature:i}){this.payload=e,this.source_node=t,this.target_node=n,this.signature=i}static validate(e){let t=_n.schema.parse(e);return new _n({payload:t.payload,source_node:t.source_node,target_node:t.target_node,signature:t.signature})}async verifyWith(e){let t=new zt({payload:this.payload,source_node:this.source_node,target_node:this.target_node}),n=new Uint8Array(t.toJsonBuffer());return await e.verify(this.signature,n)}},jt=_n;jt.schema=p.object({payload:Qi,source_node:p.string(),target_node:p.string(),signature:p.string()});var _r=class{constructor({payload:e,source_node:t,target_node:n}){this.payload=e,this.source_node=t,this.target_node=n}static validate(e){let t=_r.schema.parse(e);return new _r({payload:t.payload,source_node:t.source_node,target_node:t.target_node})}async signWith(e){let t=_r.schema.parse({...this}),n=JSON.stringify(t),i=new Uint8Array(Buffer.from(n)),s=await e.sign(i);return new jt({payload:this.payload,source_node:this.source_node,target_node:this.target_node,signature:s})}toJsonBuffer(){return Buffer.from(JSON.stringify({payload:this.payload,source_node:this.source_node,target_node:this.target_node}))}},zt=_r;zt.schema=p.object({payload:Qi,source_node:p.string(),target_node:p.string()});var wn=class{constructor({cache:e,graph:t,identity:n,effector:i,secure:s,config:o}){this.config=o,this.secure=s,this.identity=n,this.effector=i,this.cache=e,this.graph=t}async getUrl(e){if(e===this.identity.rid)throw"don't talk to yourself";let t=await this.effector.deref({rid:e}),n;if(t){let i=t.validateContents(ee);if(i.node_type!==je.enum.FULL)throw"can't query partial node";n=i.base_url}else e===this.config.first_contact.rid&&(n=this.config.first_contact.url);if(!n)throw"node not found";return n}async makeRequest({node:e,req:t,path:n}){let i=await this.getUrl(e)+n,s=await this.secure.createEnvelope({payload:t,target:e});console.log(i,t);let o;try{o=await(0,Ra.requestUrl)({url:i,method:"POST",body:JSON.stringify(s),throw:!1})}catch(c){console.log(c);return}if(o.status!==200)return console.error(o.text),Zi.parse(o.json);if(n===Ji)return;let a=jt.validate(o.json);return this.secure.validateEnvelope(a),a.payload}async broadcastEvents({node:e,req:t}){await this.makeRequest({node:e,path:Ji,req:Wi.parse(t)})}async pollEvents({node:e,req:t}){return await this.makeRequest({node:e,path:Aa,req:Ui.parse(t)})}async fetchRids({node:e,req:t}){return await this.makeRequest({node:e,path:Oa,req:ji.parse(t)})}async fetchManifests({node:e,req:t}){return await this.makeRequest({node:e,path:Ia,req:zi.parse(t)})}async fetchBundles({node:e,req:t}){return await this.makeRequest({node:e,path:La,req:Vi.parse(t)})}};var bn=class{constructor({cache:e}){this.cache=e,this.actionTable={}}setProcessor(e){this.processor=e}setResolver(e){this.resolver=e}setActionContext(e){this.actionContext=e}registerAction({ridType:e,action:t}){this.actionTable[e]=t}async tryCache(e){let t=await this.cache.read(e);if(t)return[t,"cache"]}async tryAction(e){let t;for(let i of Object.keys(this.actionTable))if(e.startsWith(i)){t=this.actionTable[i];break}if(!t)return;let n=t(this.actionContext,e);if(n)return[n,"action"]}async tryNetwork(e){}async deref({rid:e,refreshCache:t=!1,useNetwork:n=!1,handleResult:i=!0}){let[s,o]=!t&&await this.tryCache(e)||await this.tryAction(e)||n&&await this.tryNetwork(e)||[void 0,void 0];return i&&s&&o!=="cache"&&this.processor.handle({bundle:s,source:o.startsWith(G)?o:void 0}),s}};var Ba=require("events");function ph(){let r=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(let n in arguments[e])r[n]=arguments[e][n];return r}var q=ph;typeof Object.assign=="function"&&(q=Object.assign);function ye(r,e,t,n){let i=r._nodes.get(e),s=null;return i&&(n==="mixed"?s=i.out&&i.out[t]||i.undirected&&i.undirected[t]:n==="directed"?s=i.out&&i.out[t]:s=i.undirected&&i.undirected[t]),s}function z(r){return typeof r=="object"&&r!==null}function Fa(r){let e;for(e in r)return!1;return!0}function me(r,e,t){Object.defineProperty(r,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function Ee(r,e,t){let n={enumerable:!0,configurable:!0};typeof t=="function"?n.get=t:(n.value=t,n.writable=!1),Object.defineProperty(r,e,n)}function Da(r){return!(!z(r)||r.attributes&&!Array.isArray(r.attributes))}function gh(){let r=Math.floor(Math.random()*256)&255;return()=>r++}function Ve(){let r=arguments,e=null,t=-1;return{[Symbol.iterator](){return this},next(){let n=null;do{if(e===null){if(t++,t>=r.length)return{done:!0};e=r[t][Symbol.iterator]()}if(n=e.next(),n.done){e=null;continue}break}while(!0);return n}}}function Zt(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}var kr=class extends Error{constructor(e){super(),this.name="GraphError",this.message=e}},v=class extends kr{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,v.prototype.constructor)}},m=class extends kr{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,m.prototype.constructor)}},E=class extends kr{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,E.prototype.constructor)}};function Ka(r,e){this.key=r,this.attributes=e,this.clear()}Ka.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function $a(r,e){this.key=r,this.attributes=e,this.clear()}$a.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function qa(r,e){this.key=r,this.attributes=e,this.clear()}qa.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Qt(r,e,t,n,i){this.key=e,this.attributes=i,this.undirected=r,this.source=t,this.target=n}Qt.prototype.attach=function(){let r="out",e="in";this.undirected&&(r=e="undirected");let t=this.source.key,n=this.target.key;this.source[r][n]=this,!(this.undirected&&t===n)&&(this.target[e][t]=this)};Qt.prototype.attachMulti=function(){let r="out",e="in",t=this.source.key,n=this.target.key;this.undirected&&(r=e="undirected");let i=this.source[r],s=i[n];if(typeof s=="undefined"){i[n]=this,this.undirected&&t===n||(this.target[e][t]=this);return}s.previous=this,this.next=s,i[n]=this,this.target[e][t]=this};Qt.prototype.detach=function(){let r=this.source.key,e=this.target.key,t="out",n="in";this.undirected&&(t=n="undirected"),delete this.source[t][e],delete this.target[n][r]};Qt.prototype.detachMulti=function(){let r=this.source.key,e=this.target.key,t="out",n="in";this.undirected&&(t=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[n][r]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[n][r]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};var Ha=0,Ua=1,mh=2,ja=3;function We(r,e,t,n,i,s,o){let a,c,u,d;if(n=""+n,t===Ha){if(a=r._nodes.get(n),!a)throw new m(`Graph.${e}: could not find the "${n}" node in the graph.`);u=i,d=s}else if(t===ja){if(i=""+i,c=r._edges.get(i),!c)throw new m(`Graph.${e}: could not find the "${i}" edge in the graph.`);let l=c.source.key,h=c.target.key;if(n===l)a=c.target;else if(n===h)a=c.source;else throw new m(`Graph.${e}: the "${n}" node is not attached to the "${i}" edge (${l}, ${h}).`);u=s,d=o}else{if(c=r._edges.get(n),!c)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`);t===Ua?a=c.source:a=c.target,u=i,d=s}return[a,u,d]}function yh(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);return o.attributes[a]}}function vh(r,e,t){r.prototype[e]=function(n,i){let[s]=We(this,e,t,n,i);return s.attributes}}function _h(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);return o.attributes.hasOwnProperty(a)}}function wh(r,e,t){r.prototype[e]=function(n,i,s,o){let[a,c,u]=We(this,e,t,n,i,s,o);return a.attributes[c]=u,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:c}),this}}function bh(r,e,t){r.prototype[e]=function(n,i,s,o){let[a,c,u]=We(this,e,t,n,i,s,o);if(typeof u!="function")throw new v(`Graph.${e}: updater should be a function.`);let d=a.attributes,l=u(d[c]);return d[c]=l,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:c}),this}}function kh(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function Eh(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);if(!z(a))throw new v(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Sh(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);if(!z(a))throw new v(`Graph.${e}: provided attributes are not a plain object.`);return q(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function xh(r,e,t){r.prototype[e]=function(n,i,s){let[o,a]=We(this,e,t,n,i,s);if(typeof a!="function")throw new v(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}var Ch=[{name:r=>`get${r}Attribute`,attacher:yh},{name:r=>`get${r}Attributes`,attacher:vh},{name:r=>`has${r}Attribute`,attacher:_h},{name:r=>`set${r}Attribute`,attacher:wh},{name:r=>`update${r}Attribute`,attacher:bh},{name:r=>`remove${r}Attribute`,attacher:kh},{name:r=>`replace${r}Attributes`,attacher:Eh},{name:r=>`merge${r}Attributes`,attacher:Sh},{name:r=>`update${r}Attributes`,attacher:xh}];function Ph(r){Ch.forEach(function({name:e,attacher:t}){t(r,e("Node"),Ha),t(r,e("Source"),Ua),t(r,e("Target"),mh),t(r,e("Opposite"),ja)})}function Nh(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return s.attributes[i]}}function Th(r,e,t){r.prototype[e]=function(n){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let s=""+n,o=""+arguments[1];if(i=ye(this,s,o,t),!i)throw new m(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,i=this._edges.get(n),!i)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return i.attributes}}function Ah(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return s.attributes.hasOwnProperty(i)}}function Oh(r,e,t){r.prototype[e]=function(n,i,s){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let a=""+n,c=""+i;if(i=arguments[2],s=arguments[3],o=ye(this,a,c,t),!o)throw new m(`Graph.${e}: could not find an edge for the given path ("${a}" - "${c}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return o.attributes[i]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function Ih(r,e,t){r.prototype[e]=function(n,i,s){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let a=""+n,c=""+i;if(i=arguments[2],s=arguments[3],o=ye(this,a,c,t),!o)throw new m(`Graph.${e}: could not find an edge for the given path ("${a}" - "${c}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof s!="function")throw new v(`Graph.${e}: updater should be a function.`);return o.attributes[i]=s(o.attributes[i]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function Lh(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return delete s.attributes[i],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:i}),this}}function Rh(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!z(i))throw new v(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=i,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function Dh(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!z(i))throw new v(`Graph.${e}: provided attributes are not a plain object.`);return q(s.attributes,i),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:i}),this}}function Mh(r,e,t){r.prototype[e]=function(n,i){let s;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new E(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new E(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);let o=""+n,a=""+i;if(i=arguments[2],s=ye(this,o,a,t),!s)throw new m(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new E(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,s=this._edges.get(n),!s)throw new m(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof i!="function")throw new v(`Graph.${e}: provided updater is not a function.`);return s.attributes=i(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}var Gh=[{name:r=>`get${r}Attribute`,attacher:Nh},{name:r=>`get${r}Attributes`,attacher:Th},{name:r=>`has${r}Attribute`,attacher:Ah},{name:r=>`set${r}Attribute`,attacher:Oh},{name:r=>`update${r}Attribute`,attacher:Ih},{name:r=>`remove${r}Attribute`,attacher:Lh},{name:r=>`replace${r}Attributes`,attacher:Rh},{name:r=>`merge${r}Attributes`,attacher:Dh},{name:r=>`update${r}Attributes`,attacher:Mh}];function Bh(r){Gh.forEach(function({name:e,attacher:t}){t(r,e("Edge"),"mixed"),t(r,e("DirectedEdge"),"directed"),t(r,e("UndirectedEdge"),"undirected")})}var Fh=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Kh(r,e,t,n){let i=!1;for(let s in e){if(s===n)continue;let o=e[s];if(i=t(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),r&&i)return o.key}}function $h(r,e,t,n){let i,s,o,a=!1;for(let c in e)if(c!==n){i=e[c];do{if(s=i.source,o=i.target,a=t(i.key,i.attributes,s.key,o.key,s.attributes,o.attributes,i.undirected),r&&a)return i.key;i=i.next}while(i!==void 0)}}function Yi(r,e){let t=Object.keys(r),n=t.length,i,s=0;return{[Symbol.iterator](){return this},next(){do if(i)i=i.next;else{if(s>=n)return{done:!0};let o=t[s++];if(o===e){i=void 0;continue}i=r[o]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}}}}function qh(r,e,t,n){let i=e[t];if(!i)return;let s=i.source,o=i.target;if(n(i.key,i.attributes,s.key,o.key,s.attributes,o.attributes,i.undirected)&&r)return i.key}function Hh(r,e,t,n){let i=e[t];if(!i)return;let s=!1;do{if(s=n(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),r&&s)return i.key;i=i.next}while(i!==void 0)}function Xi(r,e){let t=r[e];if(t.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!t)return{done:!0};let i={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:i}}};let n=!1;return{[Symbol.iterator](){return this},next(){return n===!0?{done:!0}:(n=!0,{done:!1,value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected}})}}}function Uh(r,e){if(r.size===0)return[];if(e==="mixed"||e===r.type)return Array.from(r._edges.keys());let t=e==="undirected"?r.undirectedSize:r.directedSize,n=new Array(t),i=e==="undirected",s=r._edges.values(),o=0,a,c;for(;a=s.next(),a.done!==!0;)c=a.value,c.undirected===i&&(n[o++]=c.key);return n}function za(r,e,t,n){if(e.size===0)return;let i=t!=="mixed"&&t!==e.type,s=t==="undirected",o,a,c=!1,u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(a=o.value,i&&a.undirected!==s)continue;let{key:d,attributes:l,source:h,target:f}=a;if(c=n(d,l,h.key,f.key,h.attributes,f.attributes,a.undirected),r&&c)return d}}function jh(r,e){if(r.size===0)return Zt();let t=e!=="mixed"&&e!==r.type,n=e==="undirected",i=r._edges.values();return{[Symbol.iterator](){return this},next(){let s,o;for(;;){if(s=i.next(),s.done)return s;if(o=s.value,!(t&&o.undirected!==n))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.undirected},done:!1}}}}function es(r,e,t,n,i,s){let o=e?$h:Kh,a;if(t!=="undirected"&&(n!=="out"&&(a=o(r,i.in,s),r&&a)||n!=="in"&&(a=o(r,i.out,s,n?void 0:i.key),r&&a))||t!=="directed"&&(a=o(r,i.undirected,s),r&&a))return a}function zh(r,e,t,n){let i=[];return es(!1,r,e,t,n,function(s){i.push(s)}),i}function Vh(r,e,t){let n=Zt();return r!=="undirected"&&(e!=="out"&&typeof t.in!="undefined"&&(n=Ve(n,Yi(t.in))),e!=="in"&&typeof t.out!="undefined"&&(n=Ve(n,Yi(t.out,e?void 0:t.key)))),r!=="directed"&&typeof t.undirected!="undefined"&&(n=Ve(n,Yi(t.undirected))),n}function ts(r,e,t,n,i,s,o){let a=t?Hh:qh,c;if(e!=="undirected"&&(typeof i.in!="undefined"&&n!=="out"&&(c=a(r,i.in,s,o),r&&c)||typeof i.out!="undefined"&&n!=="in"&&(n||i.key!==s)&&(c=a(r,i.out,s,o),r&&c))||e!=="directed"&&typeof i.undirected!="undefined"&&(c=a(r,i.undirected,s,o),r&&c))return c}function Wh(r,e,t,n,i){let s=[];return ts(!1,r,e,t,n,i,function(o){s.push(o)}),s}function Zh(r,e,t,n){let i=Zt();return r!=="undirected"&&(typeof t.in!="undefined"&&e!=="out"&&n in t.in&&(i=Ve(i,Xi(t.in,n))),typeof t.out!="undefined"&&e!=="in"&&n in t.out&&(e||t.key!==n)&&(i=Ve(i,Xi(t.out,n)))),r!=="directed"&&typeof t.undirected!="undefined"&&n in t.undirected&&(i=Ve(i,Xi(t.undirected,n))),i}function Qh(r,e){let{name:t,type:n,direction:i}=e;r.prototype[t]=function(s,o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return Uh(this,n);if(arguments.length===1){s=""+s;let a=this._nodes.get(s);if(typeof a=="undefined")throw new m(`Graph.${t}: could not find the "${s}" node in the graph.`);return zh(this.multi,n==="mixed"?this.type:n,i,a)}if(arguments.length===2){s=""+s,o=""+o;let a=this._nodes.get(s);if(!a)throw new m(`Graph.${t}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new m(`Graph.${t}:  could not find the "${o}" target node in the graph.`);return Wh(n,this.multi,i,a,o)}throw new v(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Jh(r,e){let{name:t,type:n,direction:i}=e,s="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(u,d,l){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return l=u,za(!1,this,n,l);if(arguments.length===2){u=""+u,l=d;let h=this._nodes.get(u);if(typeof h=="undefined")throw new m(`Graph.${s}: could not find the "${u}" node in the graph.`);return es(!1,this.multi,n==="mixed"?this.type:n,i,h,l)}if(arguments.length===3){u=""+u,d=""+d;let h=this._nodes.get(u);if(!h)throw new m(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(d))throw new m(`Graph.${s}:  could not find the "${d}" target node in the graph.`);return ts(!1,n,this.multi,i,h,d,l)}throw new v(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};let o="map"+t[0].toUpperCase()+t.slice(1);r.prototype[o]=function(){let u=Array.prototype.slice.call(arguments),d=u.pop(),l;if(u.length===0){let h=0;n!=="directed"&&(h+=this.undirectedSize),n!=="undirected"&&(h+=this.directedSize),l=new Array(h);let f=0;u.push((b,T,I,A,F,ae,B)=>{l[f++]=d(b,T,I,A,F,ae,B)})}else l=[],u.push((h,f,b,T,I,A,F)=>{l.push(d(h,f,b,T,I,A,F))});return this[s].apply(this,u),l};let a="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[a]=function(){let u=Array.prototype.slice.call(arguments),d=u.pop(),l=[];return u.push((h,f,b,T,I,A,F)=>{d(h,f,b,T,I,A,F)&&l.push(h)}),this[s].apply(this,u),l};let c="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[c]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new v(`Graph.${c}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new v(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let d,l;u.length===2?(d=u[0],l=u[1],u=[]):u.length===3?(d=u[1],l=u[2],u=[u[0]]):u.length===4&&(d=u[2],l=u[3],u=[u[0],u[1]]);let h=l;return u.push((f,b,T,I,A,F,ae)=>{h=d(h,f,b,T,I,A,F,ae)}),this[s].apply(this,u),h}}function Yh(r,e){let{name:t,type:n,direction:i}=e,s="find"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(c,u,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return d=c,za(!0,this,n,d);if(arguments.length===2){c=""+c,d=u;let l=this._nodes.get(c);if(typeof l=="undefined")throw new m(`Graph.${s}: could not find the "${c}" node in the graph.`);return es(!0,this.multi,n==="mixed"?this.type:n,i,l,d)}if(arguments.length===3){c=""+c,u=""+u;let l=this._nodes.get(c);if(!l)throw new m(`Graph.${s}:  could not find the "${c}" source node in the graph.`);if(!this._nodes.has(u))throw new m(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return ts(!0,n,this.multi,i,l,u,d)}throw new v(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};let o="some"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[o]=function(){let c=Array.prototype.slice.call(arguments),u=c.pop();return c.push((l,h,f,b,T,I,A)=>u(l,h,f,b,T,I,A)),!!this[s].apply(this,c)};let a="every"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[a]=function(){let c=Array.prototype.slice.call(arguments),u=c.pop();return c.push((l,h,f,b,T,I,A)=>!u(l,h,f,b,T,I,A)),!this[s].apply(this,c)}}function Xh(r,e){let{name:t,type:n,direction:i}=e,s=t.slice(0,-1)+"Entries";r.prototype[s]=function(o,a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return Zt();if(!arguments.length)return jh(this,n);if(arguments.length===1){o=""+o;let c=this._nodes.get(o);if(!c)throw new m(`Graph.${s}: could not find the "${o}" node in the graph.`);return Vh(n,i,c)}if(arguments.length===2){o=""+o,a=""+a;let c=this._nodes.get(o);if(!c)throw new m(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new m(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return Zh(n,i,c,a)}throw new v(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function ef(r){Fh.forEach(e=>{Qh(r,e),Jh(r,e),Yh(r,e),Xh(r,e)})}var tf=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Pn(){this.A=null,this.B=null}Pn.prototype.wrap=function(r){this.A===null?this.A=r:this.B===null&&(this.B=r)};Pn.prototype.has=function(r){return this.A!==null&&r in this.A||this.B!==null&&r in this.B};function wr(r,e,t,n,i){for(let s in n){let o=n[s],a=o.source,c=o.target,u=a===t?c:a;if(e&&e.has(u.key))continue;let d=i(u.key,u.attributes);if(r&&d)return u.key}}function rs(r,e,t,n,i){if(e!=="mixed"){if(e==="undirected")return wr(r,null,n,n.undirected,i);if(typeof t=="string")return wr(r,null,n,n[t],i)}let s=new Pn,o;if(e!=="undirected"){if(t!=="out"){if(o=wr(r,null,n,n.in,i),r&&o)return o;s.wrap(n.in)}if(t!=="in"){if(o=wr(r,s,n,n.out,i),r&&o)return o;s.wrap(n.out)}}if(e!=="directed"&&(o=wr(r,s,n,n.undirected,i),r&&o))return o}function rf(r,e,t){if(r!=="mixed"){if(r==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}let n=[];return rs(!1,r,e,t,function(i){n.push(i)}),n}function br(r,e,t){let n=Object.keys(t),i=n.length,s=0;return{[Symbol.iterator](){return this},next(){let o=null;do{if(s>=i)return r&&r.wrap(t),{done:!0};let a=t[n[s++]],c=a.source,u=a.target;if(o=c===e?u:c,r&&r.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}}}}function nf(r,e,t){if(r!=="mixed"){if(r==="undirected")return br(null,t,t.undirected);if(typeof e=="string")return br(null,t,t[e])}let n=Zt(),i=new Pn;return r!=="undirected"&&(e!=="out"&&(n=Ve(n,br(i,t,t.in))),e!=="in"&&(n=Ve(n,br(i,t,t.out)))),r!=="directed"&&(n=Ve(n,br(i,t,t.undirected))),n}function sf(r,e){let{name:t,type:n,direction:i}=e;r.prototype[t]=function(s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];s=""+s;let o=this._nodes.get(s);if(typeof o=="undefined")throw new m(`Graph.${t}: could not find the "${s}" node in the graph.`);return rf(n==="mixed"?this.type:n,i,o)}}function of(r,e){let{name:t,type:n,direction:i}=e,s="forEach"+t[0].toUpperCase()+t.slice(1,-1);r.prototype[s]=function(u,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;u=""+u;let l=this._nodes.get(u);if(typeof l=="undefined")throw new m(`Graph.${s}: could not find the "${u}" node in the graph.`);rs(!1,n==="mixed"?this.type:n,i,l,d)};let o="map"+t[0].toUpperCase()+t.slice(1);r.prototype[o]=function(u,d){let l=[];return this[s](u,(h,f)=>{l.push(d(h,f))}),l};let a="filter"+t[0].toUpperCase()+t.slice(1);r.prototype[a]=function(u,d){let l=[];return this[s](u,(h,f)=>{d(h,f)&&l.push(h)}),l};let c="reduce"+t[0].toUpperCase()+t.slice(1);r.prototype[c]=function(u,d,l){if(arguments.length<3)throw new v(`Graph.${c}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h=l;return this[s](u,(f,b)=>{h=d(h,f,b)}),h}}function af(r,e){let{name:t,type:n,direction:i}=e,s=t[0].toUpperCase()+t.slice(1,-1),o="find"+s;r.prototype[o]=function(u,d){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;u=""+u;let l=this._nodes.get(u);if(typeof l=="undefined")throw new m(`Graph.${o}: could not find the "${u}" node in the graph.`);return rs(!0,n==="mixed"?this.type:n,i,l,d)};let a="some"+s;r.prototype[a]=function(u,d){return!!this[o](u,d)};let c="every"+s;r.prototype[c]=function(u,d){return!this[o](u,(h,f)=>!d(h,f))}}function uf(r,e){let{name:t,type:n,direction:i}=e,s=t.slice(0,-1)+"Entries";r.prototype[s]=function(o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return Zt();o=""+o;let a=this._nodes.get(o);if(typeof a=="undefined")throw new m(`Graph.${s}: could not find the "${o}" node in the graph.`);return nf(n==="mixed"?this.type:n,i,a)}}function cf(r){tf.forEach(e=>{sf(r,e),of(r,e),af(r,e),uf(r,e)})}function kn(r,e,t,n,i){let s=n._nodes.values(),o=n.type,a,c,u,d,l,h,f;for(;a=s.next(),a.done!==!0;){let b=!1;if(c=a.value,o!=="undirected"){d=c.out;for(u in d){l=d[u];do{if(h=l.target,b=!0,f=i(c.key,h.key,c.attributes,h.attributes,l.key,l.attributes,l.undirected),r&&f)return l;l=l.next}while(l)}}if(o!=="directed"){d=c.undirected;for(u in d)if(!(e&&c.key>u)){l=d[u];do{if(h=l.target,h.key!==u&&(h=l.source),b=!0,f=i(c.key,h.key,c.attributes,h.attributes,l.key,l.attributes,l.undirected),r&&f)return l;l=l.next}while(l)}}if(t&&!b&&(f=i(c.key,null,c.attributes,null,null,null,null),r&&f))return null}}function lf(r,e){let t={key:r};return Fa(e.attributes)||(t.attributes=q({},e.attributes)),t}function df(r,e,t){let n={key:e,source:t.source.key,target:t.target.key};return Fa(t.attributes)||(n.attributes=q({},t.attributes)),r==="mixed"&&t.undirected&&(n.undirected=!0),n}function hf(r){if(!z(r))throw new v('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in r))throw new v("Graph.import: serialized node is missing its key.");if("attributes"in r&&(!z(r.attributes)||r.attributes===null))throw new v("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function ff(r){if(!z(r))throw new v('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in r))throw new v("Graph.import: serialized edge is missing its source.");if(!("target"in r))throw new v("Graph.import: serialized edge is missing its target.");if("attributes"in r&&(!z(r.attributes)||r.attributes===null))throw new v("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in r&&typeof r.undirected!="boolean")throw new v("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}var pf=gh(),gf=new Set(["directed","undirected","mixed"]),Ma=new Set(["domain","_events","_eventsCount","_maxListeners"]),mf=[{name:r=>`${r}Edge`,generateKey:!0},{name:r=>`${r}DirectedEdge`,generateKey:!0,type:"directed"},{name:r=>`${r}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:r=>`${r}EdgeWithKey`},{name:r=>`${r}DirectedEdgeWithKey`,type:"directed"},{name:r=>`${r}UndirectedEdgeWithKey`,type:"undirected"}],yf={allowSelfLoops:!0,multi:!1,type:"mixed"};function vf(r,e,t){if(t&&!z(t))throw new v(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},r._nodes.has(e))throw new E(`Graph.addNode: the "${e}" node already exist in the graph.`);let n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function Ga(r,e,t){let n=new r.NodeDataClass(e,t);return r._nodes.set(e,n),r.emit("nodeAdded",{key:e,attributes:t}),n}function Va(r,e,t,n,i,s,o,a){if(!n&&r.type==="undirected")throw new E(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new E(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!z(a))throw new v(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!r.allowSelfLoops&&s===o)throw new E(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=r._nodes.get(s),u=r._nodes.get(o);if(!c)throw new m(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new m(`Graph.${e}: target node "${o}" not found.`);let d={key:null,undirected:n,source:s,target:o,attributes:a};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new E(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!r.multi&&(n?typeof c.undirected[o]!="undefined":typeof c.out[o]!="undefined"))throw new E(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);let l=new Qt(n,i,c,u,a);r._edges.set(i,l);let h=s===o;return n?(c.undirectedDegree++,u.undirectedDegree++,h&&(c.undirectedLoops++,r._undirectedSelfLoopCount++)):(c.outDegree++,u.inDegree++,h&&(c.directedLoops++,r._directedSelfLoopCount++)),r.multi?l.attachMulti():l.attach(),n?r._undirectedSize++:r._directedSize++,d.key=i,r.emit("edgeAdded",d),i}function _f(r,e,t,n,i,s,o,a,c){if(!n&&r.type==="undirected")throw new E(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&r.type==="directed")throw new E(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(c){if(typeof a!="function")throw new v(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!z(a))throw new v(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let u;if(c&&(u=a,a=void 0),!r.allowSelfLoops&&s===o)throw new E(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let d=r._nodes.get(s),l=r._nodes.get(o),h,f;if(!t&&(h=r._edges.get(i),h)){if((h.source.key!==s||h.target.key!==o)&&(!n||h.source.key!==o||h.target.key!==s))throw new E(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${s}" source & "${o}" target vs. ("${h.source.key}", "${h.target.key}").`);f=h}if(!f&&!r.multi&&d&&(f=n?d.undirected[o]:d.out[o]),f){let F=[f.key,!1,!1,!1];if(c?!u:!a)return F;if(c){let ae=f.attributes;f.attributes=u(ae),r.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else q(f.attributes,a),r.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a});return F}a=a||{},c&&u&&(a=u(a));let b={key:null,undirected:n,source:s,target:o,attributes:a};if(t)i=r._edgeKeyGenerator();else if(i=""+i,r._edges.has(i))throw new E(`Graph.${e}: the "${i}" edge already exists in the graph.`);let T=!1,I=!1;d||(d=Ga(r,s,{}),T=!0,s===o&&(l=d,I=!0)),l||(l=Ga(r,o,{}),I=!0),h=new Qt(n,i,d,l,a),r._edges.set(i,h);let A=s===o;return n?(d.undirectedDegree++,l.undirectedDegree++,A&&(d.undirectedLoops++,r._undirectedSelfLoopCount++)):(d.outDegree++,l.inDegree++,A&&(d.directedLoops++,r._directedSelfLoopCount++)),r.multi?h.attachMulti():h.attach(),n?r._undirectedSize++:r._directedSize++,b.key=i,r.emit("edgeAdded",b),[i,!0,T,I]}function Vt(r,e){r._edges.delete(e.key);let{source:t,target:n,attributes:i}=e,s=e.undirected,o=t===n;s?(t.undirectedDegree--,n.undirectedDegree--,o&&(t.undirectedLoops--,r._undirectedSelfLoopCount--)):(t.outDegree--,n.inDegree--,o&&(t.directedLoops--,r._directedSelfLoopCount--)),r.multi?e.detachMulti():e.detach(),s?r._undirectedSize--:r._directedSize--,r.emit("edgeDropped",{key:e.key,attributes:i,source:t.key,target:n.key,undirected:s})}var L=class extends Ba.EventEmitter{constructor(e){if(super(),e=q({},yf,e),typeof e.multi!="boolean")throw new v(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!gf.has(e.type))throw new v(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new v(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);let t=e.type==="mixed"?Ka:e.type==="directed"?$a:qa;me(this,"NodeDataClass",t);let n="geid_"+pf()+"_",i=0,s=()=>{let o;do o=n+i++;while(this._edges.has(o));return o};me(this,"_attributes",{}),me(this,"_nodes",new Map),me(this,"_edges",new Map),me(this,"_directedSize",0),me(this,"_undirectedSize",0),me(this,"_directedSelfLoopCount",0),me(this,"_undirectedSelfLoopCount",0),me(this,"_edgeKeyGenerator",s),me(this,"_options",e),Ma.forEach(o=>me(this,o,this[o])),Ee(this,"order",()=>this._nodes.size),Ee(this,"size",()=>this._edges.size),Ee(this,"directedSize",()=>this._directedSize),Ee(this,"undirectedSize",()=>this._undirectedSize),Ee(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Ee(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Ee(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Ee(this,"multi",this._options.multi),Ee(this,"type",this._options.type),Ee(this,"allowSelfLoops",this._options.allowSelfLoops),Ee(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){let n=""+e,i=this._edges.get(n);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,t=""+t;let n=this._nodes.get(e);return n?n.out.hasOwnProperty(t):!1}throw new v(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){let n=""+e,i=this._edges.get(n);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,t=""+t;let n=this._nodes.get(e);return n?n.undirected.hasOwnProperty(t):!1}throw new v(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){let n=""+e;return this._edges.has(n)}else if(arguments.length===2){e=""+e,t=""+t;let n=this._nodes.get(e);return n?typeof n.out!="undefined"&&n.out.hasOwnProperty(t)||typeof n.undirected!="undefined"&&n.undirected.hasOwnProperty(t):!1}throw new v(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new E("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");let n=this._nodes.get(e);if(!n)throw new m(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new m(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);let i=n.out&&n.out[t]||void 0;if(i)return i.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new E("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");let n=this._nodes.get(e);if(!n)throw new m(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new m(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);let i=n.undirected&&n.undirected[t]||void 0;if(i)return i.key}edge(e,t){if(this.multi)throw new E("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new m(`Graph.edge: could not find the "${t}" target node in the graph.`);let i=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in||t in n.out}areOutNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.out}areInNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in n.undirected}areNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in n.in||t in n.out)||this.type!=="directed"&&t in n.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.in||this.type!=="directed"&&t in n.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;let n=this._nodes.get(e);if(!n)throw new m(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.out||this.type!=="directed"&&t in n.undirected}inDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree),n}outboundDegree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.outDegree),n}degree(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.degree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree),n}inDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree,i+=t.directedLoops),n-i}outboundDegreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.outDegree,i+=t.directedLoops),n-i}degreeWithoutSelfLoops(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,i=0;return this.type!=="directed"&&(n+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree,i+=t.directedLoops*2),n-i}source(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;let n=this._edges.get(t);if(!n)throw new m(`Graph.opposite: could not find the "${t}" edge in the graph.`);let i=n.source.key,s=n.target.key;if(e===i)return s;if(e===s)return i;throw new m(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${i}, ${s}).`)}hasExtremity(e,t){e=""+e,t=""+t;let n=this._edges.get(e);if(!n)throw new m(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return n.source.key===t||n.target.key===t}isUndirected(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;let t=this._edges.get(e);if(!t)throw new m(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return vf(this,e,t).key}mergeNode(e,t){if(t&&!z(t))throw new v(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let n=this._nodes.get(e);return n?(t&&(q(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new v(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let n=this._nodes.get(e);if(n){if(t){let s=n.attributes;n.attributes=t(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}let i=t?t({}):{};return n=new this.NodeDataClass(e,i),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;let t=this._nodes.get(e);if(!t)throw new m(`Graph.dropNode: could not find the "${e}" node in the graph.`);let n;if(this.type!=="undirected"){for(let i in t.out){n=t.out[i];do Vt(this,n),n=n.next;while(n)}for(let i in t.in){n=t.in[i];do Vt(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(let i in t.undirected){n=t.undirected[i];do Vt(this,n),n=n.next;while(n)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){let n=""+arguments[0],i=""+arguments[1];if(t=ye(this,n,i,this.type),!t)throw new m(`Graph.dropEdge: could not find the "${n}" -> "${i}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new m(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Vt(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new E("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new E("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;let n=ye(this,e,t,"directed");if(!n)throw new m(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Vt(this,n),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new E("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new E("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");let n=ye(this,e,t,"undirected");if(!n)throw new m(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Vt(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){let e=this._nodes.values(),t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new v("Graph.updateAttribute: updater should be a function.");let n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!z(e))throw new v("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!z(e))throw new v("Graph.mergeAttributes: provided attributes are not a plain object.");return q(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new v("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new v("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!Da(t))throw new v("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");let n=this._nodes.values(),i,s;for(;i=n.next(),i.done!==!0;)s=i.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new v("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!Da(t))throw new v("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");let n=this._edges.values(),i,s,o,a;for(;i=n.next(),i.done!==!0;)s=i.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new v("Graph.forEachAdjacencyEntry: expecting a callback.");kn(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new v("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");kn(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new v("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");kn(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new v("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");kn(!1,!0,!0,this,e)}nodes(){return Array.from(this._nodes.keys())}forEachNode(e){if(typeof e!="function")throw new v("Graph.forEachNode: expecting a callback.");let t=this._nodes.values(),n,i;for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new v("Graph.findNode: expecting a callback.");let t=this._nodes.values(),n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new v("Graph.mapNode: expecting a callback.");let t=this._nodes.values(),n,i,s=new Array(this.order),o=0;for(;n=t.next(),n.done!==!0;)i=n.value,s[o++]=e(i.key,i.attributes);return s}someNode(e){if(typeof e!="function")throw new v("Graph.someNode: expecting a callback.");let t=this._nodes.values(),n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new v("Graph.everyNode: expecting a callback.");let t=this._nodes.values(),n,i;for(;n=t.next(),n.done!==!0;)if(i=n.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new v("Graph.filterNodes: expecting a callback.");let t=this._nodes.values(),n,i,s=[];for(;n=t.next(),n.done!==!0;)i=n.value,e(i.key,i.attributes)&&s.push(i.key);return s}reduceNodes(e,t){if(typeof e!="function")throw new v("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new v("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=t,i=this._nodes.values(),s,o;for(;s=i.next(),s.done!==!0;)o=s.value,n=e(n,o.key,o.attributes);return n}nodeEntries(){let e=this._nodes.values();return{[Symbol.iterator](){return this},next(){let t=e.next();if(t.done)return t;let n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}}}}export(){let e=new Array(this._nodes.size),t=0;this._nodes.forEach((i,s)=>{e[t++]=lf(s,i)});let n=new Array(this._edges.size);return t=0,this._edges.forEach((i,s)=>{n[t++]=df(this.type,s,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:n}}import(e,t=!1){if(e instanceof L)return e.forEachNode((c,u)=>{t?this.mergeNode(c,u):this.addNode(c,u)}),e.forEachEdge((c,u,d,l,h,f,b)=>{t?b?this.mergeUndirectedEdgeWithKey(c,d,l,u):this.mergeDirectedEdgeWithKey(c,d,l,u):b?this.addUndirectedEdgeWithKey(c,d,l,u):this.addDirectedEdgeWithKey(c,d,l,u)}),this;if(!z(e))throw new v("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!z(e.attributes))throw new v("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let n,i,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new v("Graph.import: invalid nodes. Expecting an array.");for(n=0,i=s.length;n<i;n++){o=s[n],hf(o);let{key:c,attributes:u}=o;t?this.mergeNode(c,u):this.addNode(c,u)}}if(e.edges){let c=!1;if(this.type==="undirected"&&(c=!0),s=e.edges,!Array.isArray(s))throw new v("Graph.import: invalid edges. Expecting an array.");for(n=0,i=s.length;n<i;n++){a=s[n],ff(a);let{source:u,target:d,attributes:l,undirected:h=c}=a,f;"key"in a?(f=t?h?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:h?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,a.key,u,d,l)):(f=t?h?this.mergeUndirectedEdge:this.mergeDirectedEdge:h?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,d,l))}}return this}nullCopy(e){let t=new L(q({},this._options,e));return t.replaceAttributes(q({},this.getAttributes())),t}emptyCopy(e){let t=this.nullCopy(e);return this._nodes.forEach((n,i)=>{let s=q({},n.attributes);n=new t.NodeDataClass(i,s),t._nodes.set(i,n)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new E(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new E("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new E("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");let t=this.emptyCopy(e),n=this._edges.values(),i,s;for(;i=n.next(),i.done!==!0;)s=i.value,Va(t,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,q({},s.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){let e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});let t={},n={};this._edges.forEach((s,o)=>{let a=s.undirected?"--":"->",c="",u=s.source.key,d=s.target.key,l;s.undirected&&u>d&&(l=u,u=d,d=l);let h=`(${u})${a}(${d})`;o.startsWith("geid_")?this.multi&&(typeof n[h]=="undefined"?n[h]=0:n[h]++,c+=`${n[h]}. `):c+=`[${o}]: `,c+=h,t[c]=s.attributes});let i={};for(let s in this)this.hasOwnProperty(s)&&!Ma.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(i[s]=this[s]);return i.attributes=this._attributes,i.nodes=e,i.edges=t,me(i,"constructor",this.constructor),i}};typeof Symbol!="undefined"&&(L.prototype[Symbol.for("nodejs.util.inspect.custom")]=L.prototype.inspect);mf.forEach(r=>{["add","merge","update"].forEach(e=>{let t=r.name(e),n=e==="add"?Va:_f;r.generateKey?L.prototype[t]=function(i,s,o){return n(this,t,!0,(r.type||this.type)==="undirected",null,i,s,o,e==="update")}:L.prototype[t]=function(i,s,o,a){return n(this,t,!1,(r.type||this.type)==="undirected",i,s,o,a,e==="update")}})});Ph(L);Bh(L);ef(L);cf(L);var Wt=class extends L{constructor(e){let t=q({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new v("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new v('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},En=class extends L{constructor(e){let t=q({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new v("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new v('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},Sn=class extends L{constructor(e){let t=q({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new v("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}},xn=class extends L{constructor(e){let t=q({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new v("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new v('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}},Cn=class extends L{constructor(e){let t=q({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new v("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new v('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}};function Jt(r){r.from=function(e,t){let n=q({},e.options,t),i=new r(n);return i.import(e),i}}Jt(L);Jt(Wt);Jt(En);Jt(Sn);Jt(xn);Jt(Cn);L.Graph=L;L.DirectedGraph=Wt;L.UndirectedGraph=En;L.MultiGraph=Sn;L.MultiDirectedGraph=xn;L.MultiUndirectedGraph=Cn;L.InvalidArgumentsGraphError=v;L.NotFoundGraphError=m;L.UsageGraphError=E;var Nn=class{constructor({cache:e,identity:t}){this.cache=e,this.identity=t,this.dg=new Wt}async generate(){console.log("Generating network graph"),this.dg.clear();for(let e of this.cache.listRids([G]))this.dg.addNode(e),console.log(`Added node ${e}`);for(let e of this.cache.listRids([Ce])){let t=await this.cache.read(e);if(!t){console.error(`Failed to load ${e}`);continue}let n=St.parse(t.contents);this.dg.addEdge(n.source,n.target,{rid:e}),console.log(`Added edge ${e} (${n.source} -> ${n.target})`)}console.log("Done")}getEdge({source:e,target:t}){if(this.dg.hasEdge(e,t))return this.dg.getEdgeAttribute(e,t,"rid")||void 0}getEdges(e){let t=[];e!=="in"&&t.push(...this.dg.outEdges(this.identity.rid)),e!=="out"&&t.push(...this.dg.inEdges(this.identity.rid));let n=[];for(let i of t){let s=this.dg.getEdgeAttribute(i,"rid");s&&n.push(s)}return n}async getNeighbors({direction:e,status:t,allowedType:n}={}){let i=new Set;for(let s of this.getEdges(e)){let o=await this.cache.read(s);if(!o){console.error(`Failed to find ${s} in cache`);continue}let a=St.parse(o.contents);if(!a){console.warn(`Failed to find edge ${s} in cache`);continue}t&&a.status!==t||n&&!a.rid_types.includes(n)||(a.target===this.identity.rid?i.add(a.source):a.source===this.identity.rid&&i.add(a.target))}return Array.from(i)}};var Se=require("crypto");function Za(r){return Buffer.from(r).toString("base64")}function Wa(r){return Buffer.from(r,"base64")}var Ze=class{constructor(e){this.privKey=e}static async generate(){let e=await Se.webcrypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!0,["sign"]);return new Ze(e.privateKey)}async publicKey(){let e=await this.toJwk();delete e.d,e.key_ops=["verify"];let t=await Se.webcrypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"]);return new rt(t)}static async fromJwk(e){let t=await Se.webcrypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!0,["sign"]);return new Ze(t)}async toJwk(){return await Se.webcrypto.subtle.exportKey("jwk",this.privKey)}async sign(e){let t=await Se.webcrypto.subtle.sign({name:"ECDSA",hash:{name:"SHA-256"}},this.privKey,e);return Za(new Uint8Array(t))}},rt=class{constructor(e){this.pubKey=e}static async fromJwk(e){let t=await Se.webcrypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"]);return new rt(t)}static async fromDer(e){let t=Wa(e),n=await Se.webcrypto.subtle.importKey("spki",t,{name:"ECDSA",namedCurve:"P-256"},!0,["verify"]);return new rt(n)}async toJwk(){return await Se.webcrypto.subtle.exportKey("jwk",this.pubKey)}async toDer(){let e=await Se.webcrypto.subtle.exportKey("spki",this.pubKey);return Za(new Uint8Array(e))}async verify(e,t){let n=Wa(e);return await Se.webcrypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},this.pubKey,n,t)}};var Tn=class{constructor({identity:e,effector:t}){this.identity=e,this.effector=t}async loadPrivKey(e){this.privKey=await Ze.fromJwk(e)}handleUnknownNode(e){if(e.payload.type!=="events_payload")return;let t=e.payload;for(let n of t.events)if(n.rid===e.source_node&&n.event_type==="NEW")return n.bundle}async createEnvelope({payload:e,target:t}){return await new zt({payload:e,source_node:this.identity.rid,target_node:t}).signWith(this.privKey)}async validateEnvelope(e){let t=await this.effector.deref({rid:e.source_node})||this.handleUnknownNode(e);if(!t)throw new Error(`Couldn't resolve ${e.source_node}`);let n=t.validateContents(ee),i=ze(n.public_key);if(!e.source_node.endsWith(i))throw new Error("Invalid public key on new node!");let s=await rt.fromDer(n.public_key);if(!e.verifyWith(s))throw new Error(`Signature ${e.signature} is invalid.`);if(e.target_node!==this.identity.rid)throw new Error(`Envelope target ${e.target_node} is not me`)}};var An=class{constructor({cache:e,identity:t,config:n,graph:i,effector:s,requestHandler:o}){this.identity=t,this.cache=e,this.graph=i,this.effector=s,this.config=n,this.requestHandler=o,this.webhookEventQueue={}}async pushEventTo({event:e,node:t,flush:n=!1}){console.log(`pushing event: ${e} to ${t}`);let i=await this.effector.deref({rid:t});if(i){if(i.validateContents(ee).node_type!==je.enum.FULL){console.log("Can't push event to partial node");return}}else if(t!==this.config.first_contact.rid){console.log("unknown node",t);return}t in this.webhookEventQueue||(this.webhookEventQueue[t]=[]),this.webhookEventQueue[t].push(e),n&&await this.flushWebhookQueue(t)}async flushWebhookQueue(e,t=!0){if(console.log("flushing queue for",e),!(e in this.webhookEventQueue))return;let n=this.webhookEventQueue[e],i=n.splice(0,n.length);console.log(i);try{console.log(`broadcasting ${i.length} events`),this.requestHandler.broadcastEvents({node:e,req:{events:i}})}catch(s){console.log(s),t&&n.push(...i)}}};var On=class{constructor({identity:e,effector:t}){this.identity=e,this.effector=t}},In=class{constructor({identity:e,config:t,cache:n,eventQueue:i,graph:s,requestHandler:o,effector:a}){this.identity=e,this.config=t,this.cache=n,this.eventQueue=i,this.graph=s,this.requestHandler=o,this.effector=a}setProcessor(e){this.processor=e}};var Ln=class{constructor({graph:e,cache:t,eventQueue:n,identity:i,handlerContext:s,requestHandler:o}){this.handlerContext=s,this.graph=e,this.cache=t,this.eventQueue=n,this.identity=i,this.requestHandler=o,this.handlers=[],this.kobjQueue=[]}addHandler(e){this.handlers.push(e)}async callHandlerChain(e,t){for(let n of this.handlers){if(e!=n.handlerType)continue;if(n.ridTypes){let o=!1;for(let a of n.ridTypes)t.rid.startsWith(a)&&(o=!0);if(!o)continue}if(n.source&&n.source!=t.source||n.eventTypes&&!n.eventTypes.includes(t.eventType))continue;let i=n.func(this.handlerContext,t),s=i instanceof Promise?await i:i;if(s===j)return console.log(`Handler chain stopped by ${n.name}`),j;if(s===void 0)continue;console.log(`kobj modified by ${n.name}`),console.log(`new kobj: ${t.stringify()}`),t=s}return t}async process(e){let t=e;if(t=await this.callHandlerChain("rid",t),t!==j){if(t.eventType===R.enum.FORGET){let n=await this.cache.read(t.rid);if(!n)return;t.manifest=n.manifest,t.contents=n.contents}else{if(!t.manifest){if(console.log("manifest not found"),!t.source)return;console.log("attempting to fetch remote manifest from source");let n=await this.requestHandler.fetchManifests({node:t.source,req:{rids:[t.rid]}});if(!n.manifests){console.warn("failed to find manifest");return}t.manifest=n.manifests[0]}if(t=await this.callHandlerChain("manifest",t),t===j)return;if(!t.bundle){if(console.log("bundle not found"),!t.source)return;console.log("attempting to fetch remote bundle from source");let n=await this.requestHandler.fetchBundles({node:t.source,req:{rids:[t.rid]}});if(!n.bundles){console.warn("failed to find bundle");return}let{manifest:i,contents:s}=n.bundles[0];t.manifest=i,t.contents=s}}if(t=await this.callHandlerChain("bundle",t),t!==j){if(t.normalizedEventType===R.enum.NEW||t.normalizedEventType===R.enum.UPDATE)console.log(`writing to cache: ${t.stringify()}`),await this.cache.write(t.bundle);else if(t.normalizedEventType===R.enum.FORGET)console.log(`deleting from cache: ${t.stringify()}`),await this.cache.delete(t.rid);else{console.log("no normalized event set, stopping");return}if((t.rid.startsWith(G)||t.rid.startsWith(Ce))&&await this.graph.generate(),t=await this.callHandlerChain("network",t),t!==j){console.log(`broadcasting event to ${t.networkTargets.length} target(s)`);for(let n of t.networkTargets)await this.eventQueue.pushEventTo({node:n,event:t.normalizedEvent}),await this.eventQueue.flushWebhookQueue(n);await this.callHandlerChain("final",t)}}}}};var Rn=class{constructor({identity:e,effector:t,eventQueue:n}){this.identity=e,this.effector=t,this.eventQueue=n}async handshakeWith({target:e}){console.log("shaking hands with",e),await this.eventQueue.pushEventTo({event:W.fromRID(R.enum.FORGET,this.identity.rid),node:e}),await this.eventQueue.pushEventTo({event:W.fromBundle(R.enum.NEW,await this.effector.deref({rid:this.identity.rid})),node:e}),await this.eventQueue.flushWebhookQueue(e)}};var Dn=class{constructor({config:e,graph:t,processor:n,effector:i,actor:s,identity:o}){this.config=e,this.graph=t,this.processor=n,this.effector=i,this.actor=s,this.identity=o}async start(){await this.graph.generate(),await this.effector.deref({rid:this.identity.rid,refreshCache:!0}),await this.processor.flushKobjQueue();let e=await this.graph.getNeighbors();console.log("neighbors",e),!e.length&&this.config.first_contact.rid&&(console.log("i dont have any neighbors, reaching out to first contact"),await this.actor.handshakeWith({target:this.config.first_contact.rid}))}async stop(){await this.processor.flushKobjQueue()}};var Qa=(r,e)=>{if(e===r.identity.rid)return $.generate({rid:r.identity.rid,contents:r.identity.profile})};var Mn=class{constructor({processor:e,lifecycle:t,resolver:n,config:i}){this.processor=e,this.lifecycle=t,this.resolver=n,this.config=i}async poll(){let e=await this.resolver.pollNeighbors();for(let t in e)for(let n of e[t])this.processor.handle({event:n,source:t});await this.processor.flushKobjQueue()}};var Gn=class{constructor({cache:e,config:t}){this.config=t,this.cache=e,this.identity=new pn(this.config),this.effector=new bn({...this}),this.graph=new Nn({...this}),this.secure=new Tn({...this}),this.requestHandler=new wn({...this}),this.resolver=new gn({...this}),this.eventQueue=new An({...this}),this.actor=new Rn({...this}),this.actionContext=new On({...this}),this.handlerContext=new In({...this}),this.pipeline=new Ln({...this}),this.processor=new yn({...this}),this.handlerContext.setProcessor(this.processor),this.effector.setProcessor(this.processor),this.effector.setResolver(this.resolver),this.effector.setActionContext(this.actionContext),this.lifecycle=new Dn({...this}),this.poller=new Mn({...this}),this.pipeline.addHandler(Ea),this.pipeline.addHandler(Sa),this.pipeline.addHandler(xa),this.pipeline.addHandler(Ca),this.pipeline.addHandler(Pa),this.pipeline.addHandler(Na),this.pipeline.addHandler(Ta),this.effector.registerAction({ridType:G,action:Qa})}};var Fn=require("obsidian");var Bn=class{constructor({vault:e,directoryPath:t}){this.vault=e,this.directoryPath=t}getFolderObject(){return this.vault.getFolderByPath(this.directoryPath)}getFilePath(e){return`${this.directoryPath}/${btoa(e)}.json`}getFileObject(e){return this.vault.getFileByPath(this.getFilePath(e))}async write(e){(!this.vault.getFolderByPath(this.directoryPath)||!this.getFolderObject())&&(console.log("attempting to create folder"),await this.vault.createFolder(this.directoryPath));let t=this.getFileObject(e.rid),n=JSON.stringify(e);return t?await this.vault.process(t,()=>n):await this.vault.create(this.getFilePath(e.rid),n),e}exists(e){return this.getFileObject(e)!==null}async read(e){try{let t=this.getFileObject(e);if(!t)return;let n=await this.vault.read(t);return $.validate(JSON.parse(n))}catch(t){return}}listRids(e){let t=this.getFolderObject();if(!t)return[];let n=[],i=[];Fn.Vault.recurseChildren(t,s=>{s instanceof Fn.TFile&&i.push(s)});for(let s of i){let o=atob(s.basename);if(Array.isArray(e)){for(let a of e)if(o.startsWith(a)){n.push(o);continue}}else n.push(o)}return n}async delete(e){let t=this.getFileObject(e);t&&await this.vault.delete(t)}async drop(){let e=this.getFolderObject();e&&await this.vault.delete(e,!0)}};function Ja(r,e){r.pipeline.handlers.push(new Y({name:"obsidian_event_mirroring_blocker",handlerType:"rid",ridTypes:[we],func:(t,n)=>{let{reference:i}=Mt(n.rid);if(n.source&&(i!=null&&i.startsWith(e.settings.vaultId)))return console.log("EVENT BOUNCING BACK FROM MANAGER"),j}}),new Y({name:"file_formatter_mirror",handlerType:"network",func:async(t,n)=>{console.log("NORMALIZED EVENT TYPE",n.normalizedEventType),n.normalizedEventType==="FORGET"?await e.fileFormatter.delete(n.rid):await e.fileFormatter.write(n.rid),await e.updateStatusBar()}}),new Y({name:"interested_contactor",handlerType:"network",ridTypes:[G],func:async(t,n)=>{var a;if(n.rid===t.identity.rid)return;let i=n.bundle.validateContents(ee),s=(a=i.provides.event)==null?void 0:a.filter(c=>e.settings.interestedRidTypes.includes(c));if(!s||s.length===0||i.node_type!==je.enum.FULL)return;console.log(`identified ${n.rid} as provider of ${s}`),t.processor.handle({bundle:vn({source:n.rid,target:t.identity.rid,edgeType:"POLL",ridTypes:s})});let o=await t.requestHandler.fetchRids({node:n.rid,req:{rid_types:s}});if(console.log(`retrieved ${o.rids.length} rids`),o.rids.forEach(c=>{t.processor.handle({rid:c,source:n.rid})}),console.log("identied obsidian manger, sending existing notes"),s.contains(we)){for(let c of e.indexer.listRids()){let u=await r.effector.deref({rid:c});u&&(console.log(`sending ${c}`),t.eventQueue.pushEventTo({event:W.fromBundle(R.enum.NEW,u),node:n.rid}))}await t.eventQueue.flushWebhookQueue(n.rid)}}}),new Y({name:"obsidian_note_network_decider",handlerType:"network",ridTypes:[we],func:(t,n)=>{if(n.source)return console.log("blocking broadcasting of externally sourced obsidian note"),j}}))}var xt=require("obsidian"),Kn=class extends xt.Modal{constructor(e,t){super(e),this.setTitle("Set up your KOI node!");let n="",i="",s="";new xt.Setting(this.contentEl).setName("Node name:").addText(o=>o.onChange(a=>{n=a})),new xt.Setting(this.contentEl).setName("First contact RID:").addText(o=>o.onChange(a=>{i=a})),new xt.Setting(this.contentEl).setName("First contact URL:").addText(o=>o.onChange(a=>{s=a})),new xt.Setting(this.contentEl).addButton(o=>o.setButtonText("Submit").setCta().onClick(()=>{this.close(),t({nodeName:n,firstContactRid:i,firstContactUrl:s})}))}};var Ya=require("crypto");var Er=require("obsidian");var $n=class{constructor(e){this.app=e.app,this.settings=e.settings,this.node=e.node,this.fileIndex={}}async indexNotes(){console.log("indexing notes...");for(let e of this.app.vault.getMarkdownFiles()){let t=this.app.metadataCache.getFileCache(e),n=t==null?void 0:t.frontmatter;!(n!=null&&n.hasOwnProperty(X))||!(n!=null&&n.hasOwnProperty(Xt))||(this.fileIndex[e.path]=n[X],console.log(e.path,"->",n[X]),await this.handleFile(e))}console.log(this.fileIndex)}listRids(){let e=[];for(let[t,n]of Object.entries(this.fileIndex))n&&e.push(n);return e}async modifyNote(e){var t;((t=e.parent)==null?void 0:t.name)!==this.settings.koiSyncFolderPath&&e.path in this.fileIndex&&(console.log(`modifying note ${e.path}`),await this.handleFile(e))}async renameNote(e,t){if(!(t in this.fileIndex))return;console.log(`renaming note ${t} -> ${e.path}`),new Er.Notice("KOI-net: note renamed");let n=this.fileIndex[t];delete this.fileIndex[t],this.fileIndex[e.path]=n,await this.handleFile(e)}async deleteNote(e){e.path in this.fileIndex&&(console.log("deleting note",e.path),new Er.Notice("KOI-net: note deleted"),this.node.processor.handle({rid:this.fileIndex[e.path],eventType:R.enum.FORGET}),delete this.fileIndex[e.path])}async trackFile(e){await this.app.fileManager.processFrontMatter(e,async t=>{t[X]||(t[X]=`${we}:${this.settings.vaultId}/${(0,Ya.randomUUID)()}`),t[Xt]=!0,this.fileIndex[e.path]=t[X]}),await this.handleFile(e)}async handleFile(e){await this.app.fileManager.processFrontMatter(e,async t=>{if(!t){console.log("didn't find frontmatter");return}if(t[Xt]===!1)console.log("forgetting",t[X]),new Er.Notice("KOI-net: note untracked"),this.node.processor.handle({rid:t[X],eventType:R.enum.FORGET});else{let n=await this.app.vault.read(e);delete t[Xt],this.node.cache.exists(t[X])||new Er.Notice("KOI-net: note tracked");let i=n.replace(/^---[\s\S]*?---\n?/,""),s=hn.parse({text:i,frontmatter:t,basename:e.basename,path:e.path});this.node.processor.handle({bundle:$.generate({rid:t[X],contents:s})})}await this.node.processor.flushKobjQueue()})}};var qn=class extends ve.Plugin{async onload(){console.log("hello world!"),await this.loadSettings(),this.addSettingTab(new Nr(this.app,this)),this.settings.vaultId=this.app.appId,this.saveSettings(),this.config=this.settings.config,this.cache=new Bn({vault:this.app.vault,directoryPath:this.config.cache_directory_path}),this.node=new Gn({cache:this.cache,config:this.config}),this.fileFormatter=new fn(this,this.cache,this.node.effector),this.indexer=new $n(this),Ja(this.node,this),console.log("i am",this.node.identity.rid),this.syncMutex=new Pr,this.connected=!0,this.statusBarText=this.addStatusBarItem(),this.statusBarIcon=this.addStatusBarItem(),this.statusBarIcon.addClass("koi-status-icon"),this.statusBarIcon.setAttribute("data-tooltip-position","top"),this.statusBarIcon.addEventListener("click",async()=>{this.settings.initialized||this.createSetupModal()}),this.addCommand({id:"drop-rid-cache",name:"Drop RID cache",callback:async()=>{await this.cache.drop()}}),this.addCommand({id:"set-node-rid",name:"Set KOI-net node RID",callback:()=>{}}),this.addCommand({id:"reformat-telescopes",name:"Reformat telescopes from template",callback:async()=>{await this.fileFormatter.writeMultiple(this.node.cache.listRids())}}),this.addCommand({id:"recompile-templates",name:"Recompile templates",callback:async()=>{await this.fileFormatter.compileTemplates()}}),this.addCommand({id:"track-this-note",name:"Track this note",callback:async()=>{let t=this.app.workspace.getActiveFile();t instanceof ve.TFile&&await this.indexer.trackFile(t)}}),this.registerEvent(this.app.vault.on("modify",async t=>{var n;if(t.path.startsWith(this.settings.templatePath)){console.log("detect change in templates, recompiling..."),await this.fileFormatter.compileTemplates();return}((n=t.parent)==null?void 0:n.name)!==this.settings.koiSyncFolderPath&&await this.indexer.modifyNote(t)})),this.registerEvent(this.app.vault.on("rename",async(t,n)=>{await this.indexer.renameNote(t,n)})),this.registerEvent(this.app.vault.on("delete",async t=>{await this.indexer.deleteNote(t)})),this.app.workspace.on("url-menu",(t,n)=>{t.addItem(i=>{i.setTitle("Open with KOI").setIcon("scroll").onClick(async()=>{let s=this.fileFormatter.getFileByRid(n);s&&this.app.workspace.getLeaf().openFile(s)})})}),this.app.workspace.onLayoutReady(()=>{console.log("calling setup"),this.setup()})}async setup(){await this.updateStatusBar(),await this.fileFormatter.compileTemplates(),this.settings.initialized&&(await this.node.secure.loadPrivKey(this.config.priv_key),await this.node.lifecycle.start(),await this.indexer.indexNotes(),new ve.Notice("KOI-net: Started polling network..."),this.poller=this.registerInterval(window.setInterval(async()=>{await this.node.poller.poll()},this.config.polling_interval*1e3)))}createSetupModal(){new Kn(this.app,async({nodeName:t,firstContactRid:n,firstContactUrl:i})=>{let s=await Ze.generate(),a=await(await s.publicKey()).toDer(),c=ze(a),u=`${G}:${t}+${c}`;this.settings.config.node_rid=u,this.settings.config.priv_key=await s.toJwk(),this.settings.config.node_profile.public_key=a,this.settings.config.first_contact.rid=n,this.settings.config.first_contact.url=i,this.settings.initialized=!0,await this.saveSettings(),new ve.Notice(`KOI-net: Node RID set to ${u}`),await this.setup()}).open()}async updateStatusBar(){let t=this.statusBarIconString;this.settings.initialized?(this.statusBarIconString="circle-check",(0,ve.setTooltip)(this.statusBarIcon,"Synced!")):(this.statusBarIconString="circle-play",(0,ve.setTooltip)(this.statusBarIcon,"Click to setup your KOI-net node!")),this.statusBarIconString!==t&&(0,ve.setIcon)(this.statusBarIcon,this.statusBarIconString),this.statusBarText.setText(`KOI-net: ${this.cache.listRids().length} \u{1F4DC}`)}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},ds,t)}async saveSettings(){await this.saveData(this.settings)}};

/* nosourcemap */